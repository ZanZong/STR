WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1630: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/stropt/lms.py:970: The name tf.train.SessionRunHook is deprecated. Please use tf.estimator.SessionRunHook instead.

WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/stropt/str_strategy.py:122: get_backward_walk_ops (from tensorflow.contrib.graph_editor.select) is deprecated and will be removed after 2019-06-06.
Instructions for updating:
Please use tensorflow.python.ops.op_selector.get_backward_walk_ops.
1 Physical GPUs, 1 Logical GPUs
Parsing arguments: [('batch_size', 240), ('epochs', 1), ('model_name', 'VGG16'), ('strategy', 'checkmate'), ('verbose', False)]
Cannot find config for batch_size=240, use 250 instead
Shape of x_train: (40000, 224, 224, 3), shape of x_test: (10000, 224, 224, 3)
[STR DEBUG] Parsing STR configuration: [{'strategy': 'recompute', 'verbose': 'false', 'tags': '/home/zongzan/dist_dnn_training/STR/optimizer/logs/VGG16_250/layer_names'}, {'r': '/home/zongzan/dist_dnn_training/STR/optimizer/logs/VGG16_250/R-checkmate'}]
  1/167 [..............................] - ETA: 1:18:02 - loss: 2.3293 - acc: 0.1042  2/167 [..............................] - ETA: 41:48 - loss: 11907055.1647 - acc: 0.0979  3/167 [..............................] - ETA: 29:38 - loss: 7938072.1653 - acc: 0.1000   4/167 [..............................] - ETA: 23:31 - loss: 5953570.3933 - acc: 0.0990  5/167 [..............................] - ETA: 19:58 - loss: 4763007.9170 - acc: 0.0983  6/167 [>.............................] - ETA: 17:33 - loss: 3969580.7167 - acc: 0.0993  7/167 [>.............................] - ETA: 15:55 - loss: 3402501.3065 - acc: 0.0976  8/167 [>.............................] - ETA: 14:38 - loss: 2977188.9339 - acc: 0.0990  9/167 [>.............................] - ETA: 13:41 - loss: 2646390.6481 - acc: 0.0991 10/167 [>.............................] - ETA: 12:59 - loss: 2381751.8132 - acc: 0.1017 11/167 [>.............................] - ETA: 12:24 - loss: 2165230.1063 - acc: 0.1023 12/167 [=>............................] - ETA: 12:00 - loss: 1984794.4563 - acc: 0.1003 13/167 [=>............................] - ETA: 11:38 - loss: 1832118.1368 - acc: 0.1016 14/167 [=>............................] - ETA: 11:19 - loss: 1701252.7401 - acc: 0.0997 15/167 [=>............................] - ETA: 11:03 - loss: 1587836.0458 - acc: 0.0989 16/167 [=>............................] - ETA: 10:48 - loss: 1488596.4370 - acc: 0.0982 17/167 [==>...........................] - ETA: 10:34 - loss: 1401032.0761 - acc: 0.0975 18/167 [==>...........................] - ETA: 10:22 - loss: 1323197.0887 - acc: 0.0979 19/167 [==>...........................] - ETA: 10:10 - loss: 1253555.2580 - acc: 0.0993 20/167 [==>...........................] - ETA: 9:59 - loss: 1190877.6101 - acc: 0.1031  21/167 [==>...........................] - ETA: 9:49 - loss: 1134169.2616 - acc: 0.1030 22/167 [==>...........................] - ETA: 9:46 - loss: 1082616.2460 - acc: 0.1040 23/167 [===>..........................] - ETA: 9:43 - loss: 1035546.0743 - acc: 0.1040 24/167 [===>..........................] - ETA: 9:40 - loss: 992398.4178 - acc: 0.1036  25/167 [===>..........................] - ETA: 9:36 - loss: 952702.5732 - acc: 0.1040 26/167 [===>..........................] - ETA: 9:29 - loss: 916060.2552 - acc: 0.1040 27/167 [===>..........................] - ETA: 9:22 - loss: 882132.1828 - acc: 0.1035 28/167 [====>.........................] - ETA: 9:14 - loss: 850627.5442 - acc: 0.1042 29/167 [====>.........................] - ETA: 9:05 - loss: 821295.6393 - acc: 0.1034 30/167 [====>.........................] - ETA: 8:58 - loss: 793919.1946 - acc: 0.1031 31/167 [====>.........................] - ETA: 8:50 - loss: 768308.9716 - acc: 0.1024 32/167 [====>.........................] - ETA: 8:43 - loss: 744299.3876 - acc: 0.1026 33/167 [====>.........................] - ETA: 8:37 - loss: 721744.9739 - acc: 0.1034 34/167 [=====>........................] - ETA: 8:31 - loss: 700517.2590 - acc: 0.1038 35/167 [=====>........................] - ETA: 8:26 - loss: 680502.5461 - acc: 0.1039 36/167 [=====>........................] - ETA: 8:21 - loss: 661599.7616 - acc: 0.1032 37/167 [=====>........................] - ETA: 8:17 - loss: 643718.7493 - acc: 0.1021 38/167 [=====>........................] - ETA: 8:14 - loss: 626778.8427 - acc: 0.1026 39/167 [======>.......................] - ETA: 8:10 - loss: 610707.6494 - acc: 0.1034 40/167 [======>.......................] - ETA: 8:07 - loss: 595440.0154 - acc: 0.1046 41/167 [======>.......................] - ETA: 8:04 - loss: 580917.1451 - acc: 0.1040 42/167 [======>.......................] - ETA: 8:01 - loss: 567085.8393 - acc: 0.1034 43/167 [======>.......................] - ETA: 7:57 - loss: 553897.8502 - acc: 0.1040 44/167 [======>.......................] - ETA: 7:52 - loss: 541309.3148 - acc: 0.1045 45/167 [=======>......................] - ETA: 7:46 - loss: 529280.2710 - acc: 0.1055 46/167 [=======>......................] - ETA: 7:41 - loss: 517774.2282 - acc: 0.1055 47/167 [=======>......................] - ETA: 7:35 - loss: 506757.8042 - acc: 0.1058 48/167 [=======>......................] - ETA: 7:30 - loss: 496200.3979 - acc: 0.1057 49/167 [=======>......................] - ETA: 7:24 - loss: 486073.9068 - acc: 0.1065 50/167 [=======>......................] - ETA: 7:20 - loss: 476352.4747 - acc: 0.1067 51/167 [========>.....................] - ETA: 7:16 - loss: 467012.2752 - acc: 0.1064 52/167 [========>.....................] - ETA: 7:13 - loss: 458031.3144 - acc: 0.1061 53/167 [========>.....................] - ETA: 7:09 - loss: 449389.2576 - acc: 0.1061 54/167 [========>.....................] - ETA: 7:05 - loss: 441067.2770 - acc: 0.1058 55/167 [========>.....................] - ETA: 7:01 - loss: 433047.9138 - acc: 0.1061 56/167 [=========>....................] - ETA: 6:56 - loss: 425314.9564 - acc: 0.1056 57/167 [=========>....................] - ETA: 6:51 - loss: 417853.3308 - acc: 0.1058 58/167 [=========>....................] - ETA: 6:47 - loss: 410649.0025 - acc: 0.1056 59/167 [=========>....................] - ETA: 6:42 - loss: 403688.8890 - acc: 0.1056 60/167 [=========>....................] - ETA: 6:38 - loss: 396960.7793 - acc: 0.1051 61/167 [=========>....................] - ETA: 6:33 - loss: 390453.2632 - acc: 0.1051 62/167 [==========>...................] - ETA: 6:29 - loss: 384155.6670 - acc: 0.1054 63/167 [==========>...................] - ETA: 6:25 - loss: 378057.9946 - acc: 0.1053 64/167 [==========>...................] - ETA: 6:20 - loss: 372150.8749 - acc: 0.1049 65/167 [==========>...................] - ETA: 6:16 - loss: 366425.5123 - acc: 0.1052 66/167 [==========>...................] - ETA: 6:12 - loss: 360873.6455 - acc: 0.1053 67/167 [===========>..................] - ETA: 6:08 - loss: 355487.5060 - acc: 0.1052 68/167 [===========>..................] - ETA: 6:03 - loss: 350259.7824 - acc: 0.1062 69/167 [===========>..................] - ETA: 5:59 - loss: 345183.5862 - acc: 0.1075 70/167 [===========>..................] - ETA: 5:56 - loss: 340252.4246 - acc: 0.1082 71/167 [===========>..................] - ETA: 5:53 - loss: 335460.1694 - acc: 0.1081 72/167 [===========>..................] - ETA: 5:50 - loss: 330801.0323 - acc: 0.1079 73/167 [============>.................] - ETA: 5:47 - loss: 326269.5429 - acc: 0.1077 74/167 [============>.................] - ETA: 5:43 - loss: 321860.5260 - acc: 0.1081 75/167 [============>.................] - ETA: 5:40 - loss: 317569.0921 - acc: 0.1082 76/167 [============>.................] - ETA: 5:37 - loss: 313390.5816 - acc: 0.1081 77/167 [============>.................] - ETA: 5:33 - loss: 309320.6041 - acc: 0.1081 78/167 [=============>................] - ETA: 5:29 - loss: 305354.9848 - acc: 0.1085 79/167 [=============>................] - ETA: 5:25 - loss: 301489.7609 - acc: 0.1082 80/167 [=============>................] - ETA: 5:21 - loss: 297721.1681 - acc: 0.1081 81/167 [=============>................] - ETA: 5:17 - loss: 294045.6265 - acc: 0.1082 82/167 [=============>................] - ETA: 5:13 - loss: 290459.7323 - acc: 0.1085 83/167 [=============>................] - ETA: 5:09 - loss: 286960.2451 - acc: 0.1093 84/167 [==============>...............] - ETA: 5:05 - loss: 283544.0805 - acc: 0.1092 85/167 [==============>...............] - ETA: 5:01 - loss: 280208.2949 - acc: 0.1093 86/167 [==============>...............] - ETA: 4:57 - loss: 276950.0860 - acc: 0.1093 87/167 [==============>...............] - ETA: 4:53 - loss: 273766.7781 - acc: 0.1094 88/167 [==============>...............] - ETA: 5:04 - loss: 270655.8181 - acc: 0.1096 89/167 [==============>...............] - ETA: 5:00 - loss: 267614.7674 - acc: 0.1091 90/167 [===============>..............] - ETA: 4:56 - loss: 264641.2955 - acc: 0.1094 91/167 [===============>..............] - ETA: 4:51 - loss: 261733.1746 - acc: 0.1096 92/167 [===============>..............] - ETA: 4:47 - loss: 258888.3041 - acc: 0.1093 93/167 [===============>..............] - ETA: 4:43 - loss: 256104.5836 - acc: 0.1097 94/167 [===============>..............] - ETA: 4:39 - loss: 253380.0913 - acc: 0.1094 95/167 [================>.............] - ETA: 4:34 - loss: 250712.9566 - acc: 0.1095 96/167 [================>.............] - ETA: 4:30 - loss: 248101.3872 - acc: 0.1097 97/167 [================>.............] - ETA: 4:26 - loss: 245543.6708 - acc: 0.1098 98/167 [================>.............] - ETA: 4:22 - loss: 243038.1467 - acc: 0.1097 99/167 [================>.............] - ETA: 4:18 - loss: 240583.2391 - acc: 0.1102100/167 [================>.............] - ETA: 4:14 - loss: 238177.4296 - acc: 0.1104101/167 [=================>............] - ETA: 4:12 - loss: 235819.2933 - acc: 0.1102102/167 [=================>............] - ETA: 4:07 - loss: 233507.3620 - acc: 0.1099103/167 [=================>............] - ETA: 4:03 - loss: 231240.3227 - acc: 0.1098104/167 [=================>............] - ETA: 3:59 - loss: 229016.8802 - acc: 0.1095105/167 [=================>............] - ETA: 3:56 - loss: 226835.7890 - acc: 0.1096106/167 [==================>...........] - ETA: 3:52 - loss: 224695.8504 - acc: 0.1094107/167 [==================>...........] - ETA: 3:48 - loss: 222595.9107 - acc: 0.1092108/167 [==================>...........] - ETA: 3:44 - loss: 220534.8586 - acc: 0.1094109/167 [==================>...........] - ETA: 3:39 - loss: 218511.6271 - acc: 0.1093110/167 [==================>...........] - ETA: 3:35 - loss: 216525.1787 - acc: 0.1092111/167 [==================>...........] - ETA: 3:31 - loss: 214574.5222 - acc: 0.1091112/167 [===================>..........] - ETA: 3:27 - loss: 212658.6992 - acc: 0.1094113/167 [===================>..........] - ETA: 3:24 - loss: 210776.7842 - acc: 0.1097114/167 [===================>..........] - ETA: 3:20 - loss: 208927.8854 - acc: 0.1095115/167 [===================>..........] - ETA: 3:16 - loss: 207111.1412 - acc: 0.1092116/167 [===================>..........] - ETA: 3:12 - loss: 205325.7202 - acc: 0.1090117/167 [====================>.........] - ETA: 3:08 - loss: 203570.8191 - acc: 0.1089118/167 [====================>.........] - ETA: 3:05 - loss: 201845.6622 - acc: 0.1087119/167 [====================>.........] - ETA: 3:01 - loss: 200149.4997 - acc: 0.1092120/167 [====================>.........] - ETA: 2:57 - loss: 198481.6064 - acc: 0.1091121/167 [====================>.........] - ETA: 2:54 - loss: 196841.2814 - acc: 0.1093122/167 [====================>.........] - ETA: 2:50 - loss: 195227.8472 - acc: 0.1090123/167 [=====================>........] - ETA: 2:46 - loss: 193640.6475 - acc: 0.1093124/167 [=====================>........] - ETA: 2:42 - loss: 192079.0718 - acc: 0.1094125/167 [=====================>........] - ETA: 2:38 - loss: 190542.4576 - acc: 0.1093126/167 [=====================>........] - ETA: 2:34 - loss: 189030.2341 - acc: 0.1095127/167 [=====================>........] - ETA: 2:30 - loss: 187541.8250 - acc: 0.1096128/167 [=====================>........] - ETA: 2:26 - loss: 186076.6819 - acc: 0.1099129/167 [======================>.......] - ETA: 2:23 - loss: 184634.2449 - acc: 0.1097130/167 [======================>.......] - ETA: 2:19 - loss: 183213.9991 - acc: 0.1095131/167 [======================>.......] - ETA: 2:15 - loss: 181815.4365 - acc: 0.1097132/167 [======================>.......] - ETA: 2:11 - loss: 180438.0643 - acc: 0.1095133/167 [======================>.......] - ETA: 2:08 - loss: 179081.4044 - acc: 0.1095134/167 [=======================>......] - ETA: 2:04 - loss: 177744.9933 - acc: 0.1096135/167 [=======================>......] - ETA: 2:00 - loss: 176428.3807 - acc: 0.1095136/167 [=======================>......] - ETA: 1:56 - loss: 175131.1302 - acc: 0.1092137/167 [=======================>......] - ETA: 1:53 - loss: 173852.8175 - acc: 0.1091138/167 [=======================>......] - ETA: 1:49 - loss: 172593.0312 - acc: 0.1092139/167 [=======================>......] - ETA: 1:45 - loss: 171351.3713 - acc: 0.1092140/167 [========================>.....] - ETA: 1:41 - loss: 170127.4492 - acc: 0.1097141/167 [========================>.....] - ETA: 1:37 - loss: 168920.8889 - acc: 0.1097142/167 [========================>.....] - ETA: 1:34 - loss: 167731.3214 - acc: 0.1097143/167 [========================>.....] - ETA: 1:30 - loss: 166558.3911 - acc: 0.1100144/167 [========================>.....] - ETA: 1:26 - loss: 165401.7513 - acc: 0.1102145/167 [=========================>....] - ETA: 1:22 - loss: 164261.0654 - acc: 0.1102146/167 [=========================>....] - ETA: 1:18 - loss: 163136.0053 - acc: 0.1102147/167 [=========================>....] - ETA: 1:15 - loss: 162026.2536 - acc: 0.1101148/167 [=========================>....] - ETA: 1:11 - loss: 160931.4972 - acc: 0.1100149/167 [=========================>....] - ETA: 1:07 - loss: 159851.4355 - acc: 0.1099150/167 [=========================>....] - ETA: 1:03 - loss: 158785.7746 - acc: 0.1098151/167 [==========================>...] - ETA: 59s - loss: 157734.2284 - acc: 0.1099 152/167 [==========================>...] - ETA: 56s - loss: 156696.5184 - acc: 0.1098153/167 [==========================>...] - ETA: 52s - loss: 155672.3732 - acc: 0.1097154/167 [==========================>...] - ETA: 48s - loss: 154661.5286 - acc: 0.1099155/167 [==========================>...] - ETA: 44s - loss: 153663.7272 - acc: 0.1097156/167 [===========================>..] - ETA: 41s - loss: 152678.7180 - acc: 0.1099157/167 [===========================>..] - ETA: 37s - loss: 151706.2567 - acc: 0.1099158/167 [===========================>..] - ETA: 33s - loss: 150746.1052 - acc: 0.1097159/167 [===========================>..] - ETA: 29s - loss: 149798.0309 - acc: 0.1098160/167 [===========================>..] - ETA: 26s - loss: 148861.8075 - acc: 0.1099161/167 [===========================>..] - ETA: 22s - loss: 147937.2142 - acc: 0.1101162/167 [============================>.] - ETA: 18s - loss: 147024.0567 - acc: 0.1100163/167 [============================>.] - ETA: 14s - loss: 146122.2063 - acc: 0.1100164/167 [============================>.] - ETA: 11s - loss: 145231.2313 - acc: 0.1102165/167 [============================>.] - ETA: 7s - loss: 144351.0559 - acc: 0.1105 166/167 [============================>.] - ETA: 3s - loss: 143481.4869 - acc: 0.1106  1/167 [..............................] - ETA: 4:13 - loss: 2.3184 - acc: 0.1417  2/167 [..............................] - ETA: 3:36 - loss: 2.3185 - acc: 0.1250  3/167 [..............................] - ETA: 3:13 - loss: 2.3200 - acc: 0.1306  4/167 [..............................] - ETA: 3:05 - loss: 2.3142 - acc: 0.1250  5/167 [..............................] - ETA: 2:57 - loss: 2.3109 - acc: 0.1292  6/167 [>.............................] - ETA: 2:59 - loss: 2.3124 - acc: 0.1250  7/167 [>.............................] - ETA: 2:55 - loss: 2.3105 - acc: 0.1238  8/167 [>.............................] - ETA: 2:54 - loss: 2.3124 - acc: 0.1156  9/167 [>.............................] - ETA: 2:51 - loss: 2.3117 - acc: 0.1157 10/167 [>.............................] - ETA: 2:48 - loss: 2.3120 - acc: 0.1125 11/167 [>.............................] - ETA: 2:45 - loss: 2.3129 - acc: 0.1144 12/167 [=>............................] - ETA: 2:43 - loss: 2.3123 - acc: 0.1135 13/167 [=>............................] - ETA: 2:41 - loss: 2.3120 - acc: 0.1125 14/167 [=>............................] - ETA: 2:39 - loss: 2.3135 - acc: 0.1104 15/167 [=>............................] - ETA: 2:37 - loss: 2.3128 - acc: 0.1103 16/167 [=>............................] - ETA: 2:36 - loss: 2.3129 - acc: 0.1081 17/167 [==>...........................] - ETA: 2:33 - loss: 2.3128 - acc: 0.1081 18/167 [==>...........................] - ETA: 2:32 - loss: 2.3125 - acc: 0.1074 19/167 [==>...........................] - ETA: 2:30 - loss: 2.3129 - acc: 0.1064 20/167 [==>...........................] - ETA: 2:28 - loss: 2.3125 - acc: 0.1090 21/167 [==>...........................] - ETA: 2:26 - loss: 2.3115 - acc: 0.1087 22/167 [==>...........................] - ETA: 2:24 - loss: 2.3115 - acc: 0.1093 23/167 [===>..........................] - ETA: 2:22 - loss: 2.3111 - acc: 0.1107 24/167 [===>..........................] - ETA: 2:21 - loss: 2.3100 - acc: 0.1111 25/167 [===>..........................] - ETA: 2:20 - loss: 2.3105 - acc: 0.1115 26/167 [===>..........................] - ETA: 2:18 - loss: 2.3102 - acc: 0.1099 27/167 [===>..........................] - ETA: 2:17 - loss: 2.3101 - acc: 0.1097 28/167 [====>.........................] - ETA: 2:15 - loss: 2.3100 - acc: 0.1103 29/167 [====>.........................] - ETA: 2:14 - loss: 2.3097 - acc: 0.1109 30/167 [====>.........................] - ETA: 2:13 - loss: 2.3098 - acc: 0.1103 31/167 [====>.........................] - ETA: 2:11 - loss: 2.3088 - acc: 0.1094 32/167 [====>.........................] - ETA: 2:10 - loss: 2.3091 - acc: 0.1094 33/167 [====>.........................] - ETA: 2:09 - loss: 2.3092 - acc: 0.1096 34/167 [=====>........................] - ETA: 2:07 - loss: 2.3098 - acc: 0.1092 35/167 [=====>........................] - ETA: 2:06 - loss: 2.3088 - acc: 0.1096 36/167 [=====>........................] - ETA: 2:05 - loss: 2.3084 - acc: 0.1109 37/167 [=====>........................] - ETA: 2:04 - loss: 2.3083 - acc: 0.1111 38/167 [=====>........................] - ETA: 2:03 - loss: 2.3091 - acc: 0.1107 39/167 [======>.......................] - ETA: 2:02 - loss: 2.3094 - acc: 0.1107 40/167 [======>.......................] - ETA: 2:01 - loss: 2.3096 - acc: 0.1114 41/167 [======>.......................] - ETA: 2:00 - loss: 2.3096 - acc: 0.1114 42/167 [======>.......................] - ETA: 1:58 - loss: 2.3098 - acc: 0.1108167/167 [==============================] - 665s 4s/step - loss: 142624.0279 - acc: 0.1107 - val_loss: 2.3098 - val_acc: 0.1108
