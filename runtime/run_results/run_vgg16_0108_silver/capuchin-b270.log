WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1630: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/stropt/lms.py:970: The name tf.train.SessionRunHook is deprecated. Please use tf.estimator.SessionRunHook instead.

WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/stropt/str_strategy.py:122: get_backward_walk_ops (from tensorflow.contrib.graph_editor.select) is deprecated and will be removed after 2019-06-06.
Instructions for updating:
Please use tensorflow.python.ops.op_selector.get_backward_walk_ops.
WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/stropt/lms.py:928: The name tf.logging.info is deprecated. Please use tf.compat.v1.logging.info instead.

1 Physical GPUs, 1 Logical GPUs
Parsing arguments: [('batch_size', 270), ('epochs', 1), ('model_name', 'VGG16'), ('strategy', 'capuchin'), ('verbose', False)]
Cannot find config for batch_size=270, use 250 instead
Shape of x_train: (40000, 224, 224, 3), shape of x_test: (10000, 224, 224, 3)
[STR DEBUG] Parsing STR configuration: [{'strategy': 'hybrid', 'verbose': 'false', 'tags': '/home/zongzan/dist_dnn_training/STR/optimizer/logs/VGG16_250/layer_names'}, {'r': '/home/zongzan/dist_dnn_training/STR/optimizer/logs/VGG16_250/R-capuchin', 'p': '/home/zongzan/dist_dnn_training/STR/optimizer/logs/VGG16_250/P-capuchin', 'q': '/home/zongzan/dist_dnn_training/STR/optimizer/logs/VGG16_250/Q-capuchin'}]
[STR DEBUG] Processing layer 9's swapping, swap out at [11], swap in at [34]
[STR DEBUG] Find swapout ops: name: "block3_conv3/Relu"
op: "Relu"
input: "block3_conv3/BiasAdd"
attr {
  key: "T"
  value {
    type: DT_FLOAT
  }
}
, 
	choose swap tensor Tensor("block3_conv3/Relu:0", shape=(?, 56, 56, 256), dtype=float32), 
	finish at the end of ops: [<tf.Operation 'block4_conv1/Relu' type=Relu>]
[STR DEBUG] Cannot find swap-in control nodes for ref. layer 34, use the last op name: "training/RMSprop/gradients/gradients_7/training/RMSprop/gradients/block3_pool/MaxPool_grad/MaxPoolGrad"
op: "MaxPoolGrad"
input: "training/RMSprop/gradients/block3_conv3/Relu"
input: "training/RMSprop/gradients/block3_pool/MaxPool"
input: "training/RMSprop/gradients/gradients_7/training/RMSprop/gradients/block4_conv1/Conv2D_grad/Conv2DBackpropInput"
attr {
  key: "T"
  value {
    type: DT_FLOAT
  }
}
attr {
  key: "data_format"
  value {
    s: "NHWC"
  }
}
attr {
  key: "ksize"
  value {
    list {
      i: 1
      i: 2
      i: 2
      i: 1
    }
  }
}
attr {
  key: "padding"
  value {
    s: "VALID"
  }
}
attr {
  key: "strides"
  value {
    list {
      i: 1
      i: 2
      i: 2
      i: 1
    }
  }
}

[STR DEBUG] Processing layer 10's swapping, swap out at [12], swap in at [33]
[STR DEBUG] Find swapout ops: name: "block3_pool/MaxPool"
op: "MaxPool"
input: "block3_conv3/Relu"
attr {
  key: "T"
  value {
    type: DT_FLOAT
  }
}
attr {
  key: "data_format"
  value {
    s: "NHWC"
  }
}
attr {
  key: "ksize"
  value {
    list {
      i: 1
      i: 2
      i: 2
      i: 1
    }
  }
}
attr {
  key: "padding"
  value {
    s: "VALID"
  }
}
attr {
  key: "strides"
  value {
    list {
      i: 1
      i: 2
      i: 2
      i: 1
    }
  }
}
, 
	choose swap tensor Tensor("block3_pool/MaxPool:0", shape=(?, 28, 28, 256), dtype=float32), 
	finish at the end of ops: [<tf.Operation 'block4_conv2/Relu' type=Relu>]
[STR DEBUG] Processing layer 11's swapping, swap out at [14], swap in at [32]
[STR DEBUG] Find swapout ops: name: "block4_conv1/Relu"
op: "Relu"
input: "block4_conv1/BiasAdd"
attr {
  key: "T"
  value {
    type: DT_FLOAT
  }
}
, 
	choose swap tensor Tensor("block4_conv1/Relu:0", shape=(?, 28, 28, 512), dtype=float32), 
	finish at the end of ops: [<tf.Operation 'block4_pool/MaxPool' type=MaxPool>]
  1/149 [..............................] - ETA: 1:15:04 - loss: 2.3241 - acc: 0.0926  2/149 [..............................] - ETA: 40:36 - loss: 31503361.1620 - acc: 0.1074  3/149 [..............................] - ETA: 29:10 - loss: 21002245.9448 - acc: 0.1000  4/149 [..............................] - ETA: 23:28 - loss: 15753268.6136 - acc: 0.1102  5/149 [>.............................] - ETA: 19:59 - loss: 12602615.3952 - acc: 0.1081  6/149 [>.............................] - ETA: 17:50 - loss: 10502179.8924 - acc: 0.1086  7/149 [>.............................] - ETA: 16:28 - loss: 9001868.8377 - acc: 0.1079   8/149 [>.............................] - ETA: 15:27 - loss: 7876635.5298 - acc: 0.1069  9/149 [>.............................] - ETA: 14:40 - loss: 7001454.0602 - acc: 0.1049 10/149 [=>............................] - ETA: 14:01 - loss: 6301308.8845 - acc: 0.1052 11/149 [=>............................] - ETA: 13:28 - loss: 5728462.8326 - acc: 0.1034 12/149 [=>............................] - ETA: 12:56 - loss: 5251091.1217 - acc: 0.1031 13/149 [=>............................] - ETA: 12:27 - loss: 4847161.2125 - acc: 0.1037 14/149 [=>............................] - ETA: 11:59 - loss: 4500935.5761 - acc: 0.1026 15/149 [==>...........................] - ETA: 11:42 - loss: 4200873.3573 - acc: 0.1035 16/149 [==>...........................] - ETA: 11:28 - loss: 3938318.9207 - acc: 0.1058 17/149 [==>...........................] - ETA: 11:16 - loss: 3706653.2372 - acc: 0.1052 18/149 [==>...........................] - ETA: 11:05 - loss: 3500728.1852 - acc: 0.1049 19/149 [==>...........................] - ETA: 10:54 - loss: 3316479.4546 - acc: 0.1039 20/149 [===>..........................] - ETA: 10:44 - loss: 3150655.5970 - acc: 0.1031 21/149 [===>..........................] - ETA: 10:34 - loss: 3000624.4878 - acc: 0.1009 22/149 [===>..........................] - ETA: 10:25 - loss: 2864232.5702 - acc: 0.1002 23/149 [===>..........................] - ETA: 10:16 - loss: 2739700.8196 - acc: 0.0992 24/149 [===>..........................] - ETA: 10:09 - loss: 2625546.7145 - acc: 0.0998 25/149 [====>.........................] - ETA: 10:01 - loss: 2520524.9382 - acc: 0.1006 26/149 [====>.........................] - ETA: 9:53 - loss: 2423581.7597 - acc: 0.1026  27/149 [====>.........................] - ETA: 9:46 - loss: 2333819.5574 - acc: 0.1025 28/149 [====>.........................] - ETA: 9:39 - loss: 2250468.9404 - acc: 0.1041 29/149 [====>.........................] - ETA: 9:32 - loss: 2172866.7222 - acc: 0.1029 30/149 [=====>........................] - ETA: 9:25 - loss: 2100437.9082 - acc: 0.1027 31/149 [=====>........................] - ETA: 9:19 - loss: 2032681.9210 - acc: 0.1025 32/149 [=====>........................] - ETA: 9:13 - loss: 1969160.6829 - acc: 0.1017 33/149 [=====>........................] - ETA: 9:05 - loss: 1909489.2172 - acc: 0.1013 34/149 [=====>........................] - ETA: 9:06 - loss: 1853327.8374 - acc: 0.1008 35/149 [======>.......................] - ETA: 8:58 - loss: 1800375.6793 - acc: 0.1005 36/149 [======>.......................] - ETA: 8:51 - loss: 1750365.3077 - acc: 0.1012 37/149 [======>.......................] - ETA: 8:49 - loss: 1703058.1991 - acc: 0.1041 38/149 [======>.......................] - ETA: 8:41 - loss: 1658240.9409 - acc: 0.1041 39/149 [======>.......................] - ETA: 8:33 - loss: 1615722.0014 - acc: 0.1033 40/149 [=======>......................] - ETA: 8:33 - loss: 1575329.0087 - acc: 0.1036 41/149 [=======>......................] - ETA: 8:25 - loss: 1536906.4060 - acc: 0.1036 42/149 [=======>......................] - ETA: 8:25 - loss: 1500313.4509 - acc: 0.1040 43/149 [=======>......................] - ETA: 8:18 - loss: 1465422.4967 - acc: 0.1038 44/149 [=======>......................] - ETA: 8:11 - loss: 1432117.4923 - acc: 0.1040 45/149 [========>.....................] - ETA: 8:04 - loss: 1400292.7102 - acc: 0.1036 46/149 [========>.....................] - ETA: 7:57 - loss: 1369851.6144 - acc: 0.1036 47/149 [========>.....................] - ETA: 7:51 - loss: 1340705.8839 - acc: 0.1044 48/149 [========>.....................] - ETA: 7:50 - loss: 1312774.6358 - acc: 0.1045 49/149 [========>.....................] - ETA: 7:43 - loss: 1285983.3636 - acc: 0.1045 50/149 [=========>....................] - ETA: 7:37 - loss: 1260263.7424 - acc: 0.1047 51/149 [=========>....................] - ETA: 7:31 - loss: 1235552.7337 - acc: 0.1041 52/149 [=========>....................] - ETA: 7:26 - loss: 1211792.1484 - acc: 0.1040 53/149 [=========>....................] - ETA: 7:20 - loss: 1188928.1889 - acc: 0.1036 54/149 [=========>....................] - ETA: 7:16 - loss: 1166911.0428 - acc: 0.1038 55/149 [==========>...................] - ETA: 7:12 - loss: 1145694.5202 - acc: 0.1042 56/149 [==========>...................] - ETA: 7:08 - loss: 1125235.7309 - acc: 0.1044 57/149 [==========>...................] - ETA: 7:04 - loss: 1105494.7935 - acc: 0.1046 58/149 [==========>...................] - ETA: 7:00 - loss: 1086434.5782 - acc: 0.1044 59/149 [==========>...................] - ETA: 6:56 - loss: 1068020.4718 - acc: 0.1042 60/149 [===========>..................] - ETA: 6:52 - loss: 1050220.1689 - acc: 0.1043 61/149 [===========>..................] - ETA: 6:48 - loss: 1033003.4824 - acc: 0.1047 62/149 [===========>..................] - ETA: 6:43 - loss: 1016342.1728 - acc: 0.1049 63/149 [===========>..................] - ETA: 6:38 - loss: 1000209.7939 - acc: 0.1046 64/149 [===========>..................] - ETA: 6:33 - loss: 984581.5518 - acc: 0.1053  65/149 [============>.................] - ETA: 6:28 - loss: 969434.1787 - acc: 0.1052 66/149 [============>.................] - ETA: 6:22 - loss: 954745.8170 - acc: 0.1050 67/149 [============>.................] - ETA: 6:17 - loss: 940495.9137 - acc: 0.1054 68/149 [============>.................] - ETA: 6:12 - loss: 926665.1248 - acc: 0.1065 69/149 [============>.................] - ETA: 6:07 - loss: 913235.2778 - acc: 0.1063 70/149 [=============>................] - ETA: 6:02 - loss: 900189.0927 - acc: 0.1062 71/149 [=============>................] - ETA: 5:57 - loss: 887510.4055 - acc: 0.1056 72/149 [=============>................] - ETA: 5:56 - loss: 875183.9039 - acc: 0.1056 73/149 [=============>................] - ETA: 5:51 - loss: 863195.1147 - acc: 0.1061 74/149 [=============>................] - ETA: 5:47 - loss: 851530.3470 - acc: 0.1055 75/149 [==============>...............] - ETA: 5:42 - loss: 840176.6396 - acc: 0.1058 76/149 [==============>...............] - ETA: 5:37 - loss: 829121.7143 - acc: 0.1055 77/149 [==============>...............] - ETA: 5:33 - loss: 818353.9298 - acc: 0.1054 78/149 [==============>...............] - ETA: 5:28 - loss: 807862.2423 - acc: 0.1053 79/149 [==============>...............] - ETA: 5:23 - loss: 797636.1670 - acc: 0.1056 80/149 [===============>..............] - ETA: 5:19 - loss: 787665.7437 - acc: 0.1055 81/149 [===============>..............] - ETA: 5:14 - loss: 777941.5034 - acc: 0.1063 82/149 [===============>..............] - ETA: 5:09 - loss: 768454.4789 - acc: 0.1062 83/149 [===============>..............] - ETA: 5:05 - loss: 759196.0189 - acc: 0.1064 84/149 [===============>..............] - ETA: 5:00 - loss: 750157.9984 - acc: 0.1065 85/149 [================>.............] - ETA: 4:55 - loss: 741332.6373 - acc: 0.1061 86/149 [================>.............] - ETA: 4:51 - loss: 732712.5170 - acc: 0.1066 87/149 [================>.............] - ETA: 4:46 - loss: 724290.5602 - acc: 0.1065 88/149 [================>.............] - ETA: 4:41 - loss: 716060.0119 - acc: 0.1063 89/149 [================>.............] - ETA: 4:37 - loss: 708014.4196 - acc: 0.1071 90/149 [=================>............] - ETA: 4:32 - loss: 700147.6177 - acc: 0.1080 91/149 [=================>............] - ETA: 4:27 - loss: 692453.7324 - acc: 0.1081 92/149 [=================>............] - ETA: 4:23 - loss: 684927.0864 - acc: 0.1079 93/149 [=================>............] - ETA: 4:18 - loss: 677562.3037 - acc: 0.1080 94/149 [=================>............] - ETA: 4:13 - loss: 670354.2185 - acc: 0.1081 95/149 [==================>...........] - ETA: 4:09 - loss: 663297.8825 - acc: 0.1081 96/149 [==================>...........] - ETA: 4:04 - loss: 656388.5533 - acc: 0.1079 97/149 [==================>...........] - ETA: 3:59 - loss: 649621.6847 - acc: 0.1079 98/149 [==================>...........] - ETA: 3:55 - loss: 642992.9156 - acc: 0.1076 99/149 [==================>...........] - ETA: 3:50 - loss: 636498.0609 - acc: 0.1074100/149 [===================>..........] - ETA: 3:46 - loss: 630133.1033 - acc: 0.1072101/149 [===================>..........] - ETA: 3:41 - loss: 623894.1845 - acc: 0.1070102/149 [===================>..........] - ETA: 3:36 - loss: 617777.5974 - acc: 0.1071103/149 [===================>..........] - ETA: 3:32 - loss: 611779.7789 - acc: 0.1072104/149 [===================>..........] - ETA: 3:27 - loss: 605897.3029 - acc: 0.1071105/149 [====================>.........] - ETA: 3:22 - loss: 600126.8742 - acc: 0.1074106/149 [====================>.........] - ETA: 3:18 - loss: 594465.3213 - acc: 0.1077107/149 [====================>.........] - ETA: 3:13 - loss: 588909.5942 - acc: 0.1082108/149 [====================>.........] - ETA: 3:08 - loss: 583456.7494 - acc: 0.1083109/149 [====================>.........] - ETA: 3:04 - loss: 578103.9563 - acc: 0.1085110/149 [=====================>........] - ETA: 2:59 - loss: 572848.4867 - acc: 0.1085111/149 [=====================>........] - ETA: 2:55 - loss: 567687.7103 - acc: 0.1085112/149 [=====================>........] - ETA: 2:50 - loss: 562619.0909 - acc: 0.1086113/149 [=====================>........] - ETA: 2:45 - loss: 557640.1813 - acc: 0.1088114/149 [=====================>........] - ETA: 2:41 - loss: 552748.6209 - acc: 0.1088115/149 [======================>.......] - ETA: 2:36 - loss: 547942.1312 - acc: 0.1087116/149 [======================>.......] - ETA: 2:31 - loss: 543218.5120 - acc: 0.1086117/149 [======================>.......] - ETA: 2:27 - loss: 538575.6385 - acc: 0.1086118/149 [======================>.......] - ETA: 2:22 - loss: 534011.4576 - acc: 0.1085119/149 [======================>.......] - ETA: 2:17 - loss: 529523.9858 - acc: 0.1084120/149 [=======================>......] - ETA: 2:13 - loss: 525111.3051 - acc: 0.1083121/149 [=======================>......] - ETA: 2:08 - loss: 520771.5614 - acc: 0.1084122/149 [=======================>......] - ETA: 2:04 - loss: 516502.9609 - acc: 0.1081123/149 [=======================>......] - ETA: 1:59 - loss: 512303.7685 - acc: 0.1081124/149 [=======================>......] - ETA: 1:54 - loss: 508172.3051 - acc: 0.1081125/149 [========================>.....] - ETA: 1:50 - loss: 504106.9451 - acc: 0.1083126/149 [========================>.....] - ETA: 1:45 - loss: 500106.1145 - acc: 0.1083127/149 [========================>.....] - ETA: 1:41 - loss: 496168.2893 - acc: 0.1082128/149 [========================>.....] - ETA: 1:36 - loss: 492291.9925 - acc: 0.1079129/149 [========================>.....] - ETA: 1:31 - loss: 488475.7933 - acc: 0.1078130/149 [=========================>....] - ETA: 1:27 - loss: 484718.3049 - acc: 0.1077131/149 [=========================>....] - ETA: 1:22 - loss: 481018.1828 - acc: 0.1076132/149 [=========================>....] - ETA: 1:17 - loss: 477374.1231 - acc: 0.1077133/149 [=========================>....] - ETA: 1:13 - loss: 473784.8612 - acc: 0.1079134/149 [=========================>....] - ETA: 1:08 - loss: 470249.1704 - acc: 0.1079135/149 [==========================>...] - ETA: 1:03 - loss: 466765.8603 - acc: 0.1078136/149 [==========================>...] - ETA: 59s - loss: 463333.7753 - acc: 0.1079 137/149 [==========================>...] - ETA: 54s - loss: 459951.7937 - acc: 0.1078138/149 [==========================>...] - ETA: 49s - loss: 456618.8262 - acc: 0.1079139/149 [==========================>...] - ETA: 45s - loss: 453333.8317 - acc: 0.1080140/149 [===========================>..] - ETA: 40s - loss: 450095.7493 - acc: 0.1079141/149 [===========================>..] - ETA: 36s - loss: 446903.5972 - acc: 0.1077142/149 [===========================>..] - ETA: 31s - loss: 443756.4050 - acc: 0.1080143/149 [===========================>..] - ETA: 26s - loss: 440653.2295 - acc: 0.1080144/149 [===========================>..] - ETA: 22s - loss: 437593.1536 - acc: 0.1081145/149 [============================>.] - ETA: 17s - loss: 434575.2857 - acc: 0.1080146/149 [============================>.] - ETA: 13s - loss: 431598.7583 - acc: 0.1082147/149 [============================>.] - ETA: 8s - loss: 428662.7300 - acc: 0.1083 148/149 [============================>.] - ETA: 4s - loss: 425766.3758 - acc: 0.1081  1/149 [..............................] - ETA: 3:18 - loss: 2.2964 - acc: 0.1333  2/149 [..............................] - ETA: 2:35 - loss: 2.3113 - acc: 0.1093  3/149 [..............................] - ETA: 2:28 - loss: 2.3194 - acc: 0.1049  4/149 [..............................] - ETA: 2:23 - loss: 2.3111 - acc: 0.1046  5/149 [>.............................] - ETA: 2:21 - loss: 2.3069 - acc: 0.1104  6/149 [>.............................] - ETA: 2:13 - loss: 2.3090 - acc: 0.1074  7/149 [>.............................] - ETA: 2:11 - loss: 2.3081 - acc: 0.1085  8/149 [>.............................] - ETA: 2:08 - loss: 2.3085 - acc: 0.1074  9/149 [>.............................] - ETA: 2:06 - loss: 2.3080 - acc: 0.1066 10/149 [=>............................] - ETA: 2:03 - loss: 2.3085 - acc: 0.1067 11/149 [=>............................] - ETA: 2:03 - loss: 2.3091 - acc: 0.1054 12/149 [=>............................] - ETA: 2:00 - loss: 2.3092 - acc: 0.1049 13/149 [=>............................] - ETA: 1:59 - loss: 2.3111 - acc: 0.1028 14/149 [=>............................] - ETA: 1:58 - loss: 2.3108 - acc: 0.1016 15/149 [==>...........................] - ETA: 1:58 - loss: 2.3105 - acc: 0.1022 16/149 [==>...........................] - ETA: 1:57 - loss: 2.3092 - acc: 0.1032 17/149 [==>...........................] - ETA: 1:56 - loss: 2.3091 - acc: 0.1033 18/149 [==>...........................] - ETA: 1:55 - loss: 2.3105 - acc: 0.1014 19/149 [==>...........................] - ETA: 1:54 - loss: 2.3108 - acc: 0.1000 20/149 [===>..........................] - ETA: 1:53 - loss: 2.3113 - acc: 0.0987 21/149 [===>..........................] - ETA: 1:53 - loss: 2.3133 - acc: 0.0977 22/149 [===>..........................] - ETA: 1:52 - loss: 2.3149 - acc: 0.0966 23/149 [===>..........................] - ETA: 1:51 - loss: 2.3155 - acc: 0.0963 24/149 [===>..........................] - ETA: 1:50 - loss: 2.3144 - acc: 0.0975 25/149 [====>.........................] - ETA: 1:49 - loss: 2.3137 - acc: 0.0976 26/149 [====>.........................] - ETA: 1:48 - loss: 2.3133 - acc: 0.0977 27/149 [====>.........................] - ETA: 1:47 - loss: 2.3131 - acc: 0.0973 28/149 [====>.........................] - ETA: 1:47 - loss: 2.3133 - acc: 0.0975 29/149 [====>.........................] - ETA: 1:46 - loss: 2.3127 - acc: 0.0976 30/149 [=====>........................] - ETA: 1:45 - loss: 2.3116 - acc: 0.0968 31/149 [=====>........................] - ETA: 1:44 - loss: 2.3114 - acc: 0.0986 32/149 [=====>........................] - ETA: 1:43 - loss: 2.3104 - acc: 0.0991 33/149 [=====>........................] - ETA: 1:42 - loss: 2.3103 - acc: 0.0997 34/149 [=====>........................] - ETA: 1:41 - loss: 2.3109 - acc: 0.0998 35/149 [======>.......................] - ETA: 1:39 - loss: 2.3111 - acc: 0.0999 36/149 [======>.......................] - ETA: 1:38 - loss: 2.3110 - acc: 0.0996 37/149 [======>.......................] - ETA: 1:37 - loss: 2.3100 - acc: 0.1000 38/149 [======>.......................] - ETA: 1:35 - loss: 2.3086 - acc: 0.1000149/149 [==============================] - 693s 5s/step - loss: 422925.1102 - acc: 0.1081 - val_loss: 2.3086 - val_acc: 0.1000
