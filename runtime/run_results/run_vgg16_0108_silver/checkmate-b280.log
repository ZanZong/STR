WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1630: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/stropt/lms.py:970: The name tf.train.SessionRunHook is deprecated. Please use tf.estimator.SessionRunHook instead.

WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/stropt/str_strategy.py:122: get_backward_walk_ops (from tensorflow.contrib.graph_editor.select) is deprecated and will be removed after 2019-06-06.
Instructions for updating:
Please use tensorflow.python.ops.op_selector.get_backward_walk_ops.
1 Physical GPUs, 1 Logical GPUs
Parsing arguments: [('batch_size', 280), ('epochs', 1), ('model_name', 'VGG16'), ('strategy', 'checkmate'), ('verbose', False)]
Cannot find config for batch_size=280, use 250 instead
Shape of x_train: (40000, 224, 224, 3), shape of x_test: (10000, 224, 224, 3)
[STR DEBUG] Parsing STR configuration: [{'strategy': 'recompute', 'verbose': 'false', 'tags': '/home/zongzan/dist_dnn_training/STR/optimizer/logs/VGG16_250/layer_names'}, {'r': '/home/zongzan/dist_dnn_training/STR/optimizer/logs/VGG16_250/R-checkmate'}]
  1/143 [..............................] - ETA: 1:01:52 - loss: 2.2966 - acc: 0.1500  2/143 [..............................] - ETA: 33:23 - loss: 64430145.1483 - acc: 0.1125  3/143 [..............................] - ETA: 23:52 - loss: 42953461.9215 - acc: 0.1060  4/143 [..............................] - ETA: 19:02 - loss: 32215106.9088 - acc: 0.1036  5/143 [>.............................] - ETA: 16:08 - loss: 25772288.8587 - acc: 0.0979  6/143 [>.............................] - ETA: 14:11 - loss: 21476943.7327 - acc: 0.0970  7/143 [>.............................] - ETA: 12:48 - loss: 18408811.2336 - acc: 0.0969  8/143 [>.............................] - ETA: 11:45 - loss: 16107719.6229 - acc: 0.0960  9/143 [>.............................] - ETA: 10:56 - loss: 14317973.3290 - acc: 0.0992 10/143 [=>............................] - ETA: 10:16 - loss: 12886176.3424 - acc: 0.0996 11/143 [=>............................] - ETA: 9:44 - loss: 11714705.9751 - acc: 0.0971  12/143 [=>............................] - ETA: 9:16 - loss: 10738480.6682 - acc: 0.0991 13/143 [=>............................] - ETA: 8:53 - loss: 9912443.9805 - acc: 0.0964  14/143 [=>............................] - ETA: 8:34 - loss: 9204412.4334 - acc: 0.0987 15/143 [==>...........................] - ETA: 8:15 - loss: 8590785.0912 - acc: 0.0993 16/143 [==>...........................] - ETA: 7:59 - loss: 8053861.1675 - acc: 0.0984 17/143 [==>...........................] - ETA: 7:45 - loss: 7580104.7638 - acc: 0.0977 18/143 [==>...........................] - ETA: 7:32 - loss: 7158987.9601 - acc: 0.0978 19/143 [==>...........................] - ETA: 7:21 - loss: 6782199.2409 - acc: 0.0994 20/143 [===>..........................] - ETA: 7:11 - loss: 6443089.3935 - acc: 0.0991 21/143 [===>..........................] - ETA: 7:01 - loss: 6136275.7222 - acc: 0.0988 22/143 [===>..........................] - ETA: 6:52 - loss: 5857354.2049 - acc: 0.0974 23/143 [===>..........................] - ETA: 6:44 - loss: 5602686.7311 - acc: 0.0963 24/143 [====>.........................] - ETA: 6:36 - loss: 5369241.5466 - acc: 0.0966 25/143 [====>.........................] - ETA: 6:29 - loss: 5154471.9760 - acc: 0.0964 26/143 [====>.........................] - ETA: 6:22 - loss: 4956223.1402 - acc: 0.0968 27/143 [====>.........................] - ETA: 6:16 - loss: 4772659.4050 - acc: 0.0955 28/143 [====>.........................] - ETA: 6:09 - loss: 4602207.4088 - acc: 0.0959 29/143 [=====>........................] - ETA: 6:03 - loss: 4443510.6820 - acc: 0.0975 30/143 [=====>........................] - ETA: 5:57 - loss: 4295393.7362 - acc: 0.0974 31/143 [=====>........................] - ETA: 5:52 - loss: 4156832.7221 - acc: 0.0976 32/143 [=====>........................] - ETA: 5:46 - loss: 4026931.7722 - acc: 0.0982 33/143 [=====>........................] - ETA: 5:41 - loss: 3904903.6061 - acc: 0.0985 34/143 [======>.......................] - ETA: 5:36 - loss: 3790053.5675 - acc: 0.0981 35/143 [======>.......................] - ETA: 5:31 - loss: 3681766.3887 - acc: 0.0986 36/143 [======>.......................] - ETA: 5:26 - loss: 3579495.1637 - acc: 0.1000 37/143 [======>.......................] - ETA: 5:22 - loss: 3482752.1135 - acc: 0.0993 38/143 [======>.......................] - ETA: 5:17 - loss: 3391100.8024 - acc: 0.0994 39/143 [=======>......................] - ETA: 5:13 - loss: 3304149.5583 - acc: 0.1000 40/143 [=======>......................] - ETA: 5:09 - loss: 3221545.8757 - acc: 0.1021 41/143 [=======>......................] - ETA: 5:04 - loss: 3142971.6418 - acc: 0.1027 42/143 [=======>......................] - ETA: 5:00 - loss: 3068139.0382 - acc: 0.1024 43/143 [========>.....................] - ETA: 4:56 - loss: 2996787.0208 - acc: 0.1029 44/143 [========>.....................] - ETA: 4:52 - loss: 2928678.2768 - acc: 0.1037 45/143 [========>.....................] - ETA: 4:47 - loss: 2863596.5880 - acc: 0.1040 46/143 [========>.....................] - ETA: 4:43 - loss: 2801344.5376 - acc: 0.1047 47/143 [========>.....................] - ETA: 4:39 - loss: 2741741.5104 - acc: 0.1050 48/143 [=========>....................] - ETA: 4:35 - loss: 2684621.9438 - acc: 0.1048 49/143 [=========>....................] - ETA: 4:31 - loss: 2629833.7877 - acc: 0.1053 50/143 [=========>....................] - ETA: 4:27 - loss: 2577237.1573 - acc: 0.1061 51/143 [=========>....................] - ETA: 4:24 - loss: 2526703.1407 - acc: 0.1067 52/143 [=========>....................] - ETA: 4:20 - loss: 2478112.7401 - acc: 0.1070 53/143 [==========>...................] - ETA: 4:16 - loss: 2431355.9394 - acc: 0.1069 54/143 [==========>...................] - ETA: 4:13 - loss: 2386330.8717 - acc: 0.1068 55/143 [==========>...................] - ETA: 4:09 - loss: 2342943.0792 - acc: 0.1069 56/143 [==========>...................] - ETA: 4:06 - loss: 2301104.8504 - acc: 0.1072 57/143 [==========>...................] - ETA: 4:02 - loss: 2260734.6295 - acc: 0.1083 58/143 [===========>..................] - ETA: 3:59 - loss: 2221756.4849 - acc: 0.1091 59/143 [===========>..................] - ETA: 3:55 - loss: 2184099.6327 - acc: 0.1105 60/143 [===========>..................] - ETA: 3:52 - loss: 2147698.0105 - acc: 0.1105 61/143 [===========>..................] - ETA: 3:48 - loss: 2112489.8844 - acc: 0.1102 62/143 [============>.................] - ETA: 3:45 - loss: 2078417.5037 - acc: 0.1105 63/143 [============>.................] - ETA: 3:42 - loss: 2045426.7865 - acc: 0.1104 64/143 [============>.................] - ETA: 3:38 - loss: 2013467.0288 - acc: 0.1103 65/143 [============>.................] - ETA: 3:51 - loss: 1982490.6479 - acc: 0.1110 66/143 [============>.................] - ETA: 3:47 - loss: 1952452.9451 - acc: 0.1112 67/143 [=============>................] - ETA: 3:43 - loss: 1923311.8905 - acc: 0.1122 68/143 [=============>................] - ETA: 3:40 - loss: 1895027.9249 - acc: 0.1128 69/143 [=============>................] - ETA: 3:36 - loss: 1867563.7980 - acc: 0.1131 70/143 [=============>................] - ETA: 3:33 - loss: 1840884.3482 - acc: 0.1127 71/143 [=============>................] - ETA: 3:29 - loss: 1814956.4321 - acc: 0.1130 72/143 [==============>...............] - ETA: 3:26 - loss: 1789748.7358 - acc: 0.1130 73/143 [==============>...............] - ETA: 3:22 - loss: 1765231.6615 - acc: 0.1126 74/143 [==============>...............] - ETA: 3:19 - loss: 1741377.2106 - acc: 0.1122 75/143 [==============>...............] - ETA: 3:16 - loss: 1718158.8785 - acc: 0.1120 76/143 [==============>...............] - ETA: 3:12 - loss: 1695551.5551 - acc: 0.1121 77/143 [===============>..............] - ETA: 3:09 - loss: 1673531.4348 - acc: 0.1121 78/143 [===============>..............] - ETA: 3:06 - loss: 1652075.9328 - acc: 0.1121 79/143 [===============>..............] - ETA: 3:03 - loss: 1631163.6082 - acc: 0.1122 80/143 [===============>..............] - ETA: 2:59 - loss: 1610774.0920 - acc: 0.1122 81/143 [===============>..............] - ETA: 2:56 - loss: 1590888.0204 - acc: 0.1125 82/143 [================>.............] - ETA: 2:53 - loss: 1571486.9747 - acc: 0.1133 83/143 [================>.............] - ETA: 2:50 - loss: 1552553.4245 - acc: 0.1136 84/143 [================>.............] - ETA: 2:46 - loss: 1534070.6732 - acc: 0.1137 85/143 [================>.............] - ETA: 2:43 - loss: 1516022.8100 - acc: 0.1131 86/143 [=================>............] - ETA: 2:40 - loss: 1498394.6646 - acc: 0.1130 87/143 [=================>............] - ETA: 2:37 - loss: 1481171.7637 - acc: 0.1127 88/143 [=================>............] - ETA: 2:34 - loss: 1464340.2933 - acc: 0.1127 89/143 [=================>............] - ETA: 2:31 - loss: 1447887.0581 - acc: 0.1123 90/143 [=================>............] - ETA: 2:28 - loss: 1431799.4497 - acc: 0.1121 91/143 [==================>...........] - ETA: 2:25 - loss: 1416065.4151 - acc: 0.1119 92/143 [==================>...........] - ETA: 2:22 - loss: 1400673.4247 - acc: 0.1119 93/143 [==================>...........] - ETA: 2:19 - loss: 1385612.4446 - acc: 0.1119 94/143 [==================>...........] - ETA: 2:16 - loss: 1370871.9205 - acc: 0.1118 95/143 [==================>...........] - ETA: 2:13 - loss: 1356441.7140 - acc: 0.1116 96/143 [===================>..........] - ETA: 2:10 - loss: 1342312.4442 - acc: 0.1118 97/143 [===================>..........] - ETA: 2:07 - loss: 1328474.1954 - acc: 0.1120 98/143 [===================>..........] - ETA: 2:04 - loss: 1314918.3596 - acc: 0.1126 99/143 [===================>..........] - ETA: 2:01 - loss: 1301636.3798 - acc: 0.1126100/143 [===================>..........] - ETA: 1:58 - loss: 1288620.0390 - acc: 0.1126101/143 [====================>.........] - ETA: 1:55 - loss: 1275861.4476 - acc: 0.1129102/143 [====================>.........] - ETA: 1:52 - loss: 1263353.0246 - acc: 0.1128103/143 [====================>.........] - ETA: 1:49 - loss: 1251087.4836 - acc: 0.1130104/143 [====================>.........] - ETA: 1:46 - loss: 1239057.8183 - acc: 0.1128105/143 [=====================>........] - ETA: 1:43 - loss: 1227257.2896 - acc: 0.1126106/143 [=====================>........] - ETA: 1:41 - loss: 1215679.4122 - acc: 0.1131107/143 [=====================>........] - ETA: 1:38 - loss: 1204317.9450 - acc: 0.1133108/143 [=====================>........] - ETA: 1:35 - loss: 1193166.8744 - acc: 0.1130109/143 [=====================>........] - ETA: 1:32 - loss: 1182220.4104 - acc: 0.1129110/143 [======================>.......] - ETA: 1:29 - loss: 1171472.9731 - acc: 0.1128111/143 [======================>.......] - ETA: 1:26 - loss: 1160919.1832 - acc: 0.1124112/143 [======================>.......] - ETA: 1:24 - loss: 1150553.8539 - acc: 0.1125113/143 [======================>.......] - ETA: 1:21 - loss: 1140371.9817 - acc: 0.1128114/143 [======================>.......] - ETA: 1:18 - loss: 1130368.7388 - acc: 0.1130115/143 [=======================>......] - ETA: 1:15 - loss: 1120539.4652 - acc: 0.1131116/143 [=======================>......] - ETA: 1:12 - loss: 1110879.6706 - acc: 0.1129117/143 [=======================>......] - ETA: 1:10 - loss: 1101384.9922 - acc: 0.1129118/143 [=======================>......] - ETA: 1:07 - loss: 1092051.2403 - acc: 0.1131119/143 [=======================>......] - ETA: 1:04 - loss: 1082874.3583 - acc: 0.1131120/143 [========================>.....] - ETA: 1:01 - loss: 1073850.4778 - acc: 0.1133121/143 [========================>.....] - ETA: 59s - loss: 1064975.6998 - acc: 0.1131 122/143 [========================>.....] - ETA: 56s - loss: 1056246.4143 - acc: 0.1130123/143 [========================>.....] - ETA: 53s - loss: 1047659.0639 - acc: 0.1129124/143 [=========================>....] - ETA: 50s - loss: 1039210.2190 - acc: 0.1126125/143 [=========================>....] - ETA: 48s - loss: 1030896.5556 - acc: 0.1124126/143 [=========================>....] - ETA: 45s - loss: 1022714.8561 - acc: 0.1123127/143 [=========================>....] - ETA: 42s - loss: 1014662.0014 - acc: 0.1123128/143 [=========================>....] - ETA: 39s - loss: 1006734.9724 - acc: 0.1121129/143 [==========================>...] - ETA: 37s - loss: 998930.8432 - acc: 0.1123 130/143 [==========================>...] - ETA: 34s - loss: 991246.7776 - acc: 0.1121131/143 [==========================>...] - ETA: 31s - loss: 983680.0258 - acc: 0.1120132/143 [==========================>...] - ETA: 29s - loss: 976227.9219 - acc: 0.1118133/143 [==========================>...] - ETA: 26s - loss: 968887.8796 - acc: 0.1119134/143 [===========================>..] - ETA: 23s - loss: 961657.3903 - acc: 0.1118135/143 [===========================>..] - ETA: 21s - loss: 954534.0192 - acc: 0.1119136/143 [===========================>..] - ETA: 18s - loss: 947515.4036 - acc: 0.1119137/143 [===========================>..] - ETA: 15s - loss: 940599.2494 - acc: 0.1122138/143 [===========================>..] - ETA: 13s - loss: 933783.3292 - acc: 0.1124139/143 [============================>.] - ETA: 10s - loss: 927065.5823 - acc: 0.1124140/143 [============================>.] - ETA: 7s - loss: 920443.7017 - acc: 0.1120 141/143 [============================>.] - ETA: 5s - loss: 913915.7486 - acc: 0.1119142/143 [============================>.] - ETA: 2s - loss: 907479.7383 - acc: 0.1120  1/143 [..............................] - ETA: 2:35 - loss: 2.3039 - acc: 0.1036  2/143 [..............................] - ETA: 2:00 - loss: 2.2989 - acc: 0.1054  3/143 [..............................] - ETA: 1:50 - loss: 2.2979 - acc: 0.1155  4/143 [..............................] - ETA: 1:42 - loss: 2.2983 - acc: 0.1152  5/143 [>.............................] - ETA: 1:38 - loss: 2.2996 - acc: 0.1093  6/143 [>.............................] - ETA: 1:35 - loss: 2.2986 - acc: 0.1083  7/143 [>.............................] - ETA: 1:32 - loss: 2.2993 - acc: 0.1071  8/143 [>.............................] - ETA: 1:30 - loss: 2.2988 - acc: 0.1054  9/143 [>.............................] - ETA: 1:28 - loss: 2.2992 - acc: 0.1052 10/143 [=>............................] - ETA: 1:27 - loss: 2.2986 - acc: 0.1061 11/143 [=>............................] - ETA: 1:26 - loss: 2.2986 - acc: 0.1042 12/143 [=>............................] - ETA: 1:26 - loss: 2.2987 - acc: 0.1060 13/143 [=>............................] - ETA: 1:25 - loss: 2.2981 - acc: 0.1036 14/143 [=>............................] - ETA: 1:24 - loss: 2.2981 - acc: 0.1054 15/143 [==>...........................] - ETA: 1:23 - loss: 2.2981 - acc: 0.1081 16/143 [==>...........................] - ETA: 1:22 - loss: 2.2981 - acc: 0.1060 17/143 [==>...........................] - ETA: 1:21 - loss: 2.2978 - acc: 0.1057 18/143 [==>...........................] - ETA: 1:21 - loss: 2.2976 - acc: 0.1069 19/143 [==>...........................] - ETA: 1:20 - loss: 2.2973 - acc: 0.1081 20/143 [===>..........................] - ETA: 1:20 - loss: 2.2970 - acc: 0.1086 21/143 [===>..........................] - ETA: 1:19 - loss: 2.2967 - acc: 0.1097 22/143 [===>..........................] - ETA: 1:19 - loss: 2.2967 - acc: 0.1089 23/143 [===>..........................] - ETA: 1:18 - loss: 2.2967 - acc: 0.1090 24/143 [====>.........................] - ETA: 1:18 - loss: 2.2966 - acc: 0.1082 25/143 [====>.........................] - ETA: 1:17 - loss: 2.2969 - acc: 0.1071 26/143 [====>.........................] - ETA: 1:16 - loss: 2.2968 - acc: 0.1076 27/143 [====>.........................] - ETA: 1:15 - loss: 2.2968 - acc: 0.1065 28/143 [====>.........................] - ETA: 1:15 - loss: 2.2969 - acc: 0.1061 29/143 [=====>........................] - ETA: 1:14 - loss: 2.2969 - acc: 0.1059 30/143 [=====>........................] - ETA: 1:13 - loss: 2.2972 - acc: 0.1050 31/143 [=====>........................] - ETA: 1:12 - loss: 2.2973 - acc: 0.1046 32/143 [=====>........................] - ETA: 1:11 - loss: 2.2972 - acc: 0.1048 33/143 [=====>........................] - ETA: 1:11 - loss: 2.2974 - acc: 0.1042 34/143 [======>.......................] - ETA: 1:10 - loss: 2.2974 - acc: 0.1046 35/143 [======>.......................] - ETA: 1:09 - loss: 2.2974 - acc: 0.1044 36/143 [======>.......................] - ETA: 1:19 - loss: 2.2974 - acc: 0.1046143/143 [==============================] - 403s 3s/step - loss: 901140.0007 - acc: 0.1118 - val_loss: 2.2974 - val_acc: 0.1046
