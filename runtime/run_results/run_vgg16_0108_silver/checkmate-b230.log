WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1630: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/stropt/lms.py:970: The name tf.train.SessionRunHook is deprecated. Please use tf.estimator.SessionRunHook instead.

WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/stropt/str_strategy.py:122: get_backward_walk_ops (from tensorflow.contrib.graph_editor.select) is deprecated and will be removed after 2019-06-06.
Instructions for updating:
Please use tensorflow.python.ops.op_selector.get_backward_walk_ops.
1 Physical GPUs, 1 Logical GPUs
Parsing arguments: [('batch_size', 230), ('epochs', 1), ('model_name', 'VGG16'), ('strategy', 'checkmate'), ('verbose', False)]
Cannot find config for batch_size=230, use 250 instead
Shape of x_train: (40000, 224, 224, 3), shape of x_test: (10000, 224, 224, 3)
[STR DEBUG] Parsing STR configuration: [{'strategy': 'recompute', 'verbose': 'false', 'tags': '/home/zongzan/dist_dnn_training/STR/optimizer/logs/VGG16_250/layer_names'}, {'r': '/home/zongzan/dist_dnn_training/STR/optimizer/logs/VGG16_250/R-checkmate'}]
  1/174 [..............................] - ETA: 1:11:13 - loss: 2.3419 - acc: 0.1174  2/174 [..............................] - ETA: 38:20 - loss: 28408505.1709 - acc: 0.1000  3/174 [..............................] - ETA: 27:17 - loss: 18939075.4301 - acc: 0.0913  4/174 [..............................] - ETA: 21:54 - loss: 14204311.9461 - acc: 0.0946  5/174 [..............................] - ETA: 18:37 - loss: 11365171.7356 - acc: 0.0896  6/174 [>.............................] - ETA: 16:24 - loss: 9470977.9355 - acc: 0.0891   7/174 [>.............................] - ETA: 14:48 - loss: 8117982.7732 - acc: 0.0882  8/174 [>.............................] - ETA: 13:39 - loss: 7103235.6429 - acc: 0.0859  9/174 [>.............................] - ETA: 12:46 - loss: 6313987.8605 - acc: 0.0874 10/174 [>.............................] - ETA: 12:02 - loss: 5682589.4139 - acc: 0.0874 11/174 [>.............................] - ETA: 11:27 - loss: 5165990.6223 - acc: 0.0877 12/174 [=>............................] - ETA: 10:56 - loss: 4735491.5954 - acc: 0.0888 13/174 [=>............................] - ETA: 10:30 - loss: 4371223.1884 - acc: 0.0896 14/174 [=>............................] - ETA: 10:08 - loss: 4058993.1251 - acc: 0.0916 15/174 [=>............................] - ETA: 9:49 - loss: 3788393.7368 - acc: 0.0913  16/174 [=>............................] - ETA: 9:33 - loss: 3551619.2714 - acc: 0.0924 17/174 [=>............................] - ETA: 9:19 - loss: 3342700.6264 - acc: 0.0908 18/174 [==>...........................] - ETA: 9:06 - loss: 3156995.1648 - acc: 0.0930 19/174 [==>...........................] - ETA: 8:54 - loss: 2990837.6460 - acc: 0.0934 20/174 [==>...........................] - ETA: 8:44 - loss: 2841295.8788 - acc: 0.0924 21/174 [==>...........................] - ETA: 8:37 - loss: 2705996.1846 - acc: 0.0936 22/174 [==>...........................] - ETA: 8:30 - loss: 2582996.4633 - acc: 0.0933 23/174 [==>...........................] - ETA: 8:22 - loss: 2470692.3694 - acc: 0.0926 24/174 [===>..........................] - ETA: 8:14 - loss: 2367746.9500 - acc: 0.0935 25/174 [===>..........................] - ETA: 8:06 - loss: 2273037.1640 - acc: 0.0946 26/174 [===>..........................] - ETA: 7:59 - loss: 2185612.7462 - acc: 0.0953 27/174 [===>..........................] - ETA: 7:53 - loss: 2104664.2111 - acc: 0.0961 28/174 [===>..........................] - ETA: 7:46 - loss: 2029497.7142 - acc: 0.0975 29/174 [====>.........................] - ETA: 7:40 - loss: 1959515.1133 - acc: 0.0988 30/174 [====>.........................] - ETA: 7:34 - loss: 1894198.0193 - acc: 0.0987 31/174 [====>.........................] - ETA: 7:28 - loss: 1833094.9315 - acc: 0.0993 32/174 [====>.........................] - ETA: 7:23 - loss: 1775810.7864 - acc: 0.0996 33/174 [====>.........................] - ETA: 7:18 - loss: 1721998.4073 - acc: 0.0999 34/174 [====>.........................] - ETA: 7:13 - loss: 1671351.4632 - acc: 0.1006 35/174 [=====>........................] - ETA: 7:08 - loss: 1623598.6299 - acc: 0.1011 36/174 [=====>........................] - ETA: 7:03 - loss: 1578498.7312 - acc: 0.1017 37/174 [=====>........................] - ETA: 6:58 - loss: 1535836.7255 - acc: 0.1019 38/174 [=====>........................] - ETA: 6:53 - loss: 1495420.0301 - acc: 0.1030 39/174 [=====>........................] - ETA: 6:49 - loss: 1457075.9857 - acc: 0.1031 40/174 [=====>........................] - ETA: 6:44 - loss: 1420649.1441 - acc: 0.1030 41/174 [======>.......................] - ETA: 6:40 - loss: 1385999.2210 - acc: 0.1033 42/174 [======>.......................] - ETA: 6:36 - loss: 1352999.2944 - acc: 0.1032 43/174 [======>.......................] - ETA: 6:31 - loss: 1321534.2480 - acc: 0.1031 44/174 [======>.......................] - ETA: 6:27 - loss: 1291499.4306 - acc: 0.1035 45/174 [======>.......................] - ETA: 6:23 - loss: 1262799.4939 - acc: 0.1034 46/174 [======>.......................] - ETA: 6:19 - loss: 1235347.4491 - acc: 0.1032 47/174 [=======>......................] - ETA: 6:15 - loss: 1209063.5161 - acc: 0.1033 48/174 [=======>......................] - ETA: 6:11 - loss: 1183874.7409 - acc: 0.1022 49/174 [=======>......................] - ETA: 6:07 - loss: 1159714.0789 - acc: 0.1027 50/174 [=======>......................] - ETA: 6:05 - loss: 1136519.8434 - acc: 0.1027 51/174 [=======>......................] - ETA: 6:03 - loss: 1114235.1857 - acc: 0.1034 52/174 [=======>......................] - ETA: 6:00 - loss: 1092807.6300 - acc: 0.1032 53/174 [========>.....................] - ETA: 5:56 - loss: 1072188.6636 - acc: 0.1034 54/174 [========>.....................] - ETA: 5:52 - loss: 1052333.3615 - acc: 0.1035 55/174 [========>.....................] - ETA: 5:49 - loss: 1033200.0695 - acc: 0.1038 56/174 [========>.....................] - ETA: 5:45 - loss: 1014750.1094 - acc: 0.1036 57/174 [========>.....................] - ETA: 5:42 - loss: 996947.5163 - acc: 0.1042  58/174 [=========>....................] - ETA: 5:38 - loss: 979758.8057 - acc: 0.1041 59/174 [=========>....................] - ETA: 5:35 - loss: 963152.7633 - acc: 0.1041 60/174 [=========>....................] - ETA: 5:31 - loss: 947100.2556 - acc: 0.1036 61/174 [=========>....................] - ETA: 5:28 - loss: 931574.0597 - acc: 0.1036 62/174 [=========>....................] - ETA: 5:25 - loss: 916548.7088 - acc: 0.1039 63/174 [=========>....................] - ETA: 5:21 - loss: 902000.3531 - acc: 0.1037 64/174 [==========>...................] - ETA: 5:18 - loss: 887906.6336 - acc: 0.1041 65/174 [==========>...................] - ETA: 5:15 - loss: 874246.5669 - acc: 0.1041 66/174 [==========>...................] - ETA: 5:12 - loss: 861000.4417 - acc: 0.1042 67/174 [==========>...................] - ETA: 5:08 - loss: 848149.7232 - acc: 0.1046 68/174 [==========>...................] - ETA: 5:05 - loss: 835676.9670 - acc: 0.1046 69/174 [==========>...................] - ETA: 5:02 - loss: 823565.7399 - acc: 0.1049 70/174 [===========>..................] - ETA: 4:59 - loss: 811800.5483 - acc: 0.1047 71/174 [===========>..................] - ETA: 4:56 - loss: 800366.7702 - acc: 0.1043 72/174 [===========>..................] - ETA: 4:53 - loss: 789250.5971 - acc: 0.1046 73/174 [===========>..................] - ETA: 4:50 - loss: 778438.9766 - acc: 0.1043 74/174 [===========>..................] - ETA: 4:46 - loss: 767919.5620 - acc: 0.1049 75/174 [===========>..................] - ETA: 4:43 - loss: 757680.6658 - acc: 0.1048 76/174 [============>.................] - ETA: 4:40 - loss: 747711.2137 - acc: 0.1046 77/174 [============>.................] - ETA: 4:37 - loss: 738000.7083 - acc: 0.1043 78/174 [============>.................] - ETA: 4:34 - loss: 728539.1902 - acc: 0.1041 79/174 [============>.................] - ETA: 4:31 - loss: 719317.2043 - acc: 0.1042 80/174 [============>.................] - ETA: 4:28 - loss: 710325.7680 - acc: 0.1039 81/174 [============>.................] - ETA: 4:25 - loss: 701556.3425 - acc: 0.1038 82/174 [=============>................] - ETA: 4:22 - loss: 693000.8054 - acc: 0.1037 83/174 [=============>................] - ETA: 4:19 - loss: 684651.4258 - acc: 0.1042 84/174 [=============>................] - ETA: 4:16 - loss: 676500.8418 - acc: 0.1041 85/174 [=============>................] - ETA: 4:13 - loss: 668542.0355 - acc: 0.1036 86/174 [=============>................] - ETA: 4:10 - loss: 660768.3176 - acc: 0.1032 87/174 [==============>...............] - ETA: 4:07 - loss: 653173.3060 - acc: 0.1033 88/174 [==============>...............] - ETA: 4:04 - loss: 645750.9082 - acc: 0.1036 89/174 [==============>...............] - ETA: 4:02 - loss: 638495.3057 - acc: 0.1043 90/174 [==============>...............] - ETA: 3:59 - loss: 631400.9398 - acc: 0.1044 91/174 [==============>...............] - ETA: 3:56 - loss: 624462.4932 - acc: 0.1045 92/174 [==============>...............] - ETA: 3:53 - loss: 617674.8824 - acc: 0.1044 93/174 [===============>..............] - ETA: 3:50 - loss: 611033.2430 - acc: 0.1045 94/174 [===============>..............] - ETA: 3:46 - loss: 604532.9139 - acc: 0.1046 95/174 [===============>..............] - ETA: 3:43 - loss: 598169.4338 - acc: 0.1044 96/174 [===============>..............] - ETA: 3:41 - loss: 591938.5262 - acc: 0.1045 97/174 [===============>..............] - ETA: 3:38 - loss: 585836.0909 - acc: 0.1043 98/174 [===============>..............] - ETA: 3:51 - loss: 579858.1951 - acc: 0.1044 99/174 [================>.............] - ETA: 3:47 - loss: 574001.0648 - acc: 0.1044100/174 [================>.............] - ETA: 3:44 - loss: 568261.0772 - acc: 0.1046101/174 [================>.............] - ETA: 3:40 - loss: 562634.7527 - acc: 0.1047102/174 [================>.............] - ETA: 3:37 - loss: 557118.7483 - acc: 0.1047103/174 [================>.............] - ETA: 3:33 - loss: 551709.8507 - acc: 0.1054104/174 [================>.............] - ETA: 3:30 - loss: 546404.9709 - acc: 0.1051105/174 [=================>............] - ETA: 3:27 - loss: 541201.1359 - acc: 0.1049106/174 [=================>............] - ETA: 3:23 - loss: 536095.4866 - acc: 0.1050107/174 [=================>............] - ETA: 3:20 - loss: 531085.2699 - acc: 0.1048108/174 [=================>............] - ETA: 3:17 - loss: 526167.8350 - acc: 0.1046109/174 [=================>............] - ETA: 3:14 - loss: 521340.6283 - acc: 0.1050110/174 [=================>............] - ETA: 3:11 - loss: 516601.1890 - acc: 0.1053111/174 [==================>...........] - ETA: 3:08 - loss: 511947.1450 - acc: 0.1051112/174 [==================>...........] - ETA: 3:05 - loss: 507376.2089 - acc: 0.1051113/174 [==================>...........] - ETA: 3:01 - loss: 502886.1743 - acc: 0.1049114/174 [==================>...........] - ETA: 2:58 - loss: 498474.9123 - acc: 0.1049115/174 [==================>...........] - ETA: 2:55 - loss: 494140.3678 - acc: 0.1049116/174 [===================>..........] - ETA: 2:52 - loss: 489880.5569 - acc: 0.1048117/174 [===================>..........] - ETA: 2:49 - loss: 485693.5633 - acc: 0.1047118/174 [===================>..........] - ETA: 2:46 - loss: 481577.5357 - acc: 0.1046119/174 [===================>..........] - ETA: 2:42 - loss: 477530.6850 - acc: 0.1044120/174 [===================>..........] - ETA: 2:39 - loss: 473551.2817 - acc: 0.1042121/174 [===================>..........] - ETA: 2:36 - loss: 469637.6569 - acc: 0.1040122/174 [====================>.........] - ETA: 2:33 - loss: 465788.1868 - acc: 0.1040123/174 [====================>.........] - ETA: 2:30 - loss: 462001.3097 - acc: 0.1044124/174 [====================>.........] - ETA: 2:27 - loss: 458275.5111 - acc: 0.1049125/174 [====================>.........] - ETA: 2:24 - loss: 454609.3254 - acc: 0.1048126/174 [====================>.........] - ETA: 2:21 - loss: 451001.3331 - acc: 0.1050127/174 [====================>.........] - ETA: 2:18 - loss: 447450.1597 - acc: 0.1048128/174 [=====================>........] - ETA: 2:15 - loss: 443954.4733 - acc: 0.1046129/174 [=====================>........] - ETA: 2:12 - loss: 440512.9836 - acc: 0.1047130/174 [=====================>........] - ETA: 2:09 - loss: 437124.4435 - acc: 0.1046131/174 [=====================>........] - ETA: 2:06 - loss: 433787.6333 - acc: 0.1047132/174 [=====================>........] - ETA: 2:03 - loss: 430501.3808 - acc: 0.1046133/174 [=====================>........] - ETA: 2:00 - loss: 427264.5456 - acc: 0.1051134/174 [======================>.......] - ETA: 1:57 - loss: 424076.0505 - acc: 0.1049135/174 [======================>.......] - ETA: 1:54 - loss: 420934.7634 - acc: 0.1050136/174 [======================>.......] - ETA: 1:51 - loss: 417839.6718 - acc: 0.1052137/174 [======================>.......] - ETA: 1:48 - loss: 414789.7642 - acc: 0.1049138/174 [======================>.......] - ETA: 1:45 - loss: 411784.0579 - acc: 0.1050139/174 [======================>.......] - ETA: 1:42 - loss: 408821.5995 - acc: 0.1051140/174 [=======================>......] - ETA: 1:39 - loss: 405901.4617 - acc: 0.1050141/174 [=======================>......] - ETA: 1:36 - loss: 403022.7443 - acc: 0.1048142/174 [=======================>......] - ETA: 1:33 - loss: 400184.5721 - acc: 0.1047143/174 [=======================>......] - ETA: 1:30 - loss: 397386.0947 - acc: 0.1047144/174 [=======================>......] - ETA: 1:27 - loss: 394626.4850 - acc: 0.1047145/174 [========================>.....] - ETA: 1:24 - loss: 391904.9416 - acc: 0.1048146/174 [========================>.....] - ETA: 1:21 - loss: 389220.6770 - acc: 0.1049147/174 [========================>.....] - ETA: 1:19 - loss: 386572.9330 - acc: 0.1049148/174 [========================>.....] - ETA: 1:16 - loss: 383960.9693 - acc: 0.1047149/174 [========================>.....] - ETA: 1:13 - loss: 381384.0724 - acc: 0.1048150/174 [========================>.....] - ETA: 1:10 - loss: 378841.5272 - acc: 0.1048151/174 [=========================>....] - ETA: 1:07 - loss: 376332.6582 - acc: 0.1049152/174 [=========================>....] - ETA: 1:04 - loss: 373856.8006 - acc: 0.1048153/174 [=========================>....] - ETA: 1:01 - loss: 371413.3076 - acc: 0.1049154/174 [=========================>....] - ETA: 58s - loss: 369001.5479 - acc: 0.1048 155/174 [=========================>....] - ETA: 55s - loss: 366620.9075 - acc: 0.1054156/174 [=========================>....] - ETA: 52s - loss: 364270.7883 - acc: 0.1054157/174 [==========================>...] - ETA: 49s - loss: 361950.6075 - acc: 0.1054158/174 [==========================>...] - ETA: 46s - loss: 359659.7954 - acc: 0.1055159/174 [==========================>...] - ETA: 43s - loss: 357397.8009 - acc: 0.1054160/174 [==========================>...] - ETA: 40s - loss: 355164.0791 - acc: 0.1053161/174 [==========================>...] - ETA: 37s - loss: 352958.1053 - acc: 0.1054162/174 [==========================>...] - ETA: 34s - loss: 350779.3668 - acc: 0.1055163/174 [===========================>..] - ETA: 31s - loss: 348627.3602 - acc: 0.1054164/174 [===========================>..] - ETA: 29s - loss: 346501.5977 - acc: 0.1056165/174 [===========================>..] - ETA: 26s - loss: 344401.6020 - acc: 0.1055166/174 [===========================>..] - ETA: 23s - loss: 342326.9074 - acc: 0.1053167/174 [===========================>..] - ETA: 20s - loss: 340277.0595 - acc: 0.1052168/174 [===========================>..] - ETA: 17s - loss: 338251.6145 - acc: 0.1053169/174 [============================>.] - ETA: 14s - loss: 336250.1392 - acc: 0.1052170/174 [============================>.] - ETA: 11s - loss: 334272.2107 - acc: 0.1052171/174 [============================>.] - ETA: 8s - loss: 332317.4159 - acc: 0.1055 172/174 [============================>.] - ETA: 5s - loss: 330385.3527 - acc: 0.1056173/174 [============================>.] - ETA: 2s - loss: 328475.6241 - acc: 0.1055  1/174 [..............................] - ETA: 3:08 - loss: 2.2784 - acc: 0.1348  2/174 [..............................] - ETA: 2:28 - loss: 2.2846 - acc: 0.1109  3/174 [..............................] - ETA: 2:14 - loss: 2.2890 - acc: 0.1029  4/174 [..............................] - ETA: 2:07 - loss: 2.2927 - acc: 0.1065  5/174 [..............................] - ETA: 2:03 - loss: 2.2956 - acc: 0.1070  6/174 [>.............................] - ETA: 2:01 - loss: 2.2974 - acc: 0.1116  7/174 [>.............................] - ETA: 2:01 - loss: 2.3027 - acc: 0.1087  8/174 [>.............................] - ETA: 2:02 - loss: 2.3014 - acc: 0.1087  9/174 [>.............................] - ETA: 2:02 - loss: 2.3001 - acc: 0.1106 10/174 [>.............................] - ETA: 2:02 - loss: 2.2995 - acc: 0.1087 11/174 [>.............................] - ETA: 2:01 - loss: 2.2986 - acc: 0.1091 12/174 [=>............................] - ETA: 1:59 - loss: 2.2985 - acc: 0.1083 13/174 [=>............................] - ETA: 1:58 - loss: 2.2987 - acc: 0.1064 14/174 [=>............................] - ETA: 1:56 - loss: 2.2991 - acc: 0.1065 15/174 [=>............................] - ETA: 1:54 - loss: 2.2992 - acc: 0.1058 16/174 [=>............................] - ETA: 1:53 - loss: 2.3005 - acc: 0.1035 17/174 [=>............................] - ETA: 1:53 - loss: 2.3003 - acc: 0.1036 18/174 [==>...........................] - ETA: 1:53 - loss: 2.3005 - acc: 0.1041 19/174 [==>...........................] - ETA: 1:52 - loss: 2.3007 - acc: 0.1043 20/174 [==>...........................] - ETA: 1:51 - loss: 2.3006 - acc: 0.1046 21/174 [==>...........................] - ETA: 1:50 - loss: 2.3015 - acc: 0.1031 22/174 [==>...........................] - ETA: 1:49 - loss: 2.3022 - acc: 0.1014 23/174 [==>...........................] - ETA: 1:48 - loss: 2.3022 - acc: 0.1004 24/174 [===>..........................] - ETA: 1:48 - loss: 2.3030 - acc: 0.0991 25/174 [===>..........................] - ETA: 1:47 - loss: 2.3028 - acc: 0.0986 26/174 [===>..........................] - ETA: 1:46 - loss: 2.3028 - acc: 0.0978 27/174 [===>..........................] - ETA: 1:46 - loss: 2.3026 - acc: 0.0976 28/174 [===>..........................] - ETA: 1:45 - loss: 2.3019 - acc: 0.0984 29/174 [====>.........................] - ETA: 1:44 - loss: 2.3022 - acc: 0.0985 30/174 [====>.........................] - ETA: 1:43 - loss: 2.3019 - acc: 0.0991 31/174 [====>.........................] - ETA: 1:42 - loss: 2.3020 - acc: 0.0992 32/174 [====>.........................] - ETA: 1:41 - loss: 2.3027 - acc: 0.0989 33/174 [====>.........................] - ETA: 1:41 - loss: 2.3025 - acc: 0.0993 34/174 [====>.........................] - ETA: 1:40 - loss: 2.3019 - acc: 0.0994 35/174 [=====>........................] - ETA: 1:39 - loss: 2.3024 - acc: 0.0988 36/174 [=====>........................] - ETA: 1:38 - loss: 2.3020 - acc: 0.1002 37/174 [=====>........................] - ETA: 1:36 - loss: 2.3022 - acc: 0.1006 38/174 [=====>........................] - ETA: 1:36 - loss: 2.3026 - acc: 0.1013 39/174 [=====>........................] - ETA: 1:35 - loss: 2.3025 - acc: 0.1014 40/174 [=====>........................] - ETA: 1:34 - loss: 2.3021 - acc: 0.1015 41/174 [======>.......................] - ETA: 1:33 - loss: 2.3017 - acc: 0.1018 42/174 [======>.......................] - ETA: 1:33 - loss: 2.3018 - acc: 0.1014 43/174 [======>.......................] - ETA: 1:32 - loss: 2.3017 - acc: 0.1015 44/174 [======>.......................] - ETA: 1:43 - loss: 2.3016 - acc: 0.1018174/174 [==============================] - 538s 3s/step - loss: 326588.7795 - acc: 0.1056 - val_loss: 2.3016 - val_acc: 0.1018
