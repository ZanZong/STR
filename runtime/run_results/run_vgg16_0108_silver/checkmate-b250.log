WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1630: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/stropt/lms.py:970: The name tf.train.SessionRunHook is deprecated. Please use tf.estimator.SessionRunHook instead.

WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/stropt/str_strategy.py:122: get_backward_walk_ops (from tensorflow.contrib.graph_editor.select) is deprecated and will be removed after 2019-06-06.
Instructions for updating:
Please use tensorflow.python.ops.op_selector.get_backward_walk_ops.
1 Physical GPUs, 1 Logical GPUs
Parsing arguments: [('batch_size', 250), ('epochs', 1), ('model_name', 'VGG16'), ('strategy', 'checkmate'), ('verbose', False)]
Shape of x_train: (40000, 224, 224, 3), shape of x_test: (10000, 224, 224, 3)
[STR DEBUG] Parsing STR configuration: [{'strategy': 'recompute', 'verbose': 'false', 'tags': '/home/zongzan/dist_dnn_training/STR/optimizer/logs/VGG16_250/layer_names'}, {'r': '/home/zongzan/dist_dnn_training/STR/optimizer/logs/VGG16_250/R-checkmate'}]
  1/160 [..............................] - ETA: 1:17:16 - loss: 2.3272 - acc: 0.0640  2/160 [..............................] - ETA: 41:38 - loss: 25100157.1636 - acc: 0.0740  3/160 [..............................] - ETA: 29:45 - loss: 16733454.0113 - acc: 0.0787  4/160 [..............................] - ETA: 23:51 - loss: 12550883.1806 - acc: 0.0830  5/160 [..............................] - ETA: 20:19 - loss: 10040709.2968 - acc: 0.0792  6/160 [>.............................] - ETA: 18:11 - loss: 8367267.0129 - acc: 0.0827   7/160 [>.............................] - ETA: 16:32 - loss: 7171943.9181 - acc: 0.0840  8/160 [>.............................] - ETA: 15:19 - loss: 6275451.3880 - acc: 0.0860  9/160 [>.............................] - ETA: 14:22 - loss: 5578183.8319 - acc: 0.0844 10/160 [>.............................] - ETA: 13:40 - loss: 5020365.7239 - acc: 0.0892 11/160 [=>............................] - ETA: 13:06 - loss: 4563969.0569 - acc: 0.0916 12/160 [=>............................] - ETA: 12:37 - loss: 4183638.5050 - acc: 0.0907 13/160 [=>............................] - ETA: 12:10 - loss: 3861820.3384 - acc: 0.0908 14/160 [=>............................] - ETA: 11:49 - loss: 3585976.2626 - acc: 0.0894 15/160 [=>............................] - ETA: 11:34 - loss: 3346911.3320 - acc: 0.0885 16/160 [==>...........................] - ETA: 11:19 - loss: 3137729.5179 - acc: 0.0897 17/160 [==>...........................] - ETA: 11:07 - loss: 2953157.3288 - acc: 0.0899 18/160 [==>...........................] - ETA: 10:55 - loss: 2789093.1607 - acc: 0.0900 19/160 [==>...........................] - ETA: 10:44 - loss: 2642298.9050 - acc: 0.0909 20/160 [==>...........................] - ETA: 10:34 - loss: 2510184.0749 - acc: 0.0916 21/160 [==>...........................] - ETA: 10:25 - loss: 2390651.6096 - acc: 0.0907 22/160 [===>..........................] - ETA: 10:16 - loss: 2281985.7321 - acc: 0.0904 23/160 [===>..........................] - ETA: 10:07 - loss: 2182769.0613 - acc: 0.0899 24/160 [===>..........................] - ETA: 9:59 - loss: 2091820.4464 - acc: 0.0915  25/160 [===>..........................] - ETA: 9:51 - loss: 2008147.7207 - acc: 0.0915 26/160 [===>..........................] - ETA: 9:44 - loss: 1930911.3585 - acc: 0.0935 27/160 [====>.........................] - ETA: 9:37 - loss: 1859396.2082 - acc: 0.0942 28/160 [====>.........................] - ETA: 9:30 - loss: 1792989.2830 - acc: 0.0947 29/160 [====>.........................] - ETA: 9:22 - loss: 1731162.1459 - acc: 0.0935 30/160 [====>.........................] - ETA: 9:16 - loss: 1673456.8178 - acc: 0.0931 31/160 [====>.........................] - ETA: 9:10 - loss: 1619474.4140 - acc: 0.0935 32/160 [=====>........................] - ETA: 9:03 - loss: 1568865.9108 - acc: 0.0946 33/160 [=====>........................] - ETA: 8:57 - loss: 1521324.5893 - acc: 0.0956 34/160 [=====>........................] - ETA: 8:55 - loss: 1476579.8162 - acc: 0.0955 35/160 [=====>........................] - ETA: 8:48 - loss: 1434391.8872 - acc: 0.0954 36/160 [=====>........................] - ETA: 8:42 - loss: 1394547.7320 - acc: 0.0952 37/160 [=====>........................] - ETA: 8:35 - loss: 1356857.3149 - acc: 0.0969 38/160 [======>.......................] - ETA: 8:30 - loss: 1321150.6040 - acc: 0.0967 39/160 [======>.......................] - ETA: 8:23 - loss: 1287275.0066 - acc: 0.0973 40/160 [======>.......................] - ETA: 8:18 - loss: 1255093.1889 - acc: 0.0975 41/160 [======>.......................] - ETA: 8:15 - loss: 1224481.2159 - acc: 0.0986 42/160 [======>.......................] - ETA: 8:10 - loss: 1195326.9558 - acc: 0.1004 43/160 [=======>......................] - ETA: 8:06 - loss: 1167528.7078 - acc: 0.1011 44/160 [=======>......................] - ETA: 8:01 - loss: 1140994.0162 - acc: 0.1027 45/160 [=======>......................] - ETA: 7:55 - loss: 1115638.6447 - acc: 0.1027 46/160 [=======>......................] - ETA: 7:49 - loss: 1091385.6806 - acc: 0.1024 47/160 [=======>......................] - ETA: 7:44 - loss: 1068164.7576 - acc: 0.1020 48/160 [========>.....................] - ETA: 7:39 - loss: 1045911.3730 - acc: 0.1023 49/160 [========>.....................] - ETA: 7:33 - loss: 1024566.2901 - acc: 0.1021 50/160 [========>.....................] - ETA: 7:28 - loss: 1004075.0099 - acc: 0.1031 51/160 [========>.....................] - ETA: 7:23 - loss: 984387.3090 - acc: 0.1040  52/160 [========>.....................] - ETA: 7:18 - loss: 965456.8303 - acc: 0.1038 53/160 [========>.....................] - ETA: 7:13 - loss: 947240.7072 - acc: 0.1029 54/160 [=========>....................] - ETA: 7:08 - loss: 929699.2552 - acc: 0.1027 55/160 [=========>....................] - ETA: 7:03 - loss: 912795.6742 - acc: 0.1024 56/160 [=========>....................] - ETA: 6:58 - loss: 896495.7923 - acc: 0.1029 57/160 [=========>....................] - ETA: 6:54 - loss: 880767.8385 - acc: 0.1031 58/160 [=========>....................] - ETA: 6:52 - loss: 865582.2258 - acc: 0.1033 59/160 [==========>...................] - ETA: 6:47 - loss: 850911.3796 - acc: 0.1031 60/160 [==========>...................] - ETA: 6:41 - loss: 836729.5616 - acc: 0.1039 61/160 [==========>...................] - ETA: 6:37 - loss: 823012.7210 - acc: 0.1041 62/160 [==========>...................] - ETA: 6:32 - loss: 809738.3632 - acc: 0.1042 63/160 [==========>...................] - ETA: 6:27 - loss: 796885.4099 - acc: 0.1041 64/160 [===========>..................] - ETA: 6:22 - loss: 784434.1113 - acc: 0.1042 65/160 [===========>..................] - ETA: 6:17 - loss: 772365.9297 - acc: 0.1042 66/160 [===========>..................] - ETA: 6:12 - loss: 760663.4504 - acc: 0.1042 67/160 [===========>..................] - ETA: 6:08 - loss: 749310.2990 - acc: 0.1040 68/160 [===========>..................] - ETA: 6:04 - loss: 738291.0638 - acc: 0.1034 69/160 [===========>..................] - ETA: 6:00 - loss: 727591.2267 - acc: 0.1032 70/160 [============>.................] - ETA: 5:56 - loss: 717197.0991 - acc: 0.1034 71/160 [============>.................] - ETA: 5:52 - loss: 707095.7639 - acc: 0.1037 72/160 [============>.................] - ETA: 5:48 - loss: 697275.0210 - acc: 0.1041 73/160 [============>.................] - ETA: 5:44 - loss: 687723.3451 - acc: 0.1043 74/160 [============>.................] - ETA: 5:39 - loss: 678429.8174 - acc: 0.1047 75/160 [=============>................] - ETA: 5:35 - loss: 669384.1173 - acc: 0.1047 76/160 [=============>................] - ETA: 5:31 - loss: 660576.4618 - acc: 0.1046 77/160 [=============>................] - ETA: 5:27 - loss: 651997.5766 - acc: 0.1044 78/160 [=============>................] - ETA: 5:23 - loss: 643638.6628 - acc: 0.1040 79/160 [=============>................] - ETA: 5:19 - loss: 635491.3671 - acc: 0.1046 80/160 [==============>...............] - ETA: 5:15 - loss: 627547.7537 - acc: 0.1049 81/160 [==============>...............] - ETA: 5:11 - loss: 619800.2792 - acc: 0.1054 82/160 [==============>...............] - ETA: 5:07 - loss: 612241.7672 - acc: 0.1051 83/160 [==============>...............] - ETA: 5:03 - loss: 604865.3880 - acc: 0.1050 84/160 [==============>...............] - ETA: 4:59 - loss: 597664.6375 - acc: 0.1054 85/160 [==============>...............] - ETA: 4:55 - loss: 590633.3159 - acc: 0.1050 86/160 [===============>..............] - ETA: 4:51 - loss: 583765.5133 - acc: 0.1049 87/160 [===============>..............] - ETA: 4:47 - loss: 577055.5913 - acc: 0.1046 88/160 [===============>..............] - ETA: 4:43 - loss: 570498.1686 - acc: 0.1045 89/160 [===============>..............] - ETA: 4:39 - loss: 564088.1027 - acc: 0.1044 90/160 [===============>..............] - ETA: 4:35 - loss: 557820.4834 - acc: 0.1041 91/160 [================>.............] - ETA: 4:31 - loss: 551690.6132 - acc: 0.1045 92/160 [================>.............] - ETA: 4:27 - loss: 545694.0011 - acc: 0.1045 93/160 [================>.............] - ETA: 4:23 - loss: 539826.3483 - acc: 0.1046 94/160 [================>.............] - ETA: 4:19 - loss: 534083.5390 - acc: 0.1043 95/160 [================>.............] - ETA: 4:15 - loss: 528461.6971 - acc: 0.1045 96/160 [=================>............] - ETA: 4:11 - loss: 522956.9651 - acc: 0.1044 97/160 [=================>............] - ETA: 4:07 - loss: 517565.6800 - acc: 0.1041 98/160 [=================>............] - ETA: 4:03 - loss: 512284.4210 - acc: 0.1042 99/160 [=================>............] - ETA: 3:59 - loss: 507109.8541 - acc: 0.1044100/160 [=================>............] - ETA: 3:55 - loss: 502038.7786 - acc: 0.1044101/160 [=================>............] - ETA: 3:51 - loss: 497068.1203 - acc: 0.1044102/160 [==================>...........] - ETA: 3:47 - loss: 492194.9257 - acc: 0.1049103/160 [==================>...........] - ETA: 3:43 - loss: 487416.3729 - acc: 0.1050104/160 [==================>...........] - ETA: 3:39 - loss: 482729.7002 - acc: 0.1050105/160 [==================>...........] - ETA: 3:35 - loss: 478132.2967 - acc: 0.1048106/160 [==================>...........] - ETA: 3:31 - loss: 473621.6363 - acc: 0.1048107/160 [===================>..........] - ETA: 3:27 - loss: 469195.2874 - acc: 0.1052108/160 [===================>..........] - ETA: 3:23 - loss: 464850.9078 - acc: 0.1056109/160 [===================>..........] - ETA: 3:19 - loss: 460586.2446 - acc: 0.1055110/160 [===================>..........] - ETA: 3:15 - loss: 456399.1178 - acc: 0.1055111/160 [===================>..........] - ETA: 3:11 - loss: 452287.4348 - acc: 0.1054112/160 [====================>.........] - ETA: 3:07 - loss: 448249.1747 - acc: 0.1058113/160 [====================>.........] - ETA: 3:03 - loss: 444282.3882 - acc: 0.1061114/160 [====================>.........] - ETA: 2:59 - loss: 440385.1945 - acc: 0.1060115/160 [====================>.........] - ETA: 2:55 - loss: 436555.7782 - acc: 0.1057116/160 [====================>.........] - ETA: 2:51 - loss: 432792.3862 - acc: 0.1054117/160 [====================>.........] - ETA: 2:47 - loss: 429093.3256 - acc: 0.1053118/160 [=====================>........] - ETA: 2:43 - loss: 425456.9608 - acc: 0.1052119/160 [=====================>........] - ETA: 2:40 - loss: 421881.7838 - acc: 0.1052120/160 [=====================>........] - ETA: 2:36 - loss: 418366.1214 - acc: 0.1053121/160 [=====================>........] - ETA: 2:32 - loss: 414908.5690 - acc: 0.1055122/160 [=====================>........] - ETA: 2:28 - loss: 411507.6979 - acc: 0.1055123/160 [======================>.......] - ETA: 2:24 - loss: 408162.1282 - acc: 0.1058124/160 [======================>.......] - ETA: 2:20 - loss: 404870.5167 - acc: 0.1058125/160 [======================>.......] - ETA: 2:16 - loss: 401631.5708 - acc: 0.1057126/160 [======================>.......] - ETA: 2:12 - loss: 398444.0445 - acc: 0.1059127/160 [======================>.......] - ETA: 2:08 - loss: 395306.7080 - acc: 0.1060128/160 [=======================>......] - ETA: 2:04 - loss: 392218.3923 - acc: 0.1059129/160 [=======================>......] - ETA: 2:00 - loss: 389177.9574 - acc: 0.1064130/160 [=======================>......] - ETA: 1:56 - loss: 386184.2985 - acc: 0.1063131/160 [=======================>......] - ETA: 1:52 - loss: 383236.3444 - acc: 0.1062132/160 [=======================>......] - ETA: 1:49 - loss: 380333.0562 - acc: 0.1061133/160 [=======================>......] - ETA: 1:45 - loss: 377473.4264 - acc: 0.1062134/160 [========================>.....] - ETA: 1:41 - loss: 374656.4777 - acc: 0.1062135/160 [========================>.....] - ETA: 1:37 - loss: 371881.2615 - acc: 0.1063136/160 [========================>.....] - ETA: 1:33 - loss: 369146.8573 - acc: 0.1066137/160 [========================>.....] - ETA: 1:29 - loss: 366452.3710 - acc: 0.1069138/160 [========================>.....] - ETA: 1:25 - loss: 363796.9360 - acc: 0.1067139/160 [=========================>....] - ETA: 1:21 - loss: 361179.7084 - acc: 0.1067140/160 [=========================>....] - ETA: 1:17 - loss: 358599.8698 - acc: 0.1069141/160 [=========================>....] - ETA: 1:13 - loss: 356056.6246 - acc: 0.1069142/160 [=========================>....] - ETA: 1:10 - loss: 353549.1998 - acc: 0.1070143/160 [=========================>....] - ETA: 1:06 - loss: 351076.8439 - acc: 0.1070144/160 [==========================>...] - ETA: 1:02 - loss: 348638.8262 - acc: 0.1072145/160 [==========================>...] - ETA: 58s - loss: 346234.4367 - acc: 0.1074 146/160 [==========================>...] - ETA: 54s - loss: 343862.9838 - acc: 0.1074147/160 [==========================>...] - ETA: 50s - loss: 341523.7954 - acc: 0.1074148/160 [==========================>...] - ETA: 46s - loss: 339216.2178 - acc: 0.1073149/160 [==========================>...] - ETA: 42s - loss: 336939.6145 - acc: 0.1072150/160 [===========================>..] - ETA: 38s - loss: 334693.3657 - acc: 0.1074151/160 [===========================>..] - ETA: 34s - loss: 332476.8686 - acc: 0.1073152/160 [===========================>..] - ETA: 31s - loss: 330289.5358 - acc: 0.1076153/160 [===========================>..] - ETA: 27s - loss: 328130.7958 - acc: 0.1077154/160 [===========================>..] - ETA: 23s - loss: 326000.0913 - acc: 0.1076155/160 [============================>.] - ETA: 19s - loss: 323896.8797 - acc: 0.1077156/160 [============================>.] - ETA: 15s - loss: 321820.6322 - acc: 0.1076157/160 [============================>.] - ETA: 11s - loss: 319770.8334 - acc: 0.1079158/160 [============================>.] - ETA: 7s - loss: 317746.9969 - acc: 0.1080 159/160 [============================>.] - ETA: 3s - loss: 315748.6399 - acc: 0.1083  1/160 [..............................] - ETA: 3:25 - loss: 2.3018 - acc: 0.0840  2/160 [..............................] - ETA: 2:56 - loss: 2.3020 - acc: 0.0940  3/160 [..............................] - ETA: 2:46 - loss: 2.3001 - acc: 0.1067  4/160 [..............................] - ETA: 2:40 - loss: 2.3000 - acc: 0.1140  5/160 [..............................] - ETA: 2:36 - loss: 2.3010 - acc: 0.1112  6/160 [>.............................] - ETA: 2:33 - loss: 2.3005 - acc: 0.1153  7/160 [>.............................] - ETA: 2:31 - loss: 2.2999 - acc: 0.1206  8/160 [>.............................] - ETA: 2:29 - loss: 2.2999 - acc: 0.1235  9/160 [>.............................] - ETA: 2:28 - loss: 2.2997 - acc: 0.1222 10/160 [>.............................] - ETA: 2:26 - loss: 2.2998 - acc: 0.1200 11/160 [=>............................] - ETA: 2:25 - loss: 2.2995 - acc: 0.1236 12/160 [=>............................] - ETA: 2:24 - loss: 2.2992 - acc: 0.1237 13/160 [=>............................] - ETA: 2:22 - loss: 2.2994 - acc: 0.1243 14/160 [=>............................] - ETA: 2:21 - loss: 2.2992 - acc: 0.1271 15/160 [=>............................] - ETA: 2:20 - loss: 2.2990 - acc: 0.1277 16/160 [==>...........................] - ETA: 2:19 - loss: 2.2987 - acc: 0.1285 17/160 [==>...........................] - ETA: 2:18 - loss: 2.2986 - acc: 0.1315 18/160 [==>...........................] - ETA: 2:17 - loss: 2.2990 - acc: 0.1316 19/160 [==>...........................] - ETA: 2:16 - loss: 2.2986 - acc: 0.1341 20/160 [==>...........................] - ETA: 2:16 - loss: 2.2986 - acc: 0.1320 21/160 [==>...........................] - ETA: 2:15 - loss: 2.2986 - acc: 0.1326 22/160 [===>..........................] - ETA: 2:14 - loss: 2.2986 - acc: 0.1331 23/160 [===>..........................] - ETA: 2:13 - loss: 2.2984 - acc: 0.1337 24/160 [===>..........................] - ETA: 2:13 - loss: 2.2982 - acc: 0.1345 25/160 [===>..........................] - ETA: 2:12 - loss: 2.2982 - acc: 0.1342 26/160 [===>..........................] - ETA: 2:11 - loss: 2.2984 - acc: 0.1346 27/160 [====>.........................] - ETA: 2:10 - loss: 2.2983 - acc: 0.1338 28/160 [====>.........................] - ETA: 2:10 - loss: 2.2983 - acc: 0.1331 29/160 [====>.........................] - ETA: 2:09 - loss: 2.2983 - acc: 0.1341 30/160 [====>.........................] - ETA: 2:08 - loss: 2.2981 - acc: 0.1339 31/160 [====>.........................] - ETA: 2:07 - loss: 2.2982 - acc: 0.1323 32/160 [=====>........................] - ETA: 2:06 - loss: 2.2982 - acc: 0.1312 33/160 [=====>........................] - ETA: 2:05 - loss: 2.2983 - acc: 0.1308 34/160 [=====>........................] - ETA: 2:05 - loss: 2.2983 - acc: 0.1299 35/160 [=====>........................] - ETA: 2:04 - loss: 2.2982 - acc: 0.1296 36/160 [=====>........................] - ETA: 2:03 - loss: 2.2984 - acc: 0.1286 37/160 [=====>........................] - ETA: 2:02 - loss: 2.2985 - acc: 0.1285 38/160 [======>.......................] - ETA: 2:01 - loss: 2.2985 - acc: 0.1282 39/160 [======>.......................] - ETA: 1:59 - loss: 2.2985 - acc: 0.1286 40/160 [======>.......................] - ETA: 1:58 - loss: 2.2986 - acc: 0.1286160/160 [==============================] - 660s 4s/step - loss: 313775.2253 - acc: 0.1081 - val_loss: 2.2986 - val_acc: 0.1286
