WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1630: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/stropt/lms.py:970: The name tf.train.SessionRunHook is deprecated. Please use tf.estimator.SessionRunHook instead.

WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/stropt/str_strategy.py:122: get_backward_walk_ops (from tensorflow.contrib.graph_editor.select) is deprecated and will be removed after 2019-06-06.
Instructions for updating:
Please use tensorflow.python.ops.op_selector.get_backward_walk_ops.
1 Physical GPUs, 1 Logical GPUs
Parsing arguments: [('batch_size', 220), ('epochs', 1), ('model_name', 'VGG16'), ('strategy', 'checkmate'), ('verbose', False)]
Cannot find config for batch_size=220, use 250 instead
Shape of x_train: (40000, 224, 224, 3), shape of x_test: (10000, 224, 224, 3)
[STR DEBUG] Parsing STR configuration: [{'strategy': 'recompute', 'verbose': 'false', 'tags': '/home/zongzan/dist_dnn_training/STR/optimizer/logs/VGG16_250/layer_names'}, {'r': '/home/zongzan/dist_dnn_training/STR/optimizer/logs/VGG16_250/R-checkmate'}]
  1/182 [..............................] - ETA: 1:21:32 - loss: 2.3182 - acc: 0.1409  2/182 [..............................] - ETA: 43:27 - loss: 5361658.6591 - acc: 0.1091  3/182 [..............................] - ETA: 30:45 - loss: 3574478.0150 - acc: 0.1000  4/182 [..............................] - ETA: 24:26 - loss: 2681015.6262 - acc: 0.0909  5/182 [..............................] - ETA: 20:43 - loss: 2144844.4484 - acc: 0.0955  6/182 [..............................] - ETA: 18:16 - loss: 1787393.4258 - acc: 0.1008  7/182 [>.............................] - ETA: 16:32 - loss: 1532052.9160 - acc: 0.0994  8/182 [>.............................] - ETA: 15:13 - loss: 1340548.4139 - acc: 0.0994  9/182 [>.............................] - ETA: 14:14 - loss: 1191598.8462 - acc: 0.0995 10/182 [>.............................] - ETA: 13:26 - loss: 1072439.2174 - acc: 0.1005 11/182 [>.............................] - ETA: 12:45 - loss: 974944.9596 - acc: 0.1033  12/182 [>.............................] - ETA: 12:12 - loss: 893699.7384 - acc: 0.1045 13/182 [=>............................] - ETA: 11:44 - loss: 824953.7812 - acc: 0.1035 14/182 [=>............................] - ETA: 11:23 - loss: 766028.7026 - acc: 0.1029 15/182 [=>............................] - ETA: 11:03 - loss: 714960.2782 - acc: 0.1018 16/182 [=>............................] - ETA: 10:48 - loss: 670275.4107 - acc: 0.1023 17/182 [=>............................] - ETA: 10:37 - loss: 630847.5812 - acc: 0.1024 18/182 [=>............................] - ETA: 10:26 - loss: 595800.6212 - acc: 0.1058 19/182 [==>...........................] - ETA: 10:15 - loss: 564442.8149 - acc: 0.1060 20/182 [==>...........................] - ETA: 10:05 - loss: 536220.7893 - acc: 0.1041 21/182 [==>...........................] - ETA: 9:56 - loss: 510686.5799 - acc: 0.1032  22/182 [==>...........................] - ETA: 9:47 - loss: 487473.6581 - acc: 0.1039 23/182 [==>...........................] - ETA: 9:39 - loss: 466279.2511 - acc: 0.1042 24/182 [==>...........................] - ETA: 9:32 - loss: 446851.0452 - acc: 0.1034 25/182 [===>..........................] - ETA: 9:25 - loss: 428977.0955 - acc: 0.1035 26/182 [===>..........................] - ETA: 9:18 - loss: 412478.0647 - acc: 0.1054 27/182 [===>..........................] - ETA: 9:11 - loss: 397201.1843 - acc: 0.1064 28/182 [===>..........................] - ETA: 9:05 - loss: 383015.5103 - acc: 0.1063 29/182 [===>..........................] - ETA: 8:59 - loss: 369808.1583 - acc: 0.1075 30/182 [===>..........................] - ETA: 8:53 - loss: 357481.2963 - acc: 0.1088 31/182 [====>.........................] - ETA: 8:47 - loss: 345949.7166 - acc: 0.1088 32/182 [====>.........................] - ETA: 8:42 - loss: 335138.8598 - acc: 0.1084 33/182 [====>.........................] - ETA: 8:37 - loss: 324983.2068 - acc: 0.1063 34/182 [====>.........................] - ETA: 8:31 - loss: 315424.9450 - acc: 0.1053 35/182 [====>.........................] - ETA: 8:26 - loss: 306412.8695 - acc: 0.1049 36/182 [====>.........................] - ETA: 8:20 - loss: 297901.4648 - acc: 0.1048 37/182 [=====>........................] - ETA: 8:15 - loss: 289850.1361 - acc: 0.1041 38/182 [=====>........................] - ETA: 8:10 - loss: 282222.5614 - acc: 0.1036 39/182 [=====>........................] - ETA: 8:06 - loss: 274986.1444 - acc: 0.1049 40/182 [=====>........................] - ETA: 8:01 - loss: 268111.5478 - acc: 0.1056 41/182 [=====>........................] - ETA: 7:57 - loss: 261572.2979 - acc: 0.1061 42/182 [=====>........................] - ETA: 7:52 - loss: 255344.4409 - acc: 0.1054 43/182 [======>.......................] - ETA: 7:48 - loss: 249406.2518 - acc: 0.1051 44/182 [======>.......................] - ETA: 7:44 - loss: 243737.9802 - acc: 0.1053 45/182 [======>.......................] - ETA: 7:40 - loss: 238321.6318 - acc: 0.1048 46/182 [======>.......................] - ETA: 7:35 - loss: 233140.7769 - acc: 0.1047 47/182 [======>.......................] - ETA: 7:31 - loss: 228180.3838 - acc: 0.1047 48/182 [======>.......................] - ETA: 7:27 - loss: 223426.6737 - acc: 0.1052 49/182 [=======>......................] - ETA: 7:27 - loss: 218866.9926 - acc: 0.1050 50/182 [=======>......................] - ETA: 7:22 - loss: 214489.6987 - acc: 0.1057 51/182 [=======>......................] - ETA: 7:18 - loss: 210284.0634 - acc: 0.1049 52/182 [=======>......................] - ETA: 7:13 - loss: 206240.1836 - acc: 0.1045 53/182 [=======>......................] - ETA: 7:09 - loss: 202348.9028 - acc: 0.1048 54/182 [=======>......................] - ETA: 7:05 - loss: 198601.7432 - acc: 0.1045 55/182 [========>.....................] - ETA: 7:00 - loss: 194990.8442 - acc: 0.1042 56/182 [========>.....................] - ETA: 6:56 - loss: 191508.9051 - acc: 0.1049 57/182 [========>.....................] - ETA: 6:52 - loss: 188149.1404 - acc: 0.1043 58/182 [========>.....................] - ETA: 6:48 - loss: 184905.2425 - acc: 0.1040 59/182 [========>.....................] - ETA: 6:44 - loss: 181771.2952 - acc: 0.1040 60/182 [========>.....................] - ETA: 6:41 - loss: 178741.8122 - acc: 0.1039 61/182 [=========>....................] - ETA: 6:37 - loss: 175811.6563 - acc: 0.1039 62/182 [=========>....................] - ETA: 6:33 - loss: 172976.0216 - acc: 0.1034 63/182 [=========>....................] - ETA: 6:30 - loss: 170230.4070 - acc: 0.1040 64/182 [=========>....................] - ETA: 6:26 - loss: 167570.5928 - acc: 0.1039 65/182 [=========>....................] - ETA: 6:22 - loss: 164992.6503 - acc: 0.1044 66/182 [=========>....................] - ETA: 6:18 - loss: 162492.7964 - acc: 0.1041 67/182 [==========>...................] - ETA: 6:15 - loss: 160067.5654 - acc: 0.1041 68/182 [==========>...................] - ETA: 6:12 - loss: 157713.6652 - acc: 0.1041 69/182 [==========>...................] - ETA: 6:08 - loss: 155427.9934 - acc: 0.1042 70/182 [==========>...................] - ETA: 6:06 - loss: 153207.6264 - acc: 0.1045 71/182 [==========>...................] - ETA: 6:03 - loss: 151049.8047 - acc: 0.1055 72/182 [==========>...................] - ETA: 6:01 - loss: 148951.9232 - acc: 0.1061 73/182 [===========>..................] - ETA: 5:59 - loss: 146911.5175 - acc: 0.1062 74/182 [===========>..................] - ETA: 5:56 - loss: 144926.2578 - acc: 0.1059 75/182 [===========>..................] - ETA: 5:53 - loss: 142993.9383 - acc: 0.1059 76/182 [===========>..................] - ETA: 5:50 - loss: 141112.4692 - acc: 0.1060 77/182 [===========>..................] - ETA: 5:46 - loss: 139279.9354 - acc: 0.1058 78/182 [===========>..................] - ETA: 5:43 - loss: 137494.3248 - acc: 0.1054 79/182 [============>.................] - ETA: 5:40 - loss: 135753.9193 - acc: 0.1051 80/182 [============>.................] - ETA: 5:36 - loss: 134057.0241 - acc: 0.1056 81/182 [============>.................] - ETA: 5:33 - loss: 132402.0274 - acc: 0.1058 82/182 [============>.................] - ETA: 5:29 - loss: 130787.3974 - acc: 0.1055 83/182 [============>.................] - ETA: 5:26 - loss: 129211.6735 - acc: 0.1054 84/182 [============>.................] - ETA: 5:22 - loss: 127673.4667 - acc: 0.1052 85/182 [=============>................] - ETA: 5:19 - loss: 126171.4530 - acc: 0.1049 86/182 [=============>................] - ETA: 5:15 - loss: 124704.3698 - acc: 0.1049 87/182 [=============>................] - ETA: 5:11 - loss: 123271.0126 - acc: 0.1050 88/182 [=============>................] - ETA: 5:08 - loss: 121870.2318 - acc: 0.1048 89/182 [=============>................] - ETA: 5:04 - loss: 120500.9292 - acc: 0.1052 90/182 [=============>................] - ETA: 5:01 - loss: 119162.0553 - acc: 0.1058 91/182 [==============>...............] - ETA: 4:58 - loss: 117852.7572 - acc: 0.1059 92/182 [==============>...............] - ETA: 4:54 - loss: 116571.7782 - acc: 0.1062 93/182 [==============>...............] - ETA: 4:51 - loss: 115318.3430 - acc: 0.1058 94/182 [==============>...............] - ETA: 4:48 - loss: 114091.5768 - acc: 0.1059 95/182 [==============>...............] - ETA: 4:44 - loss: 112890.6371 - acc: 0.1059 96/182 [==============>...............] - ETA: 4:40 - loss: 111714.7169 - acc: 0.1060 97/182 [==============>...............] - ETA: 4:37 - loss: 110563.0424 - acc: 0.1058 98/182 [===============>..............] - ETA: 4:34 - loss: 109434.8716 - acc: 0.1059 99/182 [===============>..............] - ETA: 4:31 - loss: 108329.4919 - acc: 0.1062100/182 [===============>..............] - ETA: 4:28 - loss: 107246.2196 - acc: 0.1066101/182 [===============>..............] - ETA: 4:25 - loss: 106184.3987 - acc: 0.1064102/182 [===============>..............] - ETA: 4:22 - loss: 105143.3980 - acc: 0.1063103/182 [===============>..............] - ETA: 4:19 - loss: 104122.6106 - acc: 0.1066104/182 [================>.............] - ETA: 4:16 - loss: 103121.4546 - acc: 0.1067105/182 [================>.............] - ETA: 4:12 - loss: 102139.3675 - acc: 0.1064106/182 [================>.............] - ETA: 4:09 - loss: 101175.8102 - acc: 0.1062107/182 [================>.............] - ETA: 4:06 - loss: 100230.2631 - acc: 0.1067108/182 [================>.............] - ETA: 4:02 - loss: 99302.2444 - acc: 0.1068 109/182 [================>.............] - ETA: 3:59 - loss: 98391.2365 - acc: 0.1067110/182 [=================>............] - ETA: 3:55 - loss: 97496.7918 - acc: 0.1069111/182 [=================>............] - ETA: 3:52 - loss: 96618.4631 - acc: 0.1070112/182 [=================>............] - ETA: 3:48 - loss: 95755.8188 - acc: 0.1069113/182 [=================>............] - ETA: 3:46 - loss: 94908.4426 - acc: 0.1067114/182 [=================>............] - ETA: 3:42 - loss: 94075.9326 - acc: 0.1067115/182 [=================>............] - ETA: 3:39 - loss: 93257.9007 - acc: 0.1071116/182 [==================>...........] - ETA: 3:35 - loss: 92454.0195 - acc: 0.1069117/182 [==================>...........] - ETA: 3:32 - loss: 91663.8338 - acc: 0.1070118/182 [==================>...........] - ETA: 3:29 - loss: 90887.0412 - acc: 0.1070119/182 [==================>...........] - ETA: 3:25 - loss: 90123.3039 - acc: 0.1070120/182 [==================>...........] - ETA: 3:22 - loss: 89372.2956 - acc: 0.1068121/182 [==================>...........] - ETA: 3:18 - loss: 88633.7006 - acc: 0.1067122/182 [===================>..........] - ETA: 3:15 - loss: 87907.2137 - acc: 0.1064123/182 [===================>..........] - ETA: 3:12 - loss: 87192.5419 - acc: 0.1063124/182 [===================>..........] - ETA: 3:09 - loss: 86489.3948 - acc: 0.1063125/182 [===================>..........] - ETA: 3:06 - loss: 85797.4982 - acc: 0.1061126/182 [===================>..........] - ETA: 3:03 - loss: 85116.5839 - acc: 0.1060127/182 [===================>..........] - ETA: 3:00 - loss: 84446.3928 - acc: 0.1061128/182 [====================>.........] - ETA: 2:56 - loss: 83786.6733 - acc: 0.1060129/182 [====================>.........] - ETA: 3:02 - loss: 83137.1821 - acc: 0.1061130/182 [====================>.........] - ETA: 2:58 - loss: 82497.6830 - acc: 0.1065131/182 [====================>.........] - ETA: 2:55 - loss: 81867.9472 - acc: 0.1065132/182 [====================>.........] - ETA: 2:51 - loss: 81247.7529 - acc: 0.1069133/182 [====================>.........] - ETA: 2:47 - loss: 80636.8847 - acc: 0.1071134/182 [=====================>........] - ETA: 2:44 - loss: 80035.1492 - acc: 0.1070135/182 [=====================>........] - ETA: 2:40 - loss: 79442.3134 - acc: 0.1068136/182 [=====================>........] - ETA: 2:36 - loss: 78858.1956 - acc: 0.1069137/182 [=====================>........] - ETA: 2:33 - loss: 78282.6091 - acc: 0.1069138/182 [=====================>........] - ETA: 2:29 - loss: 77715.3605 - acc: 0.1070139/182 [=====================>........] - ETA: 2:25 - loss: 77156.2738 - acc: 0.1069140/182 [======================>.......] - ETA: 2:22 - loss: 76605.1740 - acc: 0.1070141/182 [======================>.......] - ETA: 2:18 - loss: 76061.8912 - acc: 0.1069142/182 [======================>.......] - ETA: 2:15 - loss: 75526.2603 - acc: 0.1068143/182 [======================>.......] - ETA: 2:11 - loss: 74998.1207 - acc: 0.1067144/182 [======================>.......] - ETA: 2:08 - loss: 74477.3165 - acc: 0.1064145/182 [======================>.......] - ETA: 2:05 - loss: 73963.6957 - acc: 0.1065146/182 [=======================>......] - ETA: 2:01 - loss: 73457.1108 - acc: 0.1065147/182 [=======================>......] - ETA: 1:58 - loss: 72957.4181 - acc: 0.1067148/182 [=======================>......] - ETA: 1:54 - loss: 72464.4781 - acc: 0.1068149/182 [=======================>......] - ETA: 1:51 - loss: 71978.1547 - acc: 0.1067150/182 [=======================>......] - ETA: 1:48 - loss: 71498.3157 - acc: 0.1069151/182 [=======================>......] - ETA: 1:44 - loss: 71024.8320 - acc: 0.1070152/182 [========================>.....] - ETA: 1:41 - loss: 70557.5785 - acc: 0.1069153/182 [========================>.....] - ETA: 1:37 - loss: 70096.4330 - acc: 0.1068154/182 [========================>.....] - ETA: 1:34 - loss: 69641.2763 - acc: 0.1068155/182 [========================>.....] - ETA: 1:31 - loss: 69191.9926 - acc: 0.1065156/182 [========================>.....] - ETA: 1:27 - loss: 68748.4689 - acc: 0.1065157/182 [========================>.....] - ETA: 1:24 - loss: 68310.5951 - acc: 0.1068158/182 [=========================>....] - ETA: 1:20 - loss: 67878.2642 - acc: 0.1070159/182 [=========================>....] - ETA: 1:17 - loss: 67451.3713 - acc: 0.1072160/182 [=========================>....] - ETA: 1:14 - loss: 67029.8145 - acc: 0.1075161/182 [=========================>....] - ETA: 1:10 - loss: 66613.5070 - acc: 0.1077162/182 [=========================>....] - ETA: 1:07 - loss: 66202.3267 - acc: 0.1077163/182 [=========================>....] - ETA: 1:04 - loss: 65796.1916 - acc: 0.1076164/182 [==========================>...] - ETA: 1:00 - loss: 65395.0089 - acc: 0.1077165/182 [==========================>...] - ETA: 57s - loss: 65000.1906 - acc: 0.1079 166/182 [==========================>...] - ETA: 53s - loss: 64608.6371 - acc: 0.1078167/182 [==========================>...] - ETA: 50s - loss: 64221.7729 - acc: 0.1076168/182 [==========================>...] - ETA: 47s - loss: 63839.5141 - acc: 0.1075169/182 [==========================>...] - ETA: 43s - loss: 63461.9252 - acc: 0.1075170/182 [===========================>..] - ETA: 40s - loss: 63088.6333 - acc: 0.1077171/182 [===========================>..] - ETA: 37s - loss: 62719.7074 - acc: 0.1076172/182 [===========================>..] - ETA: 33s - loss: 62355.0713 - acc: 0.1075173/182 [===========================>..] - ETA: 30s - loss: 61994.6507 - acc: 0.1076174/182 [===========================>..] - ETA: 26s - loss: 61638.3728 - acc: 0.1075175/182 [===========================>..] - ETA: 23s - loss: 61286.1667 - acc: 0.1074176/182 [============================>.] - ETA: 20s - loss: 60937.9629 - acc: 0.1074177/182 [============================>.] - ETA: 16s - loss: 60593.6937 - acc: 0.1071178/182 [============================>.] - ETA: 13s - loss: 60253.2926 - acc: 0.1071179/182 [============================>.] - ETA: 10s - loss: 59916.6949 - acc: 0.1070180/182 [============================>.] - ETA: 6s - loss: 59583.8371 - acc: 0.1071 181/182 [============================>.] - ETA: 3s - loss: 59254.6573 - acc: 0.1073  1/182 [..............................] - ETA: 4:00 - loss: 2.3098 - acc: 0.1182  2/182 [..............................] - ETA: 3:05 - loss: 2.3076 - acc: 0.1136  3/182 [..............................] - ETA: 2:41 - loss: 2.3047 - acc: 0.1167  4/182 [..............................] - ETA: 2:27 - loss: 2.3039 - acc: 0.1114  5/182 [..............................] - ETA: 2:18 - loss: 2.3044 - acc: 0.1191  6/182 [..............................] - ETA: 2:11 - loss: 2.3057 - acc: 0.1144  7/182 [>.............................] - ETA: 2:08 - loss: 2.3052 - acc: 0.1104  8/182 [>.............................] - ETA: 2:04 - loss: 2.3048 - acc: 0.1097  9/182 [>.............................] - ETA: 2:04 - loss: 2.3049 - acc: 0.1071 10/182 [>.............................] - ETA: 2:07 - loss: 2.3048 - acc: 0.1050 11/182 [>.............................] - ETA: 2:06 - loss: 2.3045 - acc: 0.1045 12/182 [>.............................] - ETA: 2:04 - loss: 2.3046 - acc: 0.1061 13/182 [=>............................] - ETA: 2:04 - loss: 2.3039 - acc: 0.1042 14/182 [=>............................] - ETA: 2:05 - loss: 2.3043 - acc: 0.1023 15/182 [=>............................] - ETA: 2:04 - loss: 2.3046 - acc: 0.1000 16/182 [=>............................] - ETA: 2:04 - loss: 2.3044 - acc: 0.0989 17/182 [=>............................] - ETA: 2:04 - loss: 2.3040 - acc: 0.1000 18/182 [=>............................] - ETA: 2:01 - loss: 2.3041 - acc: 0.0992 19/182 [==>...........................] - ETA: 1:59 - loss: 2.3041 - acc: 0.0990 20/182 [==>...........................] - ETA: 2:00 - loss: 2.3045 - acc: 0.0984 21/182 [==>...........................] - ETA: 2:01 - loss: 2.3045 - acc: 0.0970 22/182 [==>...........................] - ETA: 2:10 - loss: 2.3041 - acc: 0.0983 23/182 [==>...........................] - ETA: 2:19 - loss: 2.3040 - acc: 0.0980 24/182 [==>...........................] - ETA: 2:22 - loss: 2.3039 - acc: 0.0985 25/182 [===>..........................] - ETA: 2:21 - loss: 2.3037 - acc: 0.0991 26/182 [===>..........................] - ETA: 2:20 - loss: 2.3033 - acc: 0.1003 27/182 [===>..........................] - ETA: 2:19 - loss: 2.3030 - acc: 0.1007 28/182 [===>..........................] - ETA: 2:19 - loss: 2.3031 - acc: 0.0998 29/182 [===>..........................] - ETA: 2:17 - loss: 2.3032 - acc: 0.0992 30/182 [===>..........................] - ETA: 2:16 - loss: 2.3033 - acc: 0.0995 31/182 [====>.........................] - ETA: 2:14 - loss: 2.3034 - acc: 0.0994 32/182 [====>.........................] - ETA: 2:13 - loss: 2.3034 - acc: 0.0996 33/182 [====>.........................] - ETA: 2:12 - loss: 2.3033 - acc: 0.0990 34/182 [====>.........................] - ETA: 2:11 - loss: 2.3032 - acc: 0.0989 35/182 [====>.........................] - ETA: 2:10 - loss: 2.3034 - acc: 0.0988 36/182 [====>.........................] - ETA: 2:09 - loss: 2.3033 - acc: 0.0987 37/182 [=====>........................] - ETA: 2:08 - loss: 2.3035 - acc: 0.0984 38/182 [=====>........................] - ETA: 2:07 - loss: 2.3035 - acc: 0.0988 39/182 [=====>........................] - ETA: 2:06 - loss: 2.3036 - acc: 0.0993 40/182 [=====>........................] - ETA: 2:05 - loss: 2.3035 - acc: 0.1002 41/182 [=====>........................] - ETA: 2:04 - loss: 2.3036 - acc: 0.1010 42/182 [=====>........................] - ETA: 2:03 - loss: 2.3037 - acc: 0.1003 43/182 [======>.......................] - ETA: 2:01 - loss: 2.3037 - acc: 0.1002 44/182 [======>.......................] - ETA: 2:00 - loss: 2.3037 - acc: 0.1007 45/182 [======>.......................] - ETA: 1:59 - loss: 2.3039 - acc: 0.1005 46/182 [======>.......................] - ETA: 2:09 - loss: 2.3040 - acc: 0.1000182/182 [==============================] - 656s 4s/step - loss: 58929.4312 - acc: 0.1073 - val_loss: 2.3040 - val_acc: 0.1000
