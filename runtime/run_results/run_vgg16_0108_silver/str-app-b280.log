WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1630: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/stropt/lms.py:970: The name tf.train.SessionRunHook is deprecated. Please use tf.estimator.SessionRunHook instead.

WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/stropt/str_strategy.py:122: get_backward_walk_ops (from tensorflow.contrib.graph_editor.select) is deprecated and will be removed after 2019-06-06.
Instructions for updating:
Please use tensorflow.python.ops.op_selector.get_backward_walk_ops.
WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/stropt/lms.py:928: The name tf.logging.info is deprecated. Please use tf.compat.v1.logging.info instead.

1 Physical GPUs, 1 Logical GPUs
Parsing arguments: [('batch_size', 280), ('epochs', 1), ('model_name', 'VGG16'), ('strategy', 'str-app'), ('verbose', False)]
Cannot find config for batch_size=280, use 250 instead
Shape of x_train: (40000, 224, 224, 3), shape of x_test: (10000, 224, 224, 3)
[STR DEBUG] Parsing STR configuration: [{'strategy': 'hybrid', 'verbose': 'false', 'tags': '/home/zongzan/dist_dnn_training/STR/optimizer/logs/VGG16_250/layer_names'}, {'r': '/home/zongzan/dist_dnn_training/STR/optimizer/logs/VGG16_250/R-approx', 'p': '/home/zongzan/dist_dnn_training/STR/optimizer/logs/VGG16_250/P-approx', 'q': '/home/zongzan/dist_dnn_training/STR/optimizer/logs/VGG16_250/Q-approx'}]
[STR DEBUG] Processing layer 0's swapping, swap out at [1], swap in at [36]
[STR DEBUG] Find swapout ops: name: "input_1"
op: "Placeholder"
attr {
  key: "dtype"
  value {
    type: DT_FLOAT
  }
}
attr {
  key: "shape"
  value {
    shape {
      dim {
        size: -1
      }
      dim {
        size: 224
      }
      dim {
        size: 224
      }
      dim {
        size: 3
      }
    }
  }
}
, 
	choose swap tensor Tensor("input_1:0", shape=(?, 224, 224, 3), dtype=float32), 
	finish at the end of ops: [<tf.Operation 'block1_conv1/Relu' type=Relu>]
[STR DEBUG] Add swap-in op at name: "training/RMSprop/gradients/gradients_10/training/RMSprop/gradients/block3_conv2/Relu_grad/ReluGrad"
op: "ReluGrad"
input: "training/RMSprop/gradients/gradients_10/grad_ys_0"
input: "training/RMSprop/gradients/block3_conv2/Relu"
attr {
  key: "T"
  value {
    type: DT_FLOAT
  }
}
 for consumer [<tf.Operation 'training/RMSprop/gradients/gradients_14/training/RMSprop/gradients/block1_conv1/Conv2D_grad/Conv2DBackpropFilter' type=Conv2DBackpropFilter>]
[STR DEBUG] Cannot find swap-out operations for swap-in at layer 1, skipping
[STR DEBUG] Cannot find swap-out operations for swap-in at layer 3, skipping
[STR DEBUG] Cannot find swap-out operations for swap-in at layer 4, skipping
[STR DEBUG] Processing layer 6's swapping, swap out at [7], swap in at [22]
[STR DEBUG] Find swapout ops: name: "block2_pool/MaxPool"
op: "MaxPool"
input: "block2_conv2/Relu"
attr {
  key: "T"
  value {
    type: DT_FLOAT
  }
}
attr {
  key: "data_format"
  value {
    s: "NHWC"
  }
}
attr {
  key: "ksize"
  value {
    list {
      i: 1
      i: 2
      i: 2
      i: 1
    }
  }
}
attr {
  key: "padding"
  value {
    s: "VALID"
  }
}
attr {
  key: "strides"
  value {
    list {
      i: 1
      i: 2
      i: 2
      i: 1
    }
  }
}
, 
	choose swap tensor Tensor("block2_pool/MaxPool:0", shape=(?, 56, 56, 128), dtype=float32), 
	finish at the end of ops: [<tf.Operation 'block3_conv1/Relu' type=Relu>]
[STR DEBUG] Cannot find swap-out operations for swap-in at layer 7, skipping
[STR DEBUG] Cannot find swap-out operations for swap-in at layer 8, skipping
[STR DEBUG] Processing layer 10's swapping, swap out at [11], swap in at [16]
[STR DEBUG] Find swapout ops: name: "block3_pool/MaxPool"
op: "MaxPool"
input: "block3_conv3/Relu"
attr {
  key: "T"
  value {
    type: DT_FLOAT
  }
}
attr {
  key: "data_format"
  value {
    s: "NHWC"
  }
}
attr {
  key: "ksize"
  value {
    list {
      i: 1
      i: 2
      i: 2
      i: 1
    }
  }
}
attr {
  key: "padding"
  value {
    s: "VALID"
  }
}
attr {
  key: "strides"
  value {
    list {
      i: 1
      i: 2
      i: 2
      i: 1
    }
  }
}
, 
	choose swap tensor Tensor("block3_pool/MaxPool:0", shape=(?, 28, 28, 256), dtype=float32), 
	finish at the end of ops: [<tf.Operation 'block4_conv1/Relu' type=Relu>]
[STR DEBUG] Processing layer 11's swapping, swap out at [12], swap in at [28]
[STR DEBUG] Find swapout ops: name: "block4_conv1/Relu"
op: "Relu"
input: "block4_conv1/BiasAdd"
attr {
  key: "T"
  value {
    type: DT_FLOAT
  }
}
, 
	choose swap tensor Tensor("block4_conv1/Relu:0", shape=(?, 28, 28, 512), dtype=float32), 
	finish at the end of ops: [<tf.Operation 'block4_conv2/Relu' type=Relu>]
  1/143 [..............................] - ETA: 1:04:32 - loss: 2.3148 - acc: 0.1036  2/143 [..............................] - ETA: 34:39 - loss: 19277397.1574 - acc: 0.1036  3/143 [..............................] - ETA: 24:38 - loss: 12851608.4151 - acc: 0.1048  4/143 [..............................] - ETA: 19:37 - loss: 9639193.7634 - acc: 0.1036   5/143 [>.............................] - ETA: 16:43 - loss: 7711356.4735 - acc: 0.1021  6/143 [>.............................] - ETA: 14:43 - loss: 6426133.8596 - acc: 0.1006  7/143 [>.............................] - ETA: 13:18 - loss: 5508130.2744 - acc: 0.1036  8/143 [>.............................] - ETA: 12:14 - loss: 4819614.2919 - acc: 0.0982  9/143 [>.............................] - ETA: 11:24 - loss: 4284101.8540 - acc: 0.0956 10/143 [=>............................] - ETA: 10:43 - loss: 3855692.4708 - acc: 0.0957 11/143 [=>............................] - ETA: 10:09 - loss: 3505175.1832 - acc: 0.0929 12/143 [=>............................] - ETA: 9:40 - loss: 3213077.4434 - acc: 0.0970  13/143 [=>............................] - ETA: 9:15 - loss: 2965917.8172 - acc: 0.0967 14/143 [=>............................] - ETA: 8:55 - loss: 2754066.7096 - acc: 0.0990 15/143 [==>...........................] - ETA: 8:36 - loss: 2570462.4154 - acc: 0.0995 16/143 [==>...........................] - ETA: 8:19 - loss: 2409808.6586 - acc: 0.0987 17/143 [==>...........................] - ETA: 8:04 - loss: 2268055.3428 - acc: 0.0981 18/143 [==>...........................] - ETA: 7:52 - loss: 2142052.4008 - acc: 0.0982 19/143 [==>...........................] - ETA: 7:40 - loss: 2029312.9277 - acc: 0.0981 20/143 [===>..........................] - ETA: 7:29 - loss: 1927847.3966 - acc: 0.0980 21/143 [===>..........................] - ETA: 7:19 - loss: 1836045.2493 - acc: 0.1002 22/143 [===>..........................] - ETA: 7:09 - loss: 1752588.7517 - acc: 0.1003 23/143 [===>..........................] - ETA: 7:00 - loss: 1676389.3408 - acc: 0.1011 24/143 [====>.........................] - ETA: 6:51 - loss: 1606539.8807 - acc: 0.1037 25/143 [====>.........................] - ETA: 6:44 - loss: 1542278.3773 - acc: 0.1044 26/143 [====>.........................] - ETA: 6:36 - loss: 1482960.0665 - acc: 0.1060 27/143 [====>.........................] - ETA: 6:29 - loss: 1428035.7029 - acc: 0.1063 28/143 [====>.........................] - ETA: 6:22 - loss: 1377034.5099 - acc: 0.1063 29/143 [=====>........................] - ETA: 6:16 - loss: 1329550.6461 - acc: 0.1065 30/143 [=====>........................] - ETA: 6:09 - loss: 1285232.5317 - acc: 0.1074 31/143 [=====>........................] - ETA: 6:03 - loss: 1243773.4921 - acc: 0.1078 32/143 [=====>........................] - ETA: 5:57 - loss: 1204905.6425 - acc: 0.1073 33/143 [=====>........................] - ETA: 5:52 - loss: 1168393.4201 - acc: 0.1078 34/143 [======>.......................] - ETA: 5:46 - loss: 1134028.9754 - acc: 0.1078 35/143 [======>.......................] - ETA: 5:41 - loss: 1101628.2134 - acc: 0.1064 36/143 [======>.......................] - ETA: 5:36 - loss: 1071027.4935 - acc: 0.1068 37/143 [======>.......................] - ETA: 5:30 - loss: 1042080.8670 - acc: 0.1053 38/143 [======>.......................] - ETA: 5:25 - loss: 1014657.7468 - acc: 0.1059 39/143 [=======>......................] - ETA: 5:20 - loss: 988640.9404 - acc: 0.1059  40/143 [=======>......................] - ETA: 5:16 - loss: 963924.9744 - acc: 0.1064 41/143 [=======>......................] - ETA: 5:11 - loss: 940414.6652 - acc: 0.1061 42/143 [=======>......................] - ETA: 5:07 - loss: 918023.8944 - acc: 0.1060 43/143 [========>.....................] - ETA: 5:02 - loss: 896674.5545 - acc: 0.1069 44/143 [========>.....................] - ETA: 4:58 - loss: 876295.6461 - acc: 0.1067 45/143 [========>.....................] - ETA: 4:54 - loss: 856822.4604 - acc: 0.1063 46/143 [========>.....................] - ETA: 4:50 - loss: 838195.9357 - acc: 0.1058 47/143 [========>.....................] - ETA: 4:45 - loss: 820362.0294 - acc: 0.1065 48/143 [=========>....................] - ETA: 4:41 - loss: 803271.2049 - acc: 0.1059 49/143 [=========>....................] - ETA: 4:37 - loss: 786877.9620 - acc: 0.1056 50/143 [=========>....................] - ETA: 4:33 - loss: 771140.4487 - acc: 0.1072 51/143 [=========>....................] - ETA: 4:30 - loss: 756020.0929 - acc: 0.1083 52/143 [=========>....................] - ETA: 4:26 - loss: 741481.2891 - acc: 0.1084 53/143 [==========>...................] - ETA: 4:22 - loss: 727491.1188 - acc: 0.1096 54/143 [==========>...................] - ETA: 4:18 - loss: 714019.1122 - acc: 0.1095 55/143 [==========>...................] - ETA: 4:14 - loss: 701036.9884 - acc: 0.1091 56/143 [==========>...................] - ETA: 4:11 - loss: 688518.5120 - acc: 0.1083 57/143 [==========>...................] - ETA: 4:07 - loss: 676439.2804 - acc: 0.1080 58/143 [===========>..................] - ETA: 4:04 - loss: 664776.5738 - acc: 0.1081 59/143 [===========>..................] - ETA: 4:00 - loss: 653509.2133 - acc: 0.1079 60/143 [===========>..................] - ETA: 3:57 - loss: 642617.4314 - acc: 0.1080 61/143 [===========>..................] - ETA: 3:53 - loss: 632082.7607 - acc: 0.1076 62/143 [============>.................] - ETA: 3:50 - loss: 621887.9146 - acc: 0.1073 63/143 [============>.................] - ETA: 3:46 - loss: 612016.7144 - acc: 0.1077 64/143 [============>.................] - ETA: 3:43 - loss: 602453.9892 - acc: 0.1083 65/143 [============>.................] - ETA: 3:55 - loss: 593185.5014 - acc: 0.1086 66/143 [============>.................] - ETA: 3:51 - loss: 584197.8775 - acc: 0.1086 67/143 [=============>................] - ETA: 3:48 - loss: 575478.5406 - acc: 0.1096 68/143 [=============>................] - ETA: 3:44 - loss: 567015.6545 - acc: 0.1099 69/143 [=============>................] - ETA: 3:40 - loss: 558798.0728 - acc: 0.1096 70/143 [=============>................] - ETA: 3:37 - loss: 550815.2761 - acc: 0.1091 71/143 [=============>................] - ETA: 3:33 - loss: 543057.3469 - acc: 0.1087 72/143 [==============>...............] - ETA: 3:30 - loss: 535514.9156 - acc: 0.1083 73/143 [==============>...............] - ETA: 3:26 - loss: 528179.1273 - acc: 0.1080 74/143 [==============>...............] - ETA: 3:23 - loss: 521041.6026 - acc: 0.1083 75/143 [==============>...............] - ETA: 3:19 - loss: 514094.4168 - acc: 0.1084 76/143 [==============>...............] - ETA: 3:16 - loss: 507330.0469 - acc: 0.1082 77/143 [===============>..............] - ETA: 3:13 - loss: 500741.3748 - acc: 0.1085 78/143 [===============>..............] - ETA: 3:09 - loss: 494321.6430 - acc: 0.1085 79/143 [===============>..............] - ETA: 3:06 - loss: 488064.4363 - acc: 0.1083 80/143 [===============>..............] - ETA: 3:02 - loss: 481963.6596 - acc: 0.1085 81/143 [===============>..............] - ETA: 2:59 - loss: 476013.5194 - acc: 0.1082 82/143 [================>.............] - ETA: 2:56 - loss: 470208.5045 - acc: 0.1082 83/143 [================>.............] - ETA: 2:53 - loss: 464543.3692 - acc: 0.1091 84/143 [================>.............] - ETA: 2:49 - loss: 459013.1239 - acc: 0.1090 85/143 [================>.............] - ETA: 2:46 - loss: 453612.9965 - acc: 0.1094 86/143 [=================>............] - ETA: 2:43 - loss: 448338.4536 - acc: 0.1094 87/143 [=================>............] - ETA: 2:40 - loss: 443185.1647 - acc: 0.1095 88/143 [=================>............] - ETA: 2:37 - loss: 438148.9958 - acc: 0.1093 89/143 [=================>............] - ETA: 2:33 - loss: 433225.9993 - acc: 0.1090 90/143 [=================>............] - ETA: 2:30 - loss: 428412.4026 - acc: 0.1089 91/143 [==================>...........] - ETA: 2:27 - loss: 423704.5992 - acc: 0.1089 92/143 [==================>...........] - ETA: 2:24 - loss: 419099.1394 - acc: 0.1087 93/143 [==================>...........] - ETA: 2:21 - loss: 414592.7217 - acc: 0.1089 94/143 [==================>...........] - ETA: 2:18 - loss: 410182.1873 - acc: 0.1085 95/143 [==================>...........] - ETA: 2:15 - loss: 405864.5043 - acc: 0.1083 96/143 [===================>..........] - ETA: 2:12 - loss: 401636.7731 - acc: 0.1083 97/143 [===================>..........] - ETA: 2:09 - loss: 397496.2115 - acc: 0.1086 98/143 [===================>..........] - ETA: 2:06 - loss: 393440.1511 - acc: 0.1089 99/143 [===================>..........] - ETA: 2:03 - loss: 389466.0313 - acc: 0.1095100/143 [===================>..........] - ETA: 2:00 - loss: 385571.4350 - acc: 0.1094101/143 [====================>.........] - ETA: 1:57 - loss: 381753.9189 - acc: 0.1091102/143 [====================>.........] - ETA: 1:54 - loss: 378011.2559 - acc: 0.1095103/143 [====================>.........] - ETA: 1:51 - loss: 374341.2660 - acc: 0.1099104/143 [====================>.........] - ETA: 1:48 - loss: 370741.8525 - acc: 0.1098105/143 [=====================>........] - ETA: 1:45 - loss: 367210.9997 - acc: 0.1100106/143 [=====================>........] - ETA: 1:42 - loss: 363746.7669 - acc: 0.1099107/143 [=====================>........] - ETA: 1:39 - loss: 360347.2859 - acc: 0.1096108/143 [=====================>........] - ETA: 1:36 - loss: 357010.7622 - acc: 0.1093109/143 [=====================>........] - ETA: 1:33 - loss: 353735.4552 - acc: 0.1094110/143 [======================>.......] - ETA: 1:31 - loss: 350519.6993 - acc: 0.1092111/143 [======================>.......] - ETA: 1:28 - loss: 347361.8849 - acc: 0.1091112/143 [======================>.......] - ETA: 1:25 - loss: 344260.4600 - acc: 0.1093113/143 [======================>.......] - ETA: 1:22 - loss: 341213.9273 - acc: 0.1095114/143 [======================>.......] - ETA: 1:19 - loss: 338220.8429 - acc: 0.1096115/143 [=======================>......] - ETA: 1:16 - loss: 335279.8120 - acc: 0.1097116/143 [=======================>......] - ETA: 1:13 - loss: 332389.4886 - acc: 0.1095117/143 [=======================>......] - ETA: 1:11 - loss: 329548.5722 - acc: 0.1096118/143 [=======================>......] - ETA: 1:08 - loss: 326755.8112 - acc: 0.1095119/143 [=======================>......] - ETA: 1:05 - loss: 324009.9834 - acc: 0.1096120/143 [========================>.....] - ETA: 1:02 - loss: 321309.9194 - acc: 0.1096121/143 [========================>.....] - ETA: 59s - loss: 318654.4851 - acc: 0.1094 122/143 [========================>.....] - ETA: 57s - loss: 316042.5821 - acc: 0.1094123/143 [========================>.....] - ETA: 54s - loss: 313473.1489 - acc: 0.1095124/143 [=========================>....] - ETA: 51s - loss: 310945.1582 - acc: 0.1095125/143 [=========================>....] - ETA: 48s - loss: 308457.6153 - acc: 0.1096126/143 [=========================>....] - ETA: 46s - loss: 306009.5573 - acc: 0.1094127/143 [=========================>....] - ETA: 43s - loss: 303600.0513 - acc: 0.1095128/143 [=========================>....] - ETA: 40s - loss: 301228.1943 - acc: 0.1096129/143 [==========================>...] - ETA: 37s - loss: 298893.1099 - acc: 0.1096130/143 [==========================>...] - ETA: 35s - loss: 296593.9497 - acc: 0.1095131/143 [==========================>...] - ETA: 32s - loss: 294329.9029 - acc: 0.1096132/143 [==========================>...] - ETA: 29s - loss: 292100.1483 - acc: 0.1093133/143 [==========================>...] - ETA: 26s - loss: 289903.9239 - acc: 0.1093134/143 [===========================>..] - ETA: 24s - loss: 287740.4790 - acc: 0.1091135/143 [===========================>..] - ETA: 21s - loss: 285609.0851 - acc: 0.1093136/143 [===========================>..] - ETA: 18s - loss: 283509.0351 - acc: 0.1094137/143 [===========================>..] - ETA: 16s - loss: 281439.6429 - acc: 0.1094138/143 [===========================>..] - ETA: 13s - loss: 279400.2419 - acc: 0.1092139/143 [============================>.] - ETA: 10s - loss: 277390.1848 - acc: 0.1091140/143 [============================>.] - ETA: 8s - loss: 275408.8427 - acc: 0.1092 141/143 [============================>.] - ETA: 5s - loss: 273455.6048 - acc: 0.1093142/143 [============================>.] - ETA: 2s - loss: 271529.8773 - acc: 0.1092  1/143 [..............................] - ETA: 2:43 - loss: 2.2970 - acc: 0.1107  2/143 [..............................] - ETA: 2:07 - loss: 2.2969 - acc: 0.1161  3/143 [..............................] - ETA: 1:54 - loss: 2.2962 - acc: 0.1190  4/143 [..............................] - ETA: 1:45 - loss: 2.2959 - acc: 0.1196  5/143 [>.............................] - ETA: 1:40 - loss: 2.2964 - acc: 0.1143  6/143 [>.............................] - ETA: 1:37 - loss: 2.2962 - acc: 0.1131  7/143 [>.............................] - ETA: 1:34 - loss: 2.2970 - acc: 0.1077  8/143 [>.............................] - ETA: 1:32 - loss: 2.2970 - acc: 0.1067  9/143 [>.............................] - ETA: 1:30 - loss: 2.2967 - acc: 0.1079 10/143 [=>............................] - ETA: 1:29 - loss: 2.2966 - acc: 0.1064 11/143 [=>............................] - ETA: 1:27 - loss: 2.2968 - acc: 0.1045 12/143 [=>............................] - ETA: 1:25 - loss: 2.2973 - acc: 0.1015 13/143 [=>............................] - ETA: 1:24 - loss: 2.2972 - acc: 0.1016 14/143 [=>............................] - ETA: 1:24 - loss: 2.2972 - acc: 0.1008 15/143 [==>...........................] - ETA: 1:23 - loss: 2.2971 - acc: 0.1007 16/143 [==>...........................] - ETA: 1:21 - loss: 2.2972 - acc: 0.0998 17/143 [==>...........................] - ETA: 1:21 - loss: 2.2973 - acc: 0.1002 18/143 [==>...........................] - ETA: 1:21 - loss: 2.2975 - acc: 0.1000 19/143 [==>...........................] - ETA: 1:20 - loss: 2.2976 - acc: 0.1004 20/143 [===>..........................] - ETA: 1:21 - loss: 2.2976 - acc: 0.1020 21/143 [===>..........................] - ETA: 1:21 - loss: 2.2975 - acc: 0.1026 22/143 [===>..........................] - ETA: 1:21 - loss: 2.2976 - acc: 0.1018 23/143 [===>..........................] - ETA: 1:21 - loss: 2.2977 - acc: 0.1008 24/143 [====>.........................] - ETA: 1:21 - loss: 2.2974 - acc: 0.1013 25/143 [====>.........................] - ETA: 1:21 - loss: 2.2975 - acc: 0.1016 26/143 [====>.........................] - ETA: 1:21 - loss: 2.2976 - acc: 0.1005 27/143 [====>.........................] - ETA: 1:21 - loss: 2.2977 - acc: 0.1005 28/143 [====>.........................] - ETA: 1:20 - loss: 2.2976 - acc: 0.1000 29/143 [=====>........................] - ETA: 1:19 - loss: 2.2976 - acc: 0.1000 30/143 [=====>........................] - ETA: 1:18 - loss: 2.2977 - acc: 0.1004 31/143 [=====>........................] - ETA: 1:17 - loss: 2.2977 - acc: 0.1010 32/143 [=====>........................] - ETA: 1:16 - loss: 2.2975 - acc: 0.1023 33/143 [=====>........................] - ETA: 1:15 - loss: 2.2975 - acc: 0.1017 34/143 [======>.......................] - ETA: 1:15 - loss: 2.2976 - acc: 0.1017 35/143 [======>.......................] - ETA: 1:14 - loss: 2.2976 - acc: 0.1023 36/143 [======>.......................] - ETA: 1:25 - loss: 2.2976 - acc: 0.1015143/143 [==============================] - 411s 3s/step - loss: 269632.9558 - acc: 0.1089 - val_loss: 2.2976 - val_acc: 0.1015
