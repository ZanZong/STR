WARNING:tensorflow:From ../run_training.py:27: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

WARNING:tensorflow:From ../run_training.py:27: The name tf.ConfigProto is deprecated. Please use tf.compat.v1.ConfigProto instead.

WARNING:tensorflow:From ../run_training.py:27: The name tf.GPUOptions is deprecated. Please use tf.compat.v1.GPUOptions instead.

WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1630: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
1 Physical GPUs, 1 Logical GPUs
Parsing arguments: [('batch_size', 15), ('epochs', 1), ('model_name', 'vgg_unet'), ('strategy', 'capuchin'), ('verbose', False)]
Cannot find config for batch_size=15, use 40 instead
There are 367 and 367 images downloaded for train and test
Verifying train dataset
  0%|          | 0/367 [00:00<?, ?it/s]  2%|▏         | 8/367 [00:00<00:04, 76.28it/s]  5%|▌         | 20/367 [00:00<00:03, 99.63it/s]  9%|▉         | 33/367 [00:00<00:02, 112.40it/s] 13%|█▎        | 47/367 [00:00<00:02, 120.58it/s] 16%|█▋        | 60/367 [00:00<00:02, 123.64it/s] 20%|█▉        | 73/367 [00:00<00:02, 125.47it/s] 23%|██▎       | 86/367 [00:00<00:02, 126.40it/s] 27%|██▋       | 100/367 [00:00<00:02, 128.54it/s] 31%|███▏      | 115/367 [00:00<00:01, 132.72it/s] 36%|███▌      | 131/367 [00:01<00:01, 139.44it/s] 40%|████      | 147/367 [00:01<00:01, 144.06it/s] 44%|████▍     | 163/367 [00:01<00:01, 147.19it/s] 49%|████▉     | 180/367 [00:01<00:01, 151.60it/s] 54%|█████▎    | 197/367 [00:01<00:01, 154.42it/s] 58%|█████▊    | 213/367 [00:01<00:00, 154.86it/s] 62%|██████▏   | 229/367 [00:01<00:00, 155.37it/s] 67%|██████▋   | 245/367 [00:01<00:00, 156.11it/s] 71%|███████▏  | 262/367 [00:01<00:00, 158.35it/s] 76%|███████▌  | 278/367 [00:01<00:00, 158.18it/s] 80%|████████  | 294/367 [00:02<00:00, 158.59it/s] 84%|████████▍ | 310/367 [00:02<00:00, 157.47it/s] 89%|████████▉ | 327/367 [00:02<00:00, 159.90it/s] 93%|█████████▎| 343/367 [00:02<00:00, 158.58it/s] 98%|█████████▊| 359/367 [00:02<00:00, 158.16it/s]100%|██████████| 367/367 [00:02<00:00, 145.47it/s]
WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/stropt/lms.py:970: The name tf.train.SessionRunHook is deprecated. Please use tf.estimator.SessionRunHook instead.

WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/stropt/str_strategy.py:122: get_backward_walk_ops (from tensorflow.contrib.graph_editor.select) is deprecated and will be removed after 2019-06-06.
Instructions for updating:
Please use tensorflow.python.ops.op_selector.get_backward_walk_ops.
WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/math_grad.py:1424: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/stropt/lms.py:928: The name tf.logging.info is deprecated. Please use tf.compat.v1.logging.info instead.

Dataset verified! 
Starting Epoch  0
[STR DEBUG] Parsing STR configuration: [{'strategy': 'hybrid', 'verbose': 'false', 'tags': '/home/zongzan/dist_dnn_training/STR/optimizer/logs/vgg_unet_40/layer_names'}, {'r': '/home/zongzan/dist_dnn_training/STR/optimizer/logs/vgg_unet_40/R-capuchin', 'p': '/home/zongzan/dist_dnn_training/STR/optimizer/logs/vgg_unet_40/P-capuchin', 'q': '/home/zongzan/dist_dnn_training/STR/optimizer/logs/vgg_unet_40/Q-capuchin'}]
[STR DEBUG] Processing layer 28's swapping, swap out at [30], swap in at [41]
[STR DEBUG] Cannot find swap-out activation nodes for layer 28 among [<tf.Operation 'up_sampling2d_2/Const' type=Const>, <tf.Operation 'up_sampling2d_2/Shape' type=Shape>, <tf.Operation 'up_sampling2d_2/strided_slice/stack_1' type=Const>, <tf.Operation 'up_sampling2d_2/strided_slice/stack' type=Const>, <tf.Operation 'up_sampling2d_2/strided_slice' type=StridedSlice>, <tf.Operation 'up_sampling2d_2/mul' type=Mul>, <tf.Operation 'up_sampling2d_2/resize/ResizeNearestNeighbor' type=ResizeNearestNeighbor>, <tf.Operation 'up_sampling2d_2/strided_slice/stack_2' type=Const>]
[STR DEBUG] Processing layer 29's swapping, swap out at [31], swap in at [40]
[STR DEBUG] Cannot find swap-out activation nodes for layer 29 among [<tf.Operation 'concatenate_2/concat/axis' type=Const>, <tf.Operation 'concatenate_2/concat' type=ConcatV2>]
[STR DEBUG] Processing layer 31's swapping, swap out at [34], swap in at [38]
[STR DEBUG] Cannot find swap-out activation nodes for layer 31 among [<tf.Operation 'conv2d_3/kernel' type=VarHandleOp>, <tf.Operation 'conv2d_3/kernel/IsInitialized/VarIsInitializedOp' type=VarIsInitializedOp>, <tf.Operation 'conv2d_3/kernel/Read/ReadVariableOp' type=ReadVariableOp>, <tf.Operation 'conv2d_3/kernel/Assign' type=AssignVariableOp>, <tf.Operation 'conv2d_3/bias/Initializer/zeros' type=Const>, <tf.Operation 'conv2d_3/bias' type=VarHandleOp>, <tf.Operation 'conv2d_3/bias/IsInitialized/VarIsInitializedOp' type=VarIsInitializedOp>, <tf.Operation 'conv2d_3/Conv2D' type=Conv2D>, <tf.Operation 'conv2d_3/bias/Read/ReadVariableOp' type=ReadVariableOp>, <tf.Operation 'conv2d_3/bias/Assign' type=AssignVariableOp>, <tf.Operation 'conv2d_3/BiasAdd' type=BiasAdd>, <tf.Operation 'conv2d_3/BiasAdd/ReadVariableOp' type=ReadVariableOp>, <tf.Operation 'conv2d_3/Conv2D/ReadVariableOp' type=ReadVariableOp>, <tf.Operation 'conv2d_3/dilation_rate' type=Const>, <tf.Operation 'conv2d_3/kernel/Initializer/random_uniform/shape' type=Const>, <tf.Operation 'conv2d_3/kernel/Initializer/random_uniform/min' type=Const>, <tf.Operation 'conv2d_3/kernel/Initializer/random_uniform/max' type=Const>, <tf.Operation 'conv2d_3/kernel/Initializer/random_uniform/RandomUniform' type=RandomUniform>, <tf.Operation 'conv2d_3/kernel/Initializer/random_uniform/sub' type=Sub>, <tf.Operation 'conv2d_3/kernel/Initializer/random_uniform/mul' type=Mul>, <tf.Operation 'conv2d_3/kernel/Initializer/random_uniform' type=Add>]
[STR DEBUG] Processing layer 33's swapping, swap out at [35], swap in at [36]
[STR DEBUG] Cannot find swap-out activation nodes for layer 33 among [<tf.Operation 'conv2d_4/kernel/Assign' type=AssignVariableOp>, <tf.Operation 'conv2d_4/bias/Initializer/zeros' type=Const>, <tf.Operation 'conv2d_4/bias' type=VarHandleOp>, <tf.Operation 'conv2d_4/bias/IsInitialized/VarIsInitializedOp' type=VarIsInitializedOp>, <tf.Operation 'conv2d_4/bias/Read/ReadVariableOp' type=ReadVariableOp>, <tf.Operation 'conv2d_4/bias/Assign' type=AssignVariableOp>, <tf.Operation 'conv2d_4/Conv2D' type=Conv2D>, <tf.Operation 'conv2d_4/BiasAdd' type=BiasAdd>, <tf.Operation 'conv2d_4/BiasAdd/ReadVariableOp' type=ReadVariableOp>, <tf.Operation 'conv2d_4/Conv2D/ReadVariableOp' type=ReadVariableOp>, <tf.Operation 'conv2d_4/kernel/Initializer/random_uniform/shape' type=Const>, <tf.Operation 'conv2d_4/kernel/Initializer/random_uniform/min' type=Const>, <tf.Operation 'conv2d_4/kernel/Initializer/random_uniform/max' type=Const>, <tf.Operation 'conv2d_4/kernel/Initializer/random_uniform/RandomUniform' type=RandomUniform>, <tf.Operation 'conv2d_4/kernel/Initializer/random_uniform/sub' type=Sub>, <tf.Operation 'conv2d_4/kernel/Initializer/random_uniform' type=Add>, <tf.Operation 'conv2d_4/kernel/Initializer/random_uniform/mul' type=Mul>, <tf.Operation 'conv2d_4/kernel' type=VarHandleOp>, <tf.Operation 'conv2d_4/kernel/IsInitialized/VarIsInitializedOp' type=VarIsInitializedOp>, <tf.Operation 'conv2d_4/kernel/Read/ReadVariableOp' type=ReadVariableOp>, <tf.Operation 'conv2d_4/dilation_rate' type=Const>]
 1/64 [..............................] - ETA: 14:46 - loss: 4.5101 - acc: 0.0589 2/64 [..............................] - ETA: 7:51 - loss: 4.5228 - acc: 0.0497  3/64 [>.............................] - ETA: 5:43 - loss: 4.5515 - acc: 0.0467 4/64 [>.............................] - ETA: 4:29 - loss: 4.5671 - acc: 0.0439 5/64 [=>............................] - ETA: 3:44 - loss: 4.5751 - acc: 0.0440 6/64 [=>............................] - ETA: 3:13 - loss: 4.5721 - acc: 0.0460 7/64 [==>...........................] - ETA: 2:51 - loss: 4.5720 - acc: 0.0474 8/64 [==>...........................] - ETA: 2:34 - loss: 4.5721 - acc: 0.0476 9/64 [===>..........................] - ETA: 2:21 - loss: 4.5630 - acc: 0.047710/64 [===>..........................] - ETA: 2:11 - loss: 4.5640 - acc: 0.047011/64 [====>.........................] - ETA: 2:02 - loss: 4.5597 - acc: 0.048712/64 [====>.........................] - ETA: 1:54 - loss: 4.5575 - acc: 0.049813/64 [=====>........................] - ETA: 1:47 - loss: 4.5596 - acc: 0.050314/64 [=====>........................] - ETA: 1:41 - loss: 4.5546 - acc: 0.051615/64 [======>.......................] - ETA: 1:36 - loss: 4.5531 - acc: 0.050916/64 [======>.......................] - ETA: 1:31 - loss: 4.5492 - acc: 0.051117/64 [======>.......................] - ETA: 1:27 - loss: 4.5488 - acc: 0.050618/64 [=======>......................] - ETA: 1:23 - loss: 4.5425 - acc: 0.051019/64 [=======>......................] - ETA: 1:20 - loss: 4.5426 - acc: 0.051420/64 [========>.....................] - ETA: 1:16 - loss: 4.5375 - acc: 0.051721/64 [========>.....................] - ETA: 1:13 - loss: 4.5387 - acc: 0.050922/64 [=========>....................] - ETA: 1:10 - loss: 4.5423 - acc: 0.050023/64 [=========>....................] - ETA: 1:07 - loss: 4.5417 - acc: 0.049924/64 [==========>...................] - ETA: 1:05 - loss: 4.5395 - acc: 0.050525/64 [==========>...................] - ETA: 1:02 - loss: 4.5383 - acc: 0.050926/64 [===========>..................] - ETA: 1:00 - loss: 4.5355 - acc: 0.050627/64 [===========>..................] - ETA: 58s - loss: 4.5341 - acc: 0.0506 28/64 [============>.................] - ETA: 55s - loss: 4.5353 - acc: 0.049929/64 [============>.................] - ETA: 53s - loss: 4.5390 - acc: 0.049630/64 [=============>................] - ETA: 51s - loss: 4.5391 - acc: 0.049531/64 [=============>................] - ETA: 49s - loss: 4.5371 - acc: 0.050032/64 [==============>...............] - ETA: 47s - loss: 4.5372 - acc: 0.050033/64 [==============>...............] - ETA: 45s - loss: 4.5347 - acc: 0.050034/64 [==============>...............] - ETA: 43s - loss: 4.5342 - acc: 0.049735/64 [===============>..............] - ETA: 42s - loss: 4.5329 - acc: 0.050036/64 [===============>..............] - ETA: 40s - loss: 4.5320 - acc: 0.050237/64 [================>.............] - ETA: 38s - loss: 4.5323 - acc: 0.050538/64 [================>.............] - ETA: 36s - loss: 4.5308 - acc: 0.051039/64 [=================>............] - ETA: 35s - loss: 4.5300 - acc: 0.051040/64 [=================>............] - ETA: 33s - loss: 4.5277 - acc: 0.051141/64 [==================>...........] - ETA: 32s - loss: 4.5264 - acc: 0.051042/64 [==================>...........] - ETA: 30s - loss: 4.5254 - acc: 0.050943/64 [===================>..........] - ETA: 29s - loss: 4.5228 - acc: 0.051244/64 [===================>..........] - ETA: 27s - loss: 4.5209 - acc: 0.051345/64 [====================>.........] - ETA: 26s - loss: 4.5194 - acc: 0.051146/64 [====================>.........] - ETA: 24s - loss: 4.5211 - acc: 0.050647/64 [=====================>........] - ETA: 23s - loss: 4.5210 - acc: 0.050448/64 [=====================>........] - ETA: 21s - loss: 4.5205 - acc: 0.050449/64 [=====================>........] - ETA: 20s - loss: 4.5188 - acc: 0.050650/64 [======================>.......] - ETA: 18s - loss: 4.5169 - acc: 0.050851/64 [======================>.......] - ETA: 17s - loss: 4.5157 - acc: 0.050652/64 [=======================>......] - ETA: 16s - loss: 4.5158 - acc: 0.050553/64 [=======================>......] - ETA: 14s - loss: 4.5154 - acc: 0.050354/64 [========================>.....] - ETA: 13s - loss: 4.5156 - acc: 0.050155/64 [========================>.....] - ETA: 11s - loss: 4.5147 - acc: 0.050356/64 [=========================>....] - ETA: 10s - loss: 4.5146 - acc: 0.050357/64 [=========================>....] - ETA: 9s - loss: 4.5137 - acc: 0.0502 58/64 [==========================>...] - ETA: 8s - loss: 4.5117 - acc: 0.050359/64 [==========================>...] - ETA: 6s - loss: 4.5109 - acc: 0.050360/64 [===========================>..] - ETA: 5s - loss: 4.5098 - acc: 0.050461/64 [===========================>..] - ETA: 3s - loss: 4.5090 - acc: 0.050662/64 [============================>.] - ETA: 2s - loss: 4.5088 - acc: 0.050763/64 [============================>.] - ETA: 1s - loss: 4.5074 - acc: 0.051064/64 [==============================] - 84s 1s/step - loss: 4.5064 - acc: 0.0509
Finished Epoch 0
