WARNING:tensorflow:From ../run_training.py:27: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

WARNING:tensorflow:From ../run_training.py:27: The name tf.ConfigProto is deprecated. Please use tf.compat.v1.ConfigProto instead.

WARNING:tensorflow:From ../run_training.py:27: The name tf.GPUOptions is deprecated. Please use tf.compat.v1.GPUOptions instead.

WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1630: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
1 Physical GPUs, 1 Logical GPUs
Parsing arguments: [('batch_size', 20), ('epochs', 1), ('model_name', 'vgg_unet'), ('strategy', 'capuchin'), ('verbose', False)]
Cannot find config for batch_size=20, use 40 instead
There are 367 and 367 images downloaded for train and test
Verifying train dataset
  0%|          | 0/367 [00:00<?, ?it/s]  4%|▎         | 13/367 [00:00<00:02, 124.53it/s]  7%|▋         | 26/367 [00:00<00:02, 125.05it/s] 11%|█         | 39/367 [00:00<00:02, 125.91it/s] 14%|█▍        | 53/367 [00:00<00:02, 128.51it/s] 18%|█▊        | 66/367 [00:00<00:02, 127.95it/s] 22%|██▏       | 81/367 [00:00<00:02, 133.19it/s] 27%|██▋       | 98/367 [00:00<00:01, 142.95it/s] 31%|███▏      | 115/367 [00:00<00:01, 149.45it/s] 36%|███▌      | 131/367 [00:00<00:01, 150.91it/s] 40%|████      | 147/367 [00:01<00:01, 153.13it/s] 45%|████▍     | 164/367 [00:01<00:01, 155.49it/s] 49%|████▉     | 180/367 [00:01<00:01, 156.67it/s] 54%|█████▎    | 197/367 [00:01<00:01, 157.79it/s] 58%|█████▊    | 214/367 [00:01<00:00, 158.31it/s] 63%|██████▎   | 230/367 [00:01<00:00, 158.03it/s] 67%|██████▋   | 246/367 [00:01<00:00, 158.40it/s] 72%|███████▏  | 263/367 [00:01<00:00, 159.41it/s] 76%|███████▌  | 279/367 [00:01<00:00, 159.45it/s] 80%|████████  | 295/367 [00:01<00:00, 159.52it/s] 85%|████████▌ | 312/367 [00:02<00:00, 160.32it/s] 90%|████████▉ | 329/367 [00:02<00:00, 161.66it/s] 94%|█████████▍| 346/367 [00:02<00:00, 160.02it/s] 99%|█████████▉| 363/367 [00:02<00:00, 159.67it/s]100%|██████████| 367/367 [00:02<00:00, 152.13it/s]
WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/stropt/lms.py:970: The name tf.train.SessionRunHook is deprecated. Please use tf.estimator.SessionRunHook instead.

WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/stropt/str_strategy.py:122: get_backward_walk_ops (from tensorflow.contrib.graph_editor.select) is deprecated and will be removed after 2019-06-06.
Instructions for updating:
Please use tensorflow.python.ops.op_selector.get_backward_walk_ops.
WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/math_grad.py:1424: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/stropt/lms.py:928: The name tf.logging.info is deprecated. Please use tf.compat.v1.logging.info instead.

Dataset verified! 
Starting Epoch  0
[STR DEBUG] Parsing STR configuration: [{'strategy': 'hybrid', 'verbose': 'false', 'tags': '/home/zongzan/dist_dnn_training/STR/optimizer/logs/vgg_unet_40/layer_names'}, {'r': '/home/zongzan/dist_dnn_training/STR/optimizer/logs/vgg_unet_40/R-capuchin', 'p': '/home/zongzan/dist_dnn_training/STR/optimizer/logs/vgg_unet_40/P-capuchin', 'q': '/home/zongzan/dist_dnn_training/STR/optimizer/logs/vgg_unet_40/Q-capuchin'}]
[STR DEBUG] Processing layer 28's swapping, swap out at [30], swap in at [41]
[STR DEBUG] Cannot find swap-out activation nodes for layer 28 among [<tf.Operation 'up_sampling2d_2/strided_slice' type=StridedSlice>, <tf.Operation 'up_sampling2d_2/mul' type=Mul>, <tf.Operation 'up_sampling2d_2/resize/ResizeNearestNeighbor' type=ResizeNearestNeighbor>, <tf.Operation 'up_sampling2d_2/strided_slice/stack_2' type=Const>, <tf.Operation 'up_sampling2d_2/strided_slice/stack_1' type=Const>, <tf.Operation 'up_sampling2d_2/Const' type=Const>, <tf.Operation 'up_sampling2d_2/Shape' type=Shape>, <tf.Operation 'up_sampling2d_2/strided_slice/stack' type=Const>]
[STR DEBUG] Processing layer 29's swapping, swap out at [31], swap in at [40]
[STR DEBUG] Cannot find swap-out activation nodes for layer 29 among [<tf.Operation 'concatenate_2/concat/axis' type=Const>, <tf.Operation 'concatenate_2/concat' type=ConcatV2>]
[STR DEBUG] Processing layer 31's swapping, swap out at [34], swap in at [38]
[STR DEBUG] Cannot find swap-out activation nodes for layer 31 among [<tf.Operation 'conv2d_3/kernel/IsInitialized/VarIsInitializedOp' type=VarIsInitializedOp>, <tf.Operation 'conv2d_3/kernel/Read/ReadVariableOp' type=ReadVariableOp>, <tf.Operation 'conv2d_3/kernel/Assign' type=AssignVariableOp>, <tf.Operation 'conv2d_3/bias/Initializer/zeros' type=Const>, <tf.Operation 'conv2d_3/bias' type=VarHandleOp>, <tf.Operation 'conv2d_3/bias/IsInitialized/VarIsInitializedOp' type=VarIsInitializedOp>, <tf.Operation 'conv2d_3/Conv2D' type=Conv2D>, <tf.Operation 'conv2d_3/bias/Read/ReadVariableOp' type=ReadVariableOp>, <tf.Operation 'conv2d_3/bias/Assign' type=AssignVariableOp>, <tf.Operation 'conv2d_3/BiasAdd' type=BiasAdd>, <tf.Operation 'conv2d_3/BiasAdd/ReadVariableOp' type=ReadVariableOp>, <tf.Operation 'conv2d_3/Conv2D/ReadVariableOp' type=ReadVariableOp>, <tf.Operation 'conv2d_3/dilation_rate' type=Const>, <tf.Operation 'conv2d_3/kernel/Initializer/random_uniform/shape' type=Const>, <tf.Operation 'conv2d_3/kernel/Initializer/random_uniform/min' type=Const>, <tf.Operation 'conv2d_3/kernel' type=VarHandleOp>, <tf.Operation 'conv2d_3/kernel/Initializer/random_uniform/max' type=Const>, <tf.Operation 'conv2d_3/kernel/Initializer/random_uniform/RandomUniform' type=RandomUniform>, <tf.Operation 'conv2d_3/kernel/Initializer/random_uniform/sub' type=Sub>, <tf.Operation 'conv2d_3/kernel/Initializer/random_uniform/mul' type=Mul>, <tf.Operation 'conv2d_3/kernel/Initializer/random_uniform' type=Add>]
[STR DEBUG] Processing layer 33's swapping, swap out at [35], swap in at [36]
[STR DEBUG] Cannot find swap-out activation nodes for layer 33 among [<tf.Operation 'conv2d_4/kernel/Assign' type=AssignVariableOp>, <tf.Operation 'conv2d_4/bias/Initializer/zeros' type=Const>, <tf.Operation 'conv2d_4/bias' type=VarHandleOp>, <tf.Operation 'conv2d_4/bias/IsInitialized/VarIsInitializedOp' type=VarIsInitializedOp>, <tf.Operation 'conv2d_4/Conv2D' type=Conv2D>, <tf.Operation 'conv2d_4/bias/Read/ReadVariableOp' type=ReadVariableOp>, <tf.Operation 'conv2d_4/bias/Assign' type=AssignVariableOp>, <tf.Operation 'conv2d_4/BiasAdd' type=BiasAdd>, <tf.Operation 'conv2d_4/BiasAdd/ReadVariableOp' type=ReadVariableOp>, <tf.Operation 'conv2d_4/Conv2D/ReadVariableOp' type=ReadVariableOp>, <tf.Operation 'conv2d_4/kernel/Initializer/random_uniform/shape' type=Const>, <tf.Operation 'conv2d_4/kernel/Initializer/random_uniform/min' type=Const>, <tf.Operation 'conv2d_4/kernel' type=VarHandleOp>, <tf.Operation 'conv2d_4/kernel/Initializer/random_uniform/max' type=Const>, <tf.Operation 'conv2d_4/kernel/Initializer/random_uniform/RandomUniform' type=RandomUniform>, <tf.Operation 'conv2d_4/kernel/Initializer/random_uniform/sub' type=Sub>, <tf.Operation 'conv2d_4/kernel/Initializer/random_uniform' type=Add>, <tf.Operation 'conv2d_4/kernel/Initializer/random_uniform/mul' type=Mul>, <tf.Operation 'conv2d_4/kernel/IsInitialized/VarIsInitializedOp' type=VarIsInitializedOp>, <tf.Operation 'conv2d_4/kernel/Read/ReadVariableOp' type=ReadVariableOp>, <tf.Operation 'conv2d_4/dilation_rate' type=Const>]
 1/64 [..............................] - ETA: 18:09 - loss: 4.3786 - acc: 0.0072 2/64 [..............................] - ETA: 9:43 - loss: 4.3697 - acc: 0.0068  3/64 [>.............................] - ETA: 7:08 - loss: 4.3614 - acc: 0.0066 4/64 [>.............................] - ETA: 5:50 - loss: 4.3652 - acc: 0.0065 5/64 [=>............................] - ETA: 5:01 - loss: 4.3652 - acc: 0.0064 6/64 [=>............................] - ETA: 4:29 - loss: 4.3648 - acc: 0.0064 7/64 [==>...........................] - ETA: 4:04 - loss: 4.3655 - acc: 0.0064 8/64 [==>...........................] - ETA: 3:43 - loss: 4.3661 - acc: 0.0067 9/64 [===>..........................] - ETA: 3:25 - loss: 4.3700 - acc: 0.006610/64 [===>..........................] - ETA: 3:10 - loss: 4.3690 - acc: 0.006711/64 [====>.........................] - ETA: 2:58 - loss: 4.3699 - acc: 0.006512/64 [====>.........................] - ETA: 2:47 - loss: 4.3685 - acc: 0.006513/64 [=====>........................] - ETA: 2:39 - loss: 4.3698 - acc: 0.006414/64 [=====>........................] - ETA: 2:32 - loss: 4.3719 - acc: 0.006415/64 [======>.......................] - ETA: 2:26 - loss: 4.3678 - acc: 0.006516/64 [======>.......................] - ETA: 2:19 - loss: 4.3655 - acc: 0.006617/64 [======>.......................] - ETA: 2:14 - loss: 4.3650 - acc: 0.006618/64 [=======>......................] - ETA: 2:10 - loss: 4.3644 - acc: 0.006619/64 [=======>......................] - ETA: 2:06 - loss: 4.3634 - acc: 0.006620/64 [========>.....................] - ETA: 2:01 - loss: 4.3611 - acc: 0.006621/64 [========>.....................] - ETA: 1:56 - loss: 4.3590 - acc: 0.006722/64 [=========>....................] - ETA: 1:52 - loss: 4.3589 - acc: 0.006623/64 [=========>....................] - ETA: 1:47 - loss: 4.3568 - acc: 0.006624/64 [==========>...................] - ETA: 1:44 - loss: 4.3564 - acc: 0.006625/64 [==========>...................] - ETA: 1:40 - loss: 4.3553 - acc: 0.006626/64 [===========>..................] - ETA: 1:37 - loss: 4.3545 - acc: 0.006727/64 [===========>..................] - ETA: 1:33 - loss: 4.3545 - acc: 0.006728/64 [============>.................] - ETA: 1:30 - loss: 4.3544 - acc: 0.006729/64 [============>.................] - ETA: 1:27 - loss: 4.3549 - acc: 0.006730/64 [=============>................] - ETA: 1:24 - loss: 4.3539 - acc: 0.006731/64 [=============>................] - ETA: 1:21 - loss: 4.3528 - acc: 0.006732/64 [==============>...............] - ETA: 1:18 - loss: 4.3533 - acc: 0.006733/64 [==============>...............] - ETA: 1:15 - loss: 4.3522 - acc: 0.006734/64 [==============>...............] - ETA: 1:12 - loss: 4.3502 - acc: 0.006835/64 [===============>..............] - ETA: 1:09 - loss: 4.3502 - acc: 0.006836/64 [===============>..............] - ETA: 1:07 - loss: 4.3494 - acc: 0.006837/64 [================>.............] - ETA: 1:04 - loss: 4.3484 - acc: 0.006838/64 [================>.............] - ETA: 1:01 - loss: 4.3461 - acc: 0.006839/64 [=================>............] - ETA: 58s - loss: 4.3457 - acc: 0.0068 40/64 [=================>............] - ETA: 55s - loss: 4.3451 - acc: 0.006841/64 [==================>...........] - ETA: 53s - loss: 4.3434 - acc: 0.006842/64 [==================>...........] - ETA: 51s - loss: 4.3429 - acc: 0.006843/64 [===================>..........] - ETA: 48s - loss: 4.3420 - acc: 0.006844/64 [===================>..........] - ETA: 45s - loss: 4.3410 - acc: 0.006945/64 [====================>.........] - ETA: 43s - loss: 4.3405 - acc: 0.006946/64 [====================>.........] - ETA: 41s - loss: 4.3404 - acc: 0.006947/64 [=====================>........] - ETA: 38s - loss: 4.3397 - acc: 0.006948/64 [=====================>........] - ETA: 36s - loss: 4.3395 - acc: 0.006949/64 [=====================>........] - ETA: 33s - loss: 4.3380 - acc: 0.006950/64 [======================>.......] - ETA: 31s - loss: 4.3381 - acc: 0.006951/64 [======================>.......] - ETA: 29s - loss: 4.3374 - acc: 0.006952/64 [=======================>......] - ETA: 26s - loss: 4.3356 - acc: 0.007053/64 [=======================>......] - ETA: 24s - loss: 4.3347 - acc: 0.007054/64 [========================>.....] - ETA: 22s - loss: 4.3342 - acc: 0.007055/64 [========================>.....] - ETA: 19s - loss: 4.3331 - acc: 0.007056/64 [=========================>....] - ETA: 17s - loss: 4.3324 - acc: 0.007057/64 [=========================>....] - ETA: 15s - loss: 4.3311 - acc: 0.007158/64 [==========================>...] - ETA: 12s - loss: 4.3299 - acc: 0.007159/64 [==========================>...] - ETA: 10s - loss: 4.3291 - acc: 0.007160/64 [===========================>..] - ETA: 8s - loss: 4.3282 - acc: 0.0071 61/64 [===========================>..] - ETA: 6s - loss: 4.3273 - acc: 0.007162/64 [============================>.] - ETA: 4s - loss: 4.3264 - acc: 0.007163/64 [============================>.] - ETA: 2s - loss: 4.3259 - acc: 0.007164/64 [==============================] - 136s 2s/step - loss: 4.3254 - acc: 0.0072
Finished Epoch 0
