WARNING:tensorflow:From ../run_training.py:27: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

WARNING:tensorflow:From ../run_training.py:27: The name tf.ConfigProto is deprecated. Please use tf.compat.v1.ConfigProto instead.

WARNING:tensorflow:From ../run_training.py:27: The name tf.GPUOptions is deprecated. Please use tf.compat.v1.GPUOptions instead.

WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1630: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
1 Physical GPUs, 1 Logical GPUs
Parsing arguments: [('batch_size', 15), ('epochs', 1), ('model_name', 'vgg_unet'), ('strategy', 'dynprog'), ('verbose', False)]
Cannot find config for batch_size=15, use 40 instead
There are 367 and 367 images downloaded for train and test
Verifying train dataset
  0%|          | 0/367 [00:00<?, ?it/s]  4%|▎         | 13/367 [00:00<00:02, 124.39it/s]  7%|▋         | 26/367 [00:00<00:02, 126.18it/s] 11%|█         | 39/367 [00:00<00:02, 127.03it/s] 14%|█▍        | 53/367 [00:00<00:02, 129.17it/s] 18%|█▊        | 67/367 [00:00<00:02, 130.35it/s] 23%|██▎       | 84/367 [00:00<00:02, 141.10it/s] 28%|██▊       | 101/367 [00:00<00:01, 148.77it/s] 32%|███▏      | 117/367 [00:00<00:01, 152.07it/s] 36%|███▌      | 133/367 [00:00<00:01, 154.07it/s] 41%|████      | 149/367 [00:01<00:01, 146.19it/s] 45%|████▍     | 165/367 [00:01<00:01, 148.43it/s] 49%|████▉     | 181/367 [00:01<00:01, 151.12it/s] 54%|█████▎    | 197/367 [00:01<00:01, 152.59it/s] 58%|█████▊    | 213/367 [00:01<00:01, 152.87it/s] 62%|██████▏   | 229/367 [00:01<00:00, 152.87it/s] 67%|██████▋   | 245/367 [00:01<00:00, 152.70it/s] 71%|███████   | 261/367 [00:01<00:00, 153.91it/s] 75%|███████▌  | 277/367 [00:01<00:00, 153.84it/s] 80%|████████  | 294/367 [00:01<00:00, 155.77it/s] 84%|████████▍ | 310/367 [00:02<00:00, 156.04it/s] 89%|████████▉ | 327/367 [00:02<00:00, 158.85it/s] 93%|█████████▎| 343/367 [00:02<00:00, 159.11it/s] 98%|█████████▊| 359/367 [00:02<00:00, 158.38it/s]100%|██████████| 367/367 [00:02<00:00, 150.28it/s]
WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/stropt/lms.py:970: The name tf.train.SessionRunHook is deprecated. Please use tf.estimator.SessionRunHook instead.

WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/math_grad.py:1424: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/stropt/lms.py:928: The name tf.logging.info is deprecated. Please use tf.compat.v1.logging.info instead.

WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/contrib/graph_editor/select.py:554: get_backward_walk_ops (from tensorflow.contrib.graph_editor.select) is deprecated and will be removed after 2019-06-06.
Instructions for updating:
Please use tensorflow.python.ops.op_selector.get_backward_walk_ops.
Dataset verified! 
Starting Epoch  0
[STR DEBUG] Parsing STR configuration: [{'strategy': 'swap', 'verbose': 'true', 'tags': '/home/zongzan/dist_dnn_training/STR/optimizer/logs/VGG16_250/layer_names'}, {'p': '/home/zongzan/dist_dnn_training/STR/optimizer/logs/VGG16_250/P-dynprog', 'q': '/home/zongzan/dist_dnn_training/STR/optimizer/logs/VGG16_250/Q-dynprog'}]
[STR DEBUG] Use swap strategy of DYNPROG
[STR DEBUG] Processing layer 2's swapping, swap out at [3], swap in at [41]
[STR DEBUG] Find swapout ops: name: "block1_conv2/Relu"
op: "Relu"
input: "block1_conv2/BiasAdd"
attr {
  key: "T"
  value {
    type: DT_FLOAT
  }
}
, 
	choose swap tensor Tensor("block1_conv2/Relu:0", shape=(?, 320, 640, 64), dtype=float32), 
	finish at the end of ops: [<tf.Operation 'block1_pool/MaxPool' type=MaxPool>]
[STR DEBUG] Add swap-in op at name: "training/Adadelta/gradients/gradients/block1_pool/MaxPool_grad/MaxPoolGrad"
op: "MaxPoolGrad"
input: "block1_conv2/Relu"
input: "block1_pool/MaxPool"
input: "training/Adadelta/gradients/gradients/AddN_17"
attr {
  key: "T"
  value {
    type: DT_FLOAT
  }
}
attr {
  key: "data_format"
  value {
    s: "NHWC"
  }
}
attr {
  key: "ksize"
  value {
    list {
      i: 1
      i: 2
      i: 2
      i: 1
    }
  }
}
attr {
  key: "padding"
  value {
    s: "VALID"
  }
}
attr {
  key: "strides"
  value {
    list {
      i: 1
      i: 2
      i: 2
      i: 1
    }
  }
}
 for consumer [<tf.Operation 'training/Adadelta/gradients/gradients/block1_conv2/Relu_grad/ReluGrad' type=ReluGrad>]
[STR DEBUG] Processing layer 5's swapping, swap out at [6], swap in at [38]
[STR DEBUG] Find swapout ops: name: "block2_conv2/Relu"
op: "Relu"
input: "block2_conv2/BiasAdd"
attr {
  key: "T"
  value {
    type: DT_FLOAT
  }
}
, 
	choose swap tensor Tensor("block2_conv2/Relu:0", shape=(?, 160, 320, 128), dtype=float32), 
	finish at the end of ops: [<tf.Operation 'block2_pool/MaxPool' type=MaxPool>]
[STR DEBUG] Add swap-in op at name: "training/Adadelta/gradients/gradients/block2_pool/MaxPool_grad/MaxPoolGrad"
op: "MaxPoolGrad"
input: "block2_conv2/Relu"
input: "block2_pool/MaxPool"
input: "training/Adadelta/gradients/gradients/AddN_16"
attr {
  key: "T"
  value {
    type: DT_FLOAT
  }
}
attr {
  key: "data_format"
  value {
    s: "NHWC"
  }
}
attr {
  key: "ksize"
  value {
    list {
      i: 1
      i: 2
      i: 2
      i: 1
    }
  }
}
attr {
  key: "padding"
  value {
    s: "VALID"
  }
}
attr {
  key: "strides"
  value {
    list {
      i: 1
      i: 2
      i: 2
      i: 1
    }
  }
}
 for consumer [<tf.Operation 'training/Adadelta/gradients/gradients/block2_conv2/Relu_grad/ReluGrad' type=ReluGrad>]
 1/64 [..............................] - ETA: 14:48 - loss: 4.2725 - acc: 0.0314 2/64 [..............................] - ETA: 7:49 - loss: 4.2102 - acc: 0.0313  3/64 [>.............................] - ETA: 5:29 - loss: 4.2223 - acc: 0.0291 4/64 [>.............................] - ETA: 4:19 - loss: 4.2207 - acc: 0.0278 5/64 [=>............................] - ETA: 3:36 - loss: 4.2339 - acc: 0.0266 6/64 [=>............................] - ETA: 3:07 - loss: 4.2276 - acc: 0.0263 7/64 [==>...........................] - ETA: 2:47 - loss: 4.2267 - acc: 0.0264 8/64 [==>...........................] - ETA: 2:31 - loss: 4.2202 - acc: 0.0270 9/64 [===>..........................] - ETA: 2:18 - loss: 4.2178 - acc: 0.027710/64 [===>..........................] - ETA: 2:07 - loss: 4.2133 - acc: 0.028011/64 [====>.........................] - ETA: 1:59 - loss: 4.2132 - acc: 0.028812/64 [====>.........................] - ETA: 1:51 - loss: 4.2194 - acc: 0.029713/64 [=====>........................] - ETA: 1:45 - loss: 4.2226 - acc: 0.029414/64 [=====>........................] - ETA: 1:39 - loss: 4.2244 - acc: 0.029815/64 [======>.......................] - ETA: 1:34 - loss: 4.2256 - acc: 0.030116/64 [======>.......................] - ETA: 1:29 - loss: 4.2226 - acc: 0.030617/64 [======>.......................] - ETA: 1:25 - loss: 4.2276 - acc: 0.030918/64 [=======>......................] - ETA: 1:22 - loss: 4.2236 - acc: 0.031119/64 [=======>......................] - ETA: 1:18 - loss: 4.2245 - acc: 0.031220/64 [========>.....................] - ETA: 1:15 - loss: 4.2208 - acc: 0.031621/64 [========>.....................] - ETA: 1:12 - loss: 4.2199 - acc: 0.031522/64 [=========>....................] - ETA: 1:09 - loss: 4.2212 - acc: 0.031923/64 [=========>....................] - ETA: 1:07 - loss: 4.2210 - acc: 0.032024/64 [==========>...................] - ETA: 1:04 - loss: 4.2193 - acc: 0.032425/64 [==========>...................] - ETA: 1:02 - loss: 4.2196 - acc: 0.032726/64 [===========>..................] - ETA: 1:00 - loss: 4.2167 - acc: 0.033127/64 [===========>..................] - ETA: 57s - loss: 4.2141 - acc: 0.0333 28/64 [============>.................] - ETA: 56s - loss: 4.2132 - acc: 0.033429/64 [============>.................] - ETA: 53s - loss: 4.2150 - acc: 0.033130/64 [=============>................] - ETA: 51s - loss: 4.2146 - acc: 0.033031/64 [=============>................] - ETA: 49s - loss: 4.2129 - acc: 0.033232/64 [==============>...............] - ETA: 48s - loss: 4.2120 - acc: 0.033333/64 [==============>...............] - ETA: 46s - loss: 4.2092 - acc: 0.033734/64 [==============>...............] - ETA: 44s - loss: 4.2069 - acc: 0.034135/64 [===============>..............] - ETA: 42s - loss: 4.2057 - acc: 0.034536/64 [===============>..............] - ETA: 40s - loss: 4.2058 - acc: 0.034837/64 [================>.............] - ETA: 39s - loss: 4.2075 - acc: 0.035038/64 [================>.............] - ETA: 37s - loss: 4.2089 - acc: 0.035139/64 [=================>............] - ETA: 35s - loss: 4.2085 - acc: 0.035340/64 [=================>............] - ETA: 34s - loss: 4.2078 - acc: 0.035741/64 [==================>...........] - ETA: 32s - loss: 4.2076 - acc: 0.036342/64 [==================>...........] - ETA: 30s - loss: 4.2075 - acc: 0.036343/64 [===================>..........] - ETA: 29s - loss: 4.2078 - acc: 0.036544/64 [===================>..........] - ETA: 27s - loss: 4.2054 - acc: 0.036845/64 [====================>.........] - ETA: 26s - loss: 4.2038 - acc: 0.037046/64 [====================>.........] - ETA: 24s - loss: 4.2044 - acc: 0.037247/64 [=====================>........] - ETA: 23s - loss: 4.2040 - acc: 0.037648/64 [=====================>........] - ETA: 21s - loss: 4.2031 - acc: 0.037849/64 [=====================>........] - ETA: 20s - loss: 4.2017 - acc: 0.038250/64 [======================>.......] - ETA: 18s - loss: 4.2018 - acc: 0.038751/64 [======================>.......] - ETA: 17s - loss: 4.1996 - acc: 0.039052/64 [=======================>......] - ETA: 15s - loss: 4.1991 - acc: 0.039153/64 [=======================>......] - ETA: 14s - loss: 4.1982 - acc: 0.039454/64 [========================>.....] - ETA: 13s - loss: 4.1983 - acc: 0.039455/64 [========================>.....] - ETA: 11s - loss: 4.1970 - acc: 0.039556/64 [=========================>....] - ETA: 10s - loss: 4.1964 - acc: 0.039657/64 [=========================>....] - ETA: 9s - loss: 4.1947 - acc: 0.0399 58/64 [==========================>...] - ETA: 7s - loss: 4.1933 - acc: 0.040459/64 [==========================>...] - ETA: 6s - loss: 4.1921 - acc: 0.040960/64 [===========================>..] - ETA: 5s - loss: 4.1909 - acc: 0.041461/64 [===========================>..] - ETA: 3s - loss: 4.1919 - acc: 0.041762/64 [============================>.] - ETA: 2s - loss: 4.1920 - acc: 0.041863/64 [============================>.] - ETA: 1s - loss: 4.1917 - acc: 0.042164/64 [==============================] - 82s 1s/step - loss: 4.1913 - acc: 0.0424
Finished Epoch 0
