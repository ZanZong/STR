WARNING:tensorflow:From ../run_training.py:27: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

WARNING:tensorflow:From ../run_training.py:27: The name tf.ConfigProto is deprecated. Please use tf.compat.v1.ConfigProto instead.

WARNING:tensorflow:From ../run_training.py:27: The name tf.GPUOptions is deprecated. Please use tf.compat.v1.GPUOptions instead.

WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1630: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
1 Physical GPUs, 1 Logical GPUs
Parsing arguments: [('batch_size', 20), ('epochs', 1), ('model_name', 'vgg_unet'), ('strategy', 'dynprog'), ('verbose', False)]
Cannot find config for batch_size=20, use 40 instead
There are 367 and 367 images downloaded for train and test
Verifying train dataset
  0%|          | 0/367 [00:00<?, ?it/s]  4%|▎         | 13/367 [00:00<00:02, 124.36it/s]  7%|▋         | 26/367 [00:00<00:02, 126.06it/s] 11%|█         | 39/367 [00:00<00:02, 127.25it/s] 14%|█▍        | 53/367 [00:00<00:02, 130.68it/s] 19%|█▉        | 69/367 [00:00<00:02, 140.24it/s] 23%|██▎       | 86/367 [00:00<00:01, 147.31it/s] 28%|██▊       | 103/367 [00:00<00:01, 152.99it/s] 32%|███▏      | 119/367 [00:00<00:01, 154.02it/s] 37%|███▋      | 135/367 [00:00<00:01, 155.24it/s] 41%|████      | 151/367 [00:01<00:01, 156.40it/s] 46%|████▌     | 167/367 [00:01<00:01, 156.94it/s] 50%|█████     | 184/367 [00:01<00:01, 158.14it/s] 54%|█████▍    | 200/367 [00:01<00:01, 158.62it/s] 59%|█████▉    | 216/367 [00:01<00:00, 158.10it/s] 63%|██████▎   | 232/367 [00:01<00:00, 158.38it/s] 68%|██████▊   | 248/367 [00:01<00:00, 158.51it/s] 72%|███████▏  | 265/367 [00:01<00:00, 159.91it/s] 77%|███████▋  | 281/367 [00:01<00:00, 159.46it/s] 81%|████████  | 298/367 [00:01<00:00, 160.00it/s] 86%|████████▌ | 314/367 [00:02<00:00, 159.70it/s] 90%|█████████ | 331/367 [00:02<00:00, 160.25it/s] 95%|█████████▍| 348/367 [00:02<00:00, 159.34it/s] 99%|█████████▉| 364/367 [00:02<00:00, 159.13it/s]100%|██████████| 367/367 [00:02<00:00, 154.18it/s]
WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/stropt/lms.py:970: The name tf.train.SessionRunHook is deprecated. Please use tf.estimator.SessionRunHook instead.

WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/math_grad.py:1424: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/stropt/lms.py:928: The name tf.logging.info is deprecated. Please use tf.compat.v1.logging.info instead.

WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/contrib/graph_editor/select.py:554: get_backward_walk_ops (from tensorflow.contrib.graph_editor.select) is deprecated and will be removed after 2019-06-06.
Instructions for updating:
Please use tensorflow.python.ops.op_selector.get_backward_walk_ops.
Dataset verified! 
Starting Epoch  0
[STR DEBUG] Parsing STR configuration: [{'strategy': 'swap', 'verbose': 'true', 'tags': '/home/zongzan/dist_dnn_training/STR/optimizer/logs/VGG16_250/layer_names'}, {'p': '/home/zongzan/dist_dnn_training/STR/optimizer/logs/VGG16_250/P-dynprog', 'q': '/home/zongzan/dist_dnn_training/STR/optimizer/logs/VGG16_250/Q-dynprog'}]
[STR DEBUG] Use swap strategy of DYNPROG
[STR DEBUG] Processing layer 2's swapping, swap out at [3], swap in at [41]
[STR DEBUG] Find swapout ops: name: "block1_conv2/Relu"
op: "Relu"
input: "block1_conv2/BiasAdd"
attr {
  key: "T"
  value {
    type: DT_FLOAT
  }
}
, 
	choose swap tensor Tensor("block1_conv2/Relu:0", shape=(?, 320, 640, 64), dtype=float32), 
	finish at the end of ops: [<tf.Operation 'block1_pool/MaxPool' type=MaxPool>]
[STR DEBUG] Add swap-in op at name: "training/Adadelta/gradients/gradients/block1_pool/MaxPool_grad/MaxPoolGrad"
op: "MaxPoolGrad"
input: "block1_conv2/Relu"
input: "block1_pool/MaxPool"
input: "training/Adadelta/gradients/gradients/AddN_17"
attr {
  key: "T"
  value {
    type: DT_FLOAT
  }
}
attr {
  key: "data_format"
  value {
    s: "NHWC"
  }
}
attr {
  key: "ksize"
  value {
    list {
      i: 1
      i: 2
      i: 2
      i: 1
    }
  }
}
attr {
  key: "padding"
  value {
    s: "VALID"
  }
}
attr {
  key: "strides"
  value {
    list {
      i: 1
      i: 2
      i: 2
      i: 1
    }
  }
}
 for consumer [<tf.Operation 'training/Adadelta/gradients/gradients/block1_conv2/Relu_grad/ReluGrad' type=ReluGrad>]
[STR DEBUG] Processing layer 5's swapping, swap out at [6], swap in at [38]
[STR DEBUG] Find swapout ops: name: "block2_conv2/Relu"
op: "Relu"
input: "block2_conv2/BiasAdd"
attr {
  key: "T"
  value {
    type: DT_FLOAT
  }
}
, 
	choose swap tensor Tensor("block2_conv2/Relu:0", shape=(?, 160, 320, 128), dtype=float32), 
	finish at the end of ops: [<tf.Operation 'block2_pool/MaxPool' type=MaxPool>]
[STR DEBUG] Add swap-in op at name: "training/Adadelta/gradients/gradients/block2_pool/MaxPool_grad/MaxPoolGrad"
op: "MaxPoolGrad"
input: "block2_conv2/Relu"
input: "block2_pool/MaxPool"
input: "training/Adadelta/gradients/gradients/AddN_16"
attr {
  key: "T"
  value {
    type: DT_FLOAT
  }
}
attr {
  key: "data_format"
  value {
    s: "NHWC"
  }
}
attr {
  key: "ksize"
  value {
    list {
      i: 1
      i: 2
      i: 2
      i: 1
    }
  }
}
attr {
  key: "padding"
  value {
    s: "VALID"
  }
}
attr {
  key: "strides"
  value {
    list {
      i: 1
      i: 2
      i: 2
      i: 1
    }
  }
}
 for consumer [<tf.Operation 'training/Adadelta/gradients/gradients/block2_conv2/Relu_grad/ReluGrad' type=ReluGrad>]
 1/64 [..............................] - ETA: 17:12 - loss: 4.5195 - acc: 0.0082 2/64 [..............................] - ETA: 9:15 - loss: 4.5069 - acc: 0.0090  3/64 [>.............................] - ETA: 6:34 - loss: 4.5140 - acc: 0.0088 4/64 [>.............................] - ETA: 5:13 - loss: 4.5048 - acc: 0.0087 5/64 [=>............................] - ETA: 4:24 - loss: 4.4979 - acc: 0.0089 6/64 [=>............................] - ETA: 3:51 - loss: 4.4898 - acc: 0.0090 7/64 [==>...........................] - ETA: 3:27 - loss: 4.4895 - acc: 0.0091 8/64 [==>...........................] - ETA: 3:08 - loss: 4.4896 - acc: 0.0092 9/64 [===>..........................] - ETA: 2:53 - loss: 4.4883 - acc: 0.009110/64 [===>..........................] - ETA: 2:41 - loss: 4.4896 - acc: 0.008911/64 [====>.........................] - ETA: 2:31 - loss: 4.4881 - acc: 0.008912/64 [====>.........................] - ETA: 2:22 - loss: 4.4937 - acc: 0.008713/64 [=====>........................] - ETA: 2:14 - loss: 4.4945 - acc: 0.008714/64 [=====>........................] - ETA: 2:07 - loss: 4.4938 - acc: 0.008715/64 [======>.......................] - ETA: 2:01 - loss: 4.4940 - acc: 0.008816/64 [======>.......................] - ETA: 1:56 - loss: 4.4929 - acc: 0.008917/64 [======>.......................] - ETA: 1:51 - loss: 4.4930 - acc: 0.008918/64 [=======>......................] - ETA: 1:46 - loss: 4.4906 - acc: 0.009019/64 [=======>......................] - ETA: 1:42 - loss: 4.4896 - acc: 0.008920/64 [========>.....................] - ETA: 1:38 - loss: 4.4896 - acc: 0.009021/64 [========>.....................] - ETA: 1:34 - loss: 4.4905 - acc: 0.009022/64 [=========>....................] - ETA: 1:31 - loss: 4.4889 - acc: 0.008923/64 [=========>....................] - ETA: 1:27 - loss: 4.4874 - acc: 0.009024/64 [==========>...................] - ETA: 1:24 - loss: 4.4845 - acc: 0.009025/64 [==========>...................] - ETA: 1:21 - loss: 4.4834 - acc: 0.009126/64 [===========>..................] - ETA: 1:18 - loss: 4.4823 - acc: 0.009127/64 [===========>..................] - ETA: 1:15 - loss: 4.4813 - acc: 0.009228/64 [============>.................] - ETA: 1:13 - loss: 4.4811 - acc: 0.009129/64 [============>.................] - ETA: 1:10 - loss: 4.4800 - acc: 0.009130/64 [=============>................] - ETA: 1:07 - loss: 4.4810 - acc: 0.009031/64 [=============>................] - ETA: 1:05 - loss: 4.4819 - acc: 0.009032/64 [==============>...............] - ETA: 1:03 - loss: 4.4809 - acc: 0.009033/64 [==============>...............] - ETA: 1:00 - loss: 4.4805 - acc: 0.009034/64 [==============>...............] - ETA: 58s - loss: 4.4799 - acc: 0.0091 35/64 [===============>..............] - ETA: 56s - loss: 4.4786 - acc: 0.009136/64 [===============>..............] - ETA: 53s - loss: 4.4776 - acc: 0.009137/64 [================>.............] - ETA: 51s - loss: 4.4769 - acc: 0.009138/64 [================>.............] - ETA: 49s - loss: 4.4769 - acc: 0.009139/64 [=================>............] - ETA: 47s - loss: 4.4759 - acc: 0.009140/64 [=================>............] - ETA: 45s - loss: 4.4748 - acc: 0.009141/64 [==================>...........] - ETA: 43s - loss: 4.4742 - acc: 0.009142/64 [==================>...........] - ETA: 41s - loss: 4.4724 - acc: 0.009243/64 [===================>..........] - ETA: 39s - loss: 4.4714 - acc: 0.009244/64 [===================>..........] - ETA: 37s - loss: 4.4701 - acc: 0.009345/64 [====================>.........] - ETA: 35s - loss: 4.4692 - acc: 0.009346/64 [====================>.........] - ETA: 33s - loss: 4.4685 - acc: 0.009347/64 [=====================>........] - ETA: 31s - loss: 4.4680 - acc: 0.009348/64 [=====================>........] - ETA: 29s - loss: 4.4676 - acc: 0.009249/64 [=====================>........] - ETA: 27s - loss: 4.4683 - acc: 0.009250/64 [======================>.......] - ETA: 25s - loss: 4.4674 - acc: 0.009251/64 [======================>.......] - ETA: 23s - loss: 4.4668 - acc: 0.009252/64 [=======================>......] - ETA: 21s - loss: 4.4665 - acc: 0.009253/64 [=======================>......] - ETA: 19s - loss: 4.4655 - acc: 0.009354/64 [========================>.....] - ETA: 17s - loss: 4.4647 - acc: 0.009355/64 [========================>.....] - ETA: 16s - loss: 4.4637 - acc: 0.009356/64 [=========================>....] - ETA: 14s - loss: 4.4632 - acc: 0.009357/64 [=========================>....] - ETA: 12s - loss: 4.4625 - acc: 0.009358/64 [==========================>...] - ETA: 10s - loss: 4.4619 - acc: 0.009359/64 [==========================>...] - ETA: 8s - loss: 4.4611 - acc: 0.0093 60/64 [===========================>..] - ETA: 7s - loss: 4.4599 - acc: 0.009461/64 [===========================>..] - ETA: 5s - loss: 4.4585 - acc: 0.009462/64 [============================>.] - ETA: 3s - loss: 4.4575 - acc: 0.009463/64 [============================>.] - ETA: 1s - loss: 4.4565 - acc: 0.009464/64 [==============================] - 112s 2s/step - loss: 4.4559 - acc: 0.0094
Finished Epoch 0
