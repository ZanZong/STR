WARNING:tensorflow:From ../run_training.py:27: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

WARNING:tensorflow:From ../run_training.py:27: The name tf.ConfigProto is deprecated. Please use tf.compat.v1.ConfigProto instead.

WARNING:tensorflow:From ../run_training.py:27: The name tf.GPUOptions is deprecated. Please use tf.compat.v1.GPUOptions instead.

WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1630: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
1 Physical GPUs, 1 Logical GPUs
Parsing arguments: [('batch_size', 25), ('epochs', 1), ('model_name', 'vgg_unet'), ('strategy', 'dynprog'), ('verbose', False)]
Cannot find config for batch_size=25, use 40 instead
There are 367 and 367 images downloaded for train and test
Verifying train dataset
  0%|          | 0/367 [00:00<?, ?it/s]  2%|▏         | 8/367 [00:00<00:04, 75.28it/s]  5%|▌         | 20/367 [00:00<00:03, 99.08it/s]  9%|▉         | 33/367 [00:00<00:03, 111.18it/s] 13%|█▎        | 47/367 [00:00<00:02, 119.35it/s] 16%|█▋        | 60/367 [00:00<00:02, 122.44it/s] 20%|█▉        | 73/367 [00:00<00:02, 124.19it/s] 23%|██▎       | 86/367 [00:00<00:02, 125.88it/s] 27%|██▋       | 100/367 [00:00<00:02, 128.10it/s] 31%|███▏      | 115/367 [00:00<00:01, 132.81it/s] 35%|███▌      | 130/367 [00:01<00:01, 136.77it/s] 39%|███▉      | 144/367 [00:01<00:01, 120.59it/s] 43%|████▎     | 157/367 [00:01<00:01, 123.02it/s] 46%|████▋     | 170/367 [00:01<00:01, 124.88it/s] 50%|████▉     | 183/367 [00:01<00:01, 126.15it/s] 53%|█████▎    | 196/367 [00:01<00:01, 126.90it/s] 57%|█████▋    | 209/367 [00:01<00:01, 126.65it/s] 60%|██████    | 222/367 [00:01<00:01, 127.47it/s] 64%|██████▍   | 235/367 [00:01<00:01, 127.12it/s] 68%|██████▊   | 251/367 [00:01<00:00, 136.14it/s] 73%|███████▎  | 267/367 [00:02<00:00, 141.84it/s] 77%|███████▋  | 282/367 [00:02<00:00, 142.88it/s] 81%|████████  | 298/367 [00:02<00:00, 147.16it/s] 86%|████████▌ | 314/367 [00:02<00:00, 148.91it/s] 90%|█████████ | 331/367 [00:02<00:00, 153.13it/s] 95%|█████████▍| 347/367 [00:02<00:00, 154.36it/s] 99%|█████████▉| 363/367 [00:02<00:00, 155.45it/s]100%|██████████| 367/367 [00:02<00:00, 134.00it/s]
WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/stropt/lms.py:970: The name tf.train.SessionRunHook is deprecated. Please use tf.estimator.SessionRunHook instead.

WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/math_grad.py:1424: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/stropt/lms.py:928: The name tf.logging.info is deprecated. Please use tf.compat.v1.logging.info instead.

WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/contrib/graph_editor/select.py:554: get_backward_walk_ops (from tensorflow.contrib.graph_editor.select) is deprecated and will be removed after 2019-06-06.
Instructions for updating:
Please use tensorflow.python.ops.op_selector.get_backward_walk_ops.
Dataset verified! 
Starting Epoch  0
[STR DEBUG] Parsing STR configuration: [{'strategy': 'swap', 'verbose': 'true', 'tags': '/home/zongzan/dist_dnn_training/STR/optimizer/logs/VGG16_250/layer_names'}, {'p': '/home/zongzan/dist_dnn_training/STR/optimizer/logs/VGG16_250/P-dynprog', 'q': '/home/zongzan/dist_dnn_training/STR/optimizer/logs/VGG16_250/Q-dynprog'}]
[STR DEBUG] Use swap strategy of DYNPROG
[STR DEBUG] Processing layer 2's swapping, swap out at [3], swap in at [41]
[STR DEBUG] Find swapout ops: name: "block1_conv2/Relu"
op: "Relu"
input: "block1_conv2/BiasAdd"
attr {
  key: "T"
  value {
    type: DT_FLOAT
  }
}
, 
	choose swap tensor Tensor("block1_conv2/Relu:0", shape=(?, 320, 640, 64), dtype=float32), 
	finish at the end of ops: [<tf.Operation 'block1_pool/MaxPool' type=MaxPool>]
[STR DEBUG] Add swap-in op at name: "training/Adadelta/gradients/gradients/block1_pool/MaxPool_grad/MaxPoolGrad"
op: "MaxPoolGrad"
input: "block1_conv2/Relu"
input: "block1_pool/MaxPool"
input: "training/Adadelta/gradients/gradients/AddN_17"
attr {
  key: "T"
  value {
    type: DT_FLOAT
  }
}
attr {
  key: "data_format"
  value {
    s: "NHWC"
  }
}
attr {
  key: "ksize"
  value {
    list {
      i: 1
      i: 2
      i: 2
      i: 1
    }
  }
}
attr {
  key: "padding"
  value {
    s: "VALID"
  }
}
attr {
  key: "strides"
  value {
    list {
      i: 1
      i: 2
      i: 2
      i: 1
    }
  }
}
 for consumer [<tf.Operation 'training/Adadelta/gradients/gradients/block1_conv2/Relu_grad/ReluGrad' type=ReluGrad>]
[STR DEBUG] Processing layer 5's swapping, swap out at [6], swap in at [38]
[STR DEBUG] Find swapout ops: name: "block2_conv2/Relu"
op: "Relu"
input: "block2_conv2/BiasAdd"
attr {
  key: "T"
  value {
    type: DT_FLOAT
  }
}
, 
	choose swap tensor Tensor("block2_conv2/Relu:0", shape=(?, 160, 320, 128), dtype=float32), 
	finish at the end of ops: [<tf.Operation 'block2_pool/MaxPool' type=MaxPool>]
[STR DEBUG] Add swap-in op at name: "training/Adadelta/gradients/gradients/block2_pool/MaxPool_grad/MaxPoolGrad"
op: "MaxPoolGrad"
input: "block2_conv2/Relu"
input: "block2_pool/MaxPool"
input: "training/Adadelta/gradients/gradients/AddN_16"
attr {
  key: "T"
  value {
    type: DT_FLOAT
  }
}
attr {
  key: "data_format"
  value {
    s: "NHWC"
  }
}
attr {
  key: "ksize"
  value {
    list {
      i: 1
      i: 2
      i: 2
      i: 1
    }
  }
}
attr {
  key: "padding"
  value {
    s: "VALID"
  }
}
attr {
  key: "strides"
  value {
    list {
      i: 1
      i: 2
      i: 2
      i: 1
    }
  }
}
 for consumer [<tf.Operation 'training/Adadelta/gradients/gradients/block2_conv2/Relu_grad/ReluGrad' type=ReluGrad>]
 1/64 [..............................] - ETA: 18:58 - loss: 4.4323 - acc: 0.0181 2/64 [..............................] - ETA: 10:15 - loss: 4.4365 - acc: 0.0173 3/64 [>.............................] - ETA: 7:20 - loss: 4.4296 - acc: 0.0180  4/64 [>.............................] - ETA: 5:51 - loss: 4.4287 - acc: 0.0174 5/64 [=>............................] - ETA: 4:57 - loss: 4.4285 - acc: 0.0175 6/64 [=>............................] - ETA: 4:19 - loss: 4.4295 - acc: 0.0170 7/64 [==>...........................] - ETA: 3:58 - loss: 4.4285 - acc: 0.0173 8/64 [==>...........................] - ETA: 3:42 - loss: 4.4283 - acc: 0.0178 9/64 [===>..........................] - ETA: 3:29 - loss: 4.4255 - acc: 0.018410/64 [===>..........................] - ETA: 3:18 - loss: 4.4245 - acc: 0.018711/64 [====>.........................] - ETA: 3:08 - loss: 4.4245 - acc: 0.019312/64 [====>.........................] - ETA: 2:59 - loss: 4.4248 - acc: 0.018913/64 [=====>........................] - ETA: 2:51 - loss: 4.4258 - acc: 0.018614/64 [=====>........................] - ETA: 2:43 - loss: 4.4261 - acc: 0.018515/64 [======>.......................] - ETA: 2:35 - loss: 4.4245 - acc: 0.018616/64 [======>.......................] - ETA: 2:27 - loss: 4.4234 - acc: 0.018517/64 [======>.......................] - ETA: 2:20 - loss: 4.4230 - acc: 0.018418/64 [=======>......................] - ETA: 2:15 - loss: 4.4216 - acc: 0.018419/64 [=======>......................] - ETA: 2:10 - loss: 4.4201 - acc: 0.018420/64 [========>.....................] - ETA: 2:06 - loss: 4.4199 - acc: 0.018321/64 [========>.....................] - ETA: 2:02 - loss: 4.4190 - acc: 0.018222/64 [=========>....................] - ETA: 1:58 - loss: 4.4178 - acc: 0.018523/64 [=========>....................] - ETA: 1:55 - loss: 4.4170 - acc: 0.018624/64 [==========>...................] - ETA: 1:51 - loss: 4.4154 - acc: 0.018825/64 [==========>...................] - ETA: 1:48 - loss: 4.4152 - acc: 0.019026/64 [===========>..................] - ETA: 1:43 - loss: 4.4147 - acc: 0.019127/64 [===========>..................] - ETA: 1:39 - loss: 4.4140 - acc: 0.019028/64 [============>.................] - ETA: 1:36 - loss: 4.4138 - acc: 0.018929/64 [============>.................] - ETA: 1:32 - loss: 4.4129 - acc: 0.018930/64 [=============>................] - ETA: 1:29 - loss: 4.4119 - acc: 0.019031/64 [=============>................] - ETA: 1:26 - loss: 4.4112 - acc: 0.018932/64 [==============>...............] - ETA: 1:23 - loss: 4.4104 - acc: 0.018933/64 [==============>...............] - ETA: 1:20 - loss: 4.4089 - acc: 0.018934/64 [==============>...............] - ETA: 1:18 - loss: 4.4081 - acc: 0.018935/64 [===============>..............] - ETA: 1:15 - loss: 4.4076 - acc: 0.018836/64 [===============>..............] - ETA: 1:12 - loss: 4.4070 - acc: 0.018837/64 [================>.............] - ETA: 1:09 - loss: 4.4060 - acc: 0.019038/64 [================>.............] - ETA: 1:06 - loss: 4.4049 - acc: 0.019039/64 [=================>............] - ETA: 1:03 - loss: 4.4036 - acc: 0.019240/64 [=================>............] - ETA: 1:00 - loss: 4.4032 - acc: 0.019441/64 [==================>...........] - ETA: 57s - loss: 4.4027 - acc: 0.0193 42/64 [==================>...........] - ETA: 55s - loss: 4.4022 - acc: 0.019343/64 [===================>..........] - ETA: 52s - loss: 4.4019 - acc: 0.019344/64 [===================>..........] - ETA: 50s - loss: 4.4007 - acc: 0.019345/64 [====================>.........] - ETA: 47s - loss: 4.3997 - acc: 0.019346/64 [====================>.........] - ETA: 45s - loss: 4.3990 - acc: 0.019347/64 [=====================>........] - ETA: 42s - loss: 4.3978 - acc: 0.019448/64 [=====================>........] - ETA: 39s - loss: 4.3969 - acc: 0.019349/64 [=====================>........] - ETA: 37s - loss: 4.3961 - acc: 0.019350/64 [======================>.......] - ETA: 34s - loss: 4.3953 - acc: 0.019251/64 [======================>.......] - ETA: 31s - loss: 4.3945 - acc: 0.019352/64 [=======================>......] - ETA: 29s - loss: 4.3937 - acc: 0.019453/64 [=======================>......] - ETA: 26s - loss: 4.3925 - acc: 0.019554/64 [========================>.....] - ETA: 24s - loss: 4.3915 - acc: 0.019655/64 [========================>.....] - ETA: 22s - loss: 4.3908 - acc: 0.019756/64 [=========================>....] - ETA: 19s - loss: 4.3900 - acc: 0.019757/64 [=========================>....] - ETA: 17s - loss: 4.3897 - acc: 0.019658/64 [==========================>...] - ETA: 14s - loss: 4.3890 - acc: 0.019659/64 [==========================>...] - ETA: 12s - loss: 4.3880 - acc: 0.019760/64 [===========================>..] - ETA: 9s - loss: 4.3870 - acc: 0.0197 61/64 [===========================>..] - ETA: 7s - loss: 4.3864 - acc: 0.019662/64 [============================>.] - ETA: 4s - loss: 4.3853 - acc: 0.019763/64 [============================>.] - ETA: 2s - loss: 4.3844 - acc: 0.019764/64 [==============================] - 154s 2s/step - loss: 4.3836 - acc: 0.0197
Finished Epoch 0
