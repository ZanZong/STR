WARNING:tensorflow:From ../run_training.py:27: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

WARNING:tensorflow:From ../run_training.py:27: The name tf.ConfigProto is deprecated. Please use tf.compat.v1.ConfigProto instead.

WARNING:tensorflow:From ../run_training.py:27: The name tf.GPUOptions is deprecated. Please use tf.compat.v1.GPUOptions instead.

WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1630: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
1 Physical GPUs, 1 Logical GPUs
Parsing arguments: [('batch_size', 25), ('epochs', 1), ('model_name', 'vgg_unet'), ('strategy', 'capuchin'), ('verbose', False)]
Cannot find config for batch_size=25, use 40 instead
There are 367 and 367 images downloaded for train and test
Verifying train dataset
  0%|          | 0/367 [00:00<?, ?it/s]  4%|▎         | 13/367 [00:00<00:02, 124.95it/s]  7%|▋         | 26/367 [00:00<00:02, 125.89it/s] 11%|█         | 39/367 [00:00<00:02, 127.19it/s] 14%|█▍        | 52/367 [00:00<00:02, 127.80it/s] 18%|█▊        | 65/367 [00:00<00:02, 128.27it/s] 22%|██▏       | 82/367 [00:00<00:02, 140.30it/s] 27%|██▋       | 98/367 [00:00<00:01, 146.11it/s] 31%|███▏      | 115/367 [00:00<00:01, 151.83it/s] 36%|███▌      | 131/367 [00:00<00:01, 154.32it/s] 40%|████      | 147/367 [00:01<00:01, 155.76it/s] 44%|████▍     | 163/367 [00:01<00:01, 156.98it/s] 49%|████▉     | 179/367 [00:01<00:01, 157.66it/s] 53%|█████▎    | 196/367 [00:01<00:01, 158.48it/s] 58%|█████▊    | 213/367 [00:01<00:00, 159.15it/s] 62%|██████▏   | 229/367 [00:01<00:00, 157.76it/s] 67%|██████▋   | 245/367 [00:01<00:00, 158.12it/s] 71%|███████▏  | 262/367 [00:01<00:00, 160.12it/s] 76%|███████▌  | 279/367 [00:01<00:00, 159.57it/s] 81%|████████  | 296/367 [00:01<00:00, 160.30it/s] 85%|████████▌ | 313/367 [00:02<00:00, 160.06it/s] 90%|████████▉ | 330/367 [00:02<00:00, 159.65it/s] 94%|█████████▍| 346/367 [00:02<00:00, 158.63it/s] 99%|█████████▊| 362/367 [00:02<00:00, 157.94it/s]100%|██████████| 367/367 [00:02<00:00, 152.83it/s]
WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/stropt/lms.py:970: The name tf.train.SessionRunHook is deprecated. Please use tf.estimator.SessionRunHook instead.

WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/stropt/str_strategy.py:122: get_backward_walk_ops (from tensorflow.contrib.graph_editor.select) is deprecated and will be removed after 2019-06-06.
Instructions for updating:
Please use tensorflow.python.ops.op_selector.get_backward_walk_ops.
WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/math_grad.py:1424: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/stropt/lms.py:928: The name tf.logging.info is deprecated. Please use tf.compat.v1.logging.info instead.

Dataset verified! 
Starting Epoch  0
[STR DEBUG] Parsing STR configuration: [{'strategy': 'hybrid', 'verbose': 'false', 'tags': '/home/zongzan/dist_dnn_training/STR/optimizer/logs/vgg_unet_40/layer_names'}, {'r': '/home/zongzan/dist_dnn_training/STR/optimizer/logs/vgg_unet_40/R-capuchin', 'p': '/home/zongzan/dist_dnn_training/STR/optimizer/logs/vgg_unet_40/P-capuchin', 'q': '/home/zongzan/dist_dnn_training/STR/optimizer/logs/vgg_unet_40/Q-capuchin'}]
[STR DEBUG] Processing layer 28's swapping, swap out at [30], swap in at [41]
[STR DEBUG] Cannot find swap-out activation nodes for layer 28 among [<tf.Operation 'up_sampling2d_2/strided_slice' type=StridedSlice>, <tf.Operation 'up_sampling2d_2/mul' type=Mul>, <tf.Operation 'up_sampling2d_2/resize/ResizeNearestNeighbor' type=ResizeNearestNeighbor>, <tf.Operation 'up_sampling2d_2/strided_slice/stack_2' type=Const>, <tf.Operation 'up_sampling2d_2/Const' type=Const>, <tf.Operation 'up_sampling2d_2/Shape' type=Shape>, <tf.Operation 'up_sampling2d_2/strided_slice/stack_1' type=Const>, <tf.Operation 'up_sampling2d_2/strided_slice/stack' type=Const>]
[STR DEBUG] Processing layer 29's swapping, swap out at [31], swap in at [40]
[STR DEBUG] Cannot find swap-out activation nodes for layer 29 among [<tf.Operation 'concatenate_2/concat/axis' type=Const>, <tf.Operation 'concatenate_2/concat' type=ConcatV2>]
[STR DEBUG] Processing layer 31's swapping, swap out at [34], swap in at [38]
[STR DEBUG] Cannot find swap-out activation nodes for layer 31 among [<tf.Operation 'conv2d_3/kernel/IsInitialized/VarIsInitializedOp' type=VarIsInitializedOp>, <tf.Operation 'conv2d_3/kernel/Read/ReadVariableOp' type=ReadVariableOp>, <tf.Operation 'conv2d_3/kernel/Assign' type=AssignVariableOp>, <tf.Operation 'conv2d_3/bias/Initializer/zeros' type=Const>, <tf.Operation 'conv2d_3/bias' type=VarHandleOp>, <tf.Operation 'conv2d_3/bias/IsInitialized/VarIsInitializedOp' type=VarIsInitializedOp>, <tf.Operation 'conv2d_3/Conv2D' type=Conv2D>, <tf.Operation 'conv2d_3/bias/Read/ReadVariableOp' type=ReadVariableOp>, <tf.Operation 'conv2d_3/bias/Assign' type=AssignVariableOp>, <tf.Operation 'conv2d_3/BiasAdd' type=BiasAdd>, <tf.Operation 'conv2d_3/BiasAdd/ReadVariableOp' type=ReadVariableOp>, <tf.Operation 'conv2d_3/Conv2D/ReadVariableOp' type=ReadVariableOp>, <tf.Operation 'conv2d_3/dilation_rate' type=Const>, <tf.Operation 'conv2d_3/kernel/Initializer/random_uniform/shape' type=Const>, <tf.Operation 'conv2d_3/kernel/Initializer/random_uniform/min' type=Const>, <tf.Operation 'conv2d_3/kernel' type=VarHandleOp>, <tf.Operation 'conv2d_3/kernel/Initializer/random_uniform/max' type=Const>, <tf.Operation 'conv2d_3/kernel/Initializer/random_uniform/RandomUniform' type=RandomUniform>, <tf.Operation 'conv2d_3/kernel/Initializer/random_uniform/sub' type=Sub>, <tf.Operation 'conv2d_3/kernel/Initializer/random_uniform/mul' type=Mul>, <tf.Operation 'conv2d_3/kernel/Initializer/random_uniform' type=Add>]
[STR DEBUG] Processing layer 33's swapping, swap out at [35], swap in at [36]
[STR DEBUG] Cannot find swap-out activation nodes for layer 33 among [<tf.Operation 'conv2d_4/kernel/Assign' type=AssignVariableOp>, <tf.Operation 'conv2d_4/bias/Initializer/zeros' type=Const>, <tf.Operation 'conv2d_4/bias' type=VarHandleOp>, <tf.Operation 'conv2d_4/bias/IsInitialized/VarIsInitializedOp' type=VarIsInitializedOp>, <tf.Operation 'conv2d_4/bias/Read/ReadVariableOp' type=ReadVariableOp>, <tf.Operation 'conv2d_4/bias/Assign' type=AssignVariableOp>, <tf.Operation 'conv2d_4/Conv2D' type=Conv2D>, <tf.Operation 'conv2d_4/BiasAdd' type=BiasAdd>, <tf.Operation 'conv2d_4/BiasAdd/ReadVariableOp' type=ReadVariableOp>, <tf.Operation 'conv2d_4/Conv2D/ReadVariableOp' type=ReadVariableOp>, <tf.Operation 'conv2d_4/kernel/Initializer/random_uniform/shape' type=Const>, <tf.Operation 'conv2d_4/kernel/Initializer/random_uniform/min' type=Const>, <tf.Operation 'conv2d_4/kernel' type=VarHandleOp>, <tf.Operation 'conv2d_4/kernel/Initializer/random_uniform/max' type=Const>, <tf.Operation 'conv2d_4/kernel/Initializer/random_uniform/RandomUniform' type=RandomUniform>, <tf.Operation 'conv2d_4/kernel/Initializer/random_uniform/sub' type=Sub>, <tf.Operation 'conv2d_4/kernel/Initializer/random_uniform' type=Add>, <tf.Operation 'conv2d_4/kernel/Initializer/random_uniform/mul' type=Mul>, <tf.Operation 'conv2d_4/kernel/IsInitialized/VarIsInitializedOp' type=VarIsInitializedOp>, <tf.Operation 'conv2d_4/kernel/Read/ReadVariableOp' type=ReadVariableOp>, <tf.Operation 'conv2d_4/dilation_rate' type=Const>]
 1/64 [..............................] - ETA: 20:49 - loss: 4.6571 - acc: 0.0073 2/64 [..............................] - ETA: 11:27 - loss: 4.6386 - acc: 0.0087 3/64 [>.............................] - ETA: 8:19 - loss: 4.6415 - acc: 0.0093  4/64 [>.............................] - ETA: 6:44 - loss: 4.6293 - acc: 0.0095 5/64 [=>............................] - ETA: 5:49 - loss: 4.6195 - acc: 0.0093 6/64 [=>............................] - ETA: 5:12 - loss: 4.6154 - acc: 0.0090 7/64 [==>...........................] - ETA: 4:44 - loss: 4.6122 - acc: 0.0089 8/64 [==>...........................] - ETA: 4:21 - loss: 4.6105 - acc: 0.0089 9/64 [===>..........................] - ETA: 4:05 - loss: 4.6134 - acc: 0.009010/64 [===>..........................] - ETA: 3:50 - loss: 4.6143 - acc: 0.009011/64 [====>.........................] - ETA: 3:39 - loss: 4.6183 - acc: 0.008812/64 [====>.........................] - ETA: 3:28 - loss: 4.6170 - acc: 0.008813/64 [=====>........................] - ETA: 3:18 - loss: 4.6133 - acc: 0.009014/64 [=====>........................] - ETA: 3:09 - loss: 4.6100 - acc: 0.009115/64 [======>.......................] - ETA: 3:00 - loss: 4.6078 - acc: 0.009116/64 [======>.......................] - ETA: 2:54 - loss: 4.6097 - acc: 0.009117/64 [======>.......................] - ETA: 2:48 - loss: 4.6070 - acc: 0.009218/64 [=======>......................] - ETA: 2:41 - loss: 4.6077 - acc: 0.009319/64 [=======>......................] - ETA: 2:36 - loss: 4.6053 - acc: 0.009320/64 [========>.....................] - ETA: 2:30 - loss: 4.6031 - acc: 0.009321/64 [========>.....................] - ETA: 2:25 - loss: 4.6023 - acc: 0.009222/64 [=========>....................] - ETA: 2:20 - loss: 4.6008 - acc: 0.009223/64 [=========>....................] - ETA: 2:16 - loss: 4.6002 - acc: 0.009224/64 [==========>...................] - ETA: 2:11 - loss: 4.6006 - acc: 0.009225/64 [==========>...................] - ETA: 2:06 - loss: 4.6001 - acc: 0.009226/64 [===========>..................] - ETA: 2:02 - loss: 4.6005 - acc: 0.009227/64 [===========>..................] - ETA: 1:57 - loss: 4.6001 - acc: 0.009228/64 [============>.................] - ETA: 1:54 - loss: 4.5974 - acc: 0.009329/64 [============>.................] - ETA: 1:50 - loss: 4.5964 - acc: 0.009330/64 [=============>................] - ETA: 1:46 - loss: 4.5954 - acc: 0.009331/64 [=============>................] - ETA: 1:42 - loss: 4.5962 - acc: 0.009332/64 [==============>...............] - ETA: 1:39 - loss: 4.5951 - acc: 0.009433/64 [==============>...............] - ETA: 1:35 - loss: 4.5937 - acc: 0.009434/64 [==============>...............] - ETA: 1:31 - loss: 4.5913 - acc: 0.009435/64 [===============>..............] - ETA: 1:28 - loss: 4.5904 - acc: 0.009436/64 [===============>..............] - ETA: 1:24 - loss: 4.5896 - acc: 0.009437/64 [================>.............] - ETA: 1:21 - loss: 4.5879 - acc: 0.009438/64 [================>.............] - ETA: 1:17 - loss: 4.5878 - acc: 0.009439/64 [=================>............] - ETA: 1:14 - loss: 4.5882 - acc: 0.009440/64 [=================>............] - ETA: 1:11 - loss: 4.5878 - acc: 0.009441/64 [==================>...........] - ETA: 1:08 - loss: 4.5871 - acc: 0.009442/64 [==================>...........] - ETA: 1:04 - loss: 4.5863 - acc: 0.009443/64 [===================>..........] - ETA: 1:01 - loss: 4.5844 - acc: 0.009544/64 [===================>..........] - ETA: 58s - loss: 4.5831 - acc: 0.0095 45/64 [====================>.........] - ETA: 55s - loss: 4.5829 - acc: 0.009546/64 [====================>.........] - ETA: 52s - loss: 4.5823 - acc: 0.009647/64 [=====================>........] - ETA: 49s - loss: 4.5819 - acc: 0.009648/64 [=====================>........] - ETA: 46s - loss: 4.5805 - acc: 0.009649/64 [=====================>........] - ETA: 43s - loss: 4.5789 - acc: 0.009650/64 [======================>.......] - ETA: 40s - loss: 4.5777 - acc: 0.009651/64 [======================>.......] - ETA: 37s - loss: 4.5768 - acc: 0.009652/64 [=======================>......] - ETA: 34s - loss: 4.5755 - acc: 0.009653/64 [=======================>......] - ETA: 31s - loss: 4.5754 - acc: 0.009754/64 [========================>.....] - ETA: 28s - loss: 4.5750 - acc: 0.009755/64 [========================>.....] - ETA: 25s - loss: 4.5750 - acc: 0.009656/64 [=========================>....] - ETA: 22s - loss: 4.5742 - acc: 0.009657/64 [=========================>....] - ETA: 19s - loss: 4.5728 - acc: 0.009758/64 [==========================>...] - ETA: 16s - loss: 4.5715 - acc: 0.009759/64 [==========================>...] - ETA: 14s - loss: 4.5701 - acc: 0.009860/64 [===========================>..] - ETA: 11s - loss: 4.5700 - acc: 0.009761/64 [===========================>..] - ETA: 8s - loss: 4.5687 - acc: 0.0098 62/64 [============================>.] - ETA: 5s - loss: 4.5685 - acc: 0.009863/64 [============================>.] - ETA: 2s - loss: 4.5671 - acc: 0.009864/64 [==============================] - 179s 3s/step - loss: 4.5658 - acc: 0.0098
Finished Epoch 0
