WARNING:tensorflow:From ../run_training.py:27: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

WARNING:tensorflow:From ../run_training.py:27: The name tf.ConfigProto is deprecated. Please use tf.compat.v1.ConfigProto instead.

WARNING:tensorflow:From ../run_training.py:27: The name tf.GPUOptions is deprecated. Please use tf.compat.v1.GPUOptions instead.

WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1630: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
1 Physical GPUs, 1 Logical GPUs
Parsing arguments: [('batch_size', 40), ('epochs', 1), ('model_name', 'vgg_unet'), ('strategy', 'capuchin'), ('verbose', False)]
There are 367 and 367 images downloaded for train and test
Verifying train dataset
  0%|          | 0/367 [00:00<?, ?it/s]  4%|▎         | 13/367 [00:00<00:02, 124.93it/s]  7%|▋         | 26/367 [00:00<00:02, 126.84it/s] 11%|█         | 39/367 [00:00<00:02, 128.03it/s] 14%|█▍        | 53/367 [00:00<00:02, 129.98it/s] 18%|█▊        | 66/367 [00:00<00:02, 129.18it/s] 22%|██▏       | 80/367 [00:00<00:02, 129.76it/s] 26%|██▋       | 97/367 [00:00<00:01, 140.97it/s] 31%|███       | 113/367 [00:00<00:01, 146.09it/s] 35%|███▌      | 130/367 [00:00<00:01, 150.83it/s] 40%|███▉      | 146/367 [00:01<00:01, 153.50it/s] 44%|████▍     | 163/367 [00:01<00:01, 156.05it/s] 49%|████▉     | 180/367 [00:01<00:01, 158.21it/s] 54%|█████▎    | 197/367 [00:01<00:01, 159.17it/s] 58%|█████▊    | 213/367 [00:01<00:00, 159.34it/s] 63%|██████▎   | 230/367 [00:01<00:00, 159.73it/s] 67%|██████▋   | 246/367 [00:01<00:00, 159.02it/s] 72%|███████▏  | 263/367 [00:01<00:00, 160.57it/s] 76%|███████▋  | 280/367 [00:01<00:00, 160.28it/s] 81%|████████  | 297/367 [00:01<00:00, 160.93it/s] 86%|████████▌ | 314/367 [00:02<00:00, 161.49it/s] 90%|█████████ | 331/367 [00:02<00:00, 161.05it/s] 95%|█████████▍| 348/367 [00:02<00:00, 160.83it/s] 99%|█████████▉| 365/367 [00:02<00:00, 160.10it/s]100%|██████████| 367/367 [00:02<00:00, 152.61it/s]
WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/stropt/lms.py:970: The name tf.train.SessionRunHook is deprecated. Please use tf.estimator.SessionRunHook instead.

WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/stropt/str_strategy.py:122: get_backward_walk_ops (from tensorflow.contrib.graph_editor.select) is deprecated and will be removed after 2019-06-06.
Instructions for updating:
Please use tensorflow.python.ops.op_selector.get_backward_walk_ops.
WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/math_grad.py:1424: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/stropt/lms.py:928: The name tf.logging.info is deprecated. Please use tf.compat.v1.logging.info instead.

Dataset verified! 
Starting Epoch  0
[STR DEBUG] Parsing STR configuration: [{'strategy': 'hybrid', 'verbose': 'false', 'tags': '/home/zongzan/dist_dnn_training/STR/optimizer/logs/vgg_unet_40/layer_names'}, {'r': '/home/zongzan/dist_dnn_training/STR/optimizer/logs/vgg_unet_40/R-capuchin', 'p': '/home/zongzan/dist_dnn_training/STR/optimizer/logs/vgg_unet_40/P-capuchin', 'q': '/home/zongzan/dist_dnn_training/STR/optimizer/logs/vgg_unet_40/Q-capuchin'}]
[STR DEBUG] Processing layer 28's swapping, swap out at [30], swap in at [41]
[STR DEBUG] Cannot find swap-out activation nodes for layer 28 among [<tf.Operation 'up_sampling2d_2/strided_slice/stack_2' type=Const>, <tf.Operation 'up_sampling2d_2/strided_slice/stack' type=Const>, <tf.Operation 'up_sampling2d_2/strided_slice/stack_1' type=Const>, <tf.Operation 'up_sampling2d_2/Const' type=Const>, <tf.Operation 'up_sampling2d_2/Shape' type=Shape>, <tf.Operation 'up_sampling2d_2/strided_slice' type=StridedSlice>, <tf.Operation 'up_sampling2d_2/mul' type=Mul>, <tf.Operation 'up_sampling2d_2/resize/ResizeNearestNeighbor' type=ResizeNearestNeighbor>]
[STR DEBUG] Processing layer 29's swapping, swap out at [31], swap in at [40]
[STR DEBUG] Cannot find swap-out activation nodes for layer 29 among [<tf.Operation 'concatenate_2/concat/axis' type=Const>, <tf.Operation 'concatenate_2/concat' type=ConcatV2>]
[STR DEBUG] Processing layer 31's swapping, swap out at [34], swap in at [38]
[STR DEBUG] Cannot find swap-out activation nodes for layer 31 among [<tf.Operation 'conv2d_3/BiasAdd' type=BiasAdd>, <tf.Operation 'conv2d_3/BiasAdd/ReadVariableOp' type=ReadVariableOp>, <tf.Operation 'conv2d_3/Conv2D/ReadVariableOp' type=ReadVariableOp>, <tf.Operation 'conv2d_3/dilation_rate' type=Const>, <tf.Operation 'conv2d_3/kernel/Initializer/random_uniform/shape' type=Const>, <tf.Operation 'conv2d_3/kernel/Initializer/random_uniform/min' type=Const>, <tf.Operation 'conv2d_3/kernel/Initializer/random_uniform/max' type=Const>, <tf.Operation 'conv2d_3/kernel/Initializer/random_uniform/RandomUniform' type=RandomUniform>, <tf.Operation 'conv2d_3/kernel/Initializer/random_uniform/sub' type=Sub>, <tf.Operation 'conv2d_3/kernel/Initializer/random_uniform/mul' type=Mul>, <tf.Operation 'conv2d_3/kernel/Initializer/random_uniform' type=Add>, <tf.Operation 'conv2d_3/kernel' type=VarHandleOp>, <tf.Operation 'conv2d_3/kernel/IsInitialized/VarIsInitializedOp' type=VarIsInitializedOp>, <tf.Operation 'conv2d_3/kernel/Read/ReadVariableOp' type=ReadVariableOp>, <tf.Operation 'conv2d_3/kernel/Assign' type=AssignVariableOp>, <tf.Operation 'conv2d_3/bias/Initializer/zeros' type=Const>, <tf.Operation 'conv2d_3/bias' type=VarHandleOp>, <tf.Operation 'conv2d_3/bias/IsInitialized/VarIsInitializedOp' type=VarIsInitializedOp>, <tf.Operation 'conv2d_3/Conv2D' type=Conv2D>, <tf.Operation 'conv2d_3/bias/Read/ReadVariableOp' type=ReadVariableOp>, <tf.Operation 'conv2d_3/bias/Assign' type=AssignVariableOp>]
[STR DEBUG] Processing layer 33's swapping, swap out at [35], swap in at [36]
[STR DEBUG] Cannot find swap-out activation nodes for layer 33 among [<tf.Operation 'conv2d_4/kernel/Initializer/random_uniform/shape' type=Const>, <tf.Operation 'conv2d_4/kernel/Initializer/random_uniform/min' type=Const>, <tf.Operation 'conv2d_4/kernel/Initializer/random_uniform/max' type=Const>, <tf.Operation 'conv2d_4/kernel/Initializer/random_uniform/RandomUniform' type=RandomUniform>, <tf.Operation 'conv2d_4/kernel/Initializer/random_uniform/sub' type=Sub>, <tf.Operation 'conv2d_4/kernel/Initializer/random_uniform' type=Add>, <tf.Operation 'conv2d_4/kernel/Initializer/random_uniform/mul' type=Mul>, <tf.Operation 'conv2d_4/kernel' type=VarHandleOp>, <tf.Operation 'conv2d_4/kernel/IsInitialized/VarIsInitializedOp' type=VarIsInitializedOp>, <tf.Operation 'conv2d_4/kernel/Read/ReadVariableOp' type=ReadVariableOp>, <tf.Operation 'conv2d_4/dilation_rate' type=Const>, <tf.Operation 'conv2d_4/kernel/Assign' type=AssignVariableOp>, <tf.Operation 'conv2d_4/bias/Initializer/zeros' type=Const>, <tf.Operation 'conv2d_4/bias' type=VarHandleOp>, <tf.Operation 'conv2d_4/bias/IsInitialized/VarIsInitializedOp' type=VarIsInitializedOp>, <tf.Operation 'conv2d_4/bias/Read/ReadVariableOp' type=ReadVariableOp>, <tf.Operation 'conv2d_4/bias/Assign' type=AssignVariableOp>, <tf.Operation 'conv2d_4/Conv2D' type=Conv2D>, <tf.Operation 'conv2d_4/BiasAdd' type=BiasAdd>, <tf.Operation 'conv2d_4/BiasAdd/ReadVariableOp' type=ReadVariableOp>, <tf.Operation 'conv2d_4/Conv2D/ReadVariableOp' type=ReadVariableOp>]
 1/64 [..............................] - ETA: 27:03 - loss: 4.4671 - acc: 0.0033 2/64 [..............................] - ETA: 14:49 - loss: 4.4687 - acc: 0.0031 3/64 [>.............................] - ETA: 10:46 - loss: 4.4668 - acc: 0.0031 4/64 [>.............................] - ETA: 8:42 - loss: 4.4625 - acc: 0.0030  5/64 [=>............................] - ETA: 7:27 - loss: 4.4570 - acc: 0.0031 6/64 [=>............................] - ETA: 6:36 - loss: 4.4621 - acc: 0.0030 7/64 [==>...........................] - ETA: 5:59 - loss: 4.4590 - acc: 0.0030 8/64 [==>...........................] - ETA: 5:29 - loss: 4.4603 - acc: 0.0030 9/64 [===>..........................] - ETA: 5:07 - loss: 4.4601 - acc: 0.003010/64 [===>..........................] - ETA: 4:47 - loss: 4.4605 - acc: 0.003011/64 [====>.........................] - ETA: 4:31 - loss: 4.4601 - acc: 0.003012/64 [====>.........................] - ETA: 4:17 - loss: 4.4596 - acc: 0.003013/64 [=====>........................] - ETA: 4:05 - loss: 4.4585 - acc: 0.003014/64 [=====>........................] - ETA: 3:54 - loss: 4.4564 - acc: 0.003015/64 [======>.......................] - ETA: 3:44 - loss: 4.4557 - acc: 0.003016/64 [======>.......................] - ETA: 3:35 - loss: 4.4554 - acc: 0.003017/64 [======>.......................] - ETA: 3:27 - loss: 4.4548 - acc: 0.003018/64 [=======>......................] - ETA: 3:19 - loss: 4.4539 - acc: 0.003019/64 [=======>......................] - ETA: 3:12 - loss: 4.4545 - acc: 0.003020/64 [========>.....................] - ETA: 3:05 - loss: 4.4535 - acc: 0.003121/64 [========>.....................] - ETA: 2:59 - loss: 4.4528 - acc: 0.003122/64 [=========>....................] - ETA: 2:52 - loss: 4.4518 - acc: 0.003123/64 [=========>....................] - ETA: 2:47 - loss: 4.4504 - acc: 0.003124/64 [==========>...................] - ETA: 2:41 - loss: 4.4492 - acc: 0.003125/64 [==========>...................] - ETA: 2:35 - loss: 4.4494 - acc: 0.003126/64 [===========>..................] - ETA: 2:30 - loss: 4.4485 - acc: 0.003127/64 [===========>..................] - ETA: 2:25 - loss: 4.4475 - acc: 0.003128/64 [============>.................] - ETA: 2:20 - loss: 4.4473 - acc: 0.003129/64 [============>.................] - ETA: 2:15 - loss: 4.4470 - acc: 0.003130/64 [=============>................] - ETA: 2:10 - loss: 4.4461 - acc: 0.003131/64 [=============>................] - ETA: 2:06 - loss: 4.4455 - acc: 0.003132/64 [==============>...............] - ETA: 2:01 - loss: 4.4441 - acc: 0.003133/64 [==============>...............] - ETA: 1:56 - loss: 4.4427 - acc: 0.003134/64 [==============>...............] - ETA: 1:52 - loss: 4.4428 - acc: 0.003135/64 [===============>..............] - ETA: 1:48 - loss: 4.4419 - acc: 0.003136/64 [===============>..............] - ETA: 1:43 - loss: 4.4412 - acc: 0.003137/64 [================>.............] - ETA: 1:39 - loss: 4.4407 - acc: 0.003138/64 [================>.............] - ETA: 1:35 - loss: 4.4403 - acc: 0.003139/64 [=================>............] - ETA: 1:31 - loss: 4.4396 - acc: 0.003140/64 [=================>............] - ETA: 1:27 - loss: 4.4387 - acc: 0.003141/64 [==================>...........] - ETA: 1:23 - loss: 4.4376 - acc: 0.003142/64 [==================>...........] - ETA: 1:19 - loss: 4.4363 - acc: 0.003143/64 [===================>..........] - ETA: 1:15 - loss: 4.4362 - acc: 0.003144/64 [===================>..........] - ETA: 1:12 - loss: 4.4350 - acc: 0.003145/64 [====================>.........] - ETA: 1:08 - loss: 4.4343 - acc: 0.003146/64 [====================>.........] - ETA: 1:04 - loss: 4.4339 - acc: 0.003147/64 [=====================>........] - ETA: 1:00 - loss: 4.4332 - acc: 0.003148/64 [=====================>........] - ETA: 56s - loss: 4.4325 - acc: 0.0031 49/64 [=====================>........] - ETA: 53s - loss: 4.4318 - acc: 0.003250/64 [======================>.......] - ETA: 49s - loss: 4.4307 - acc: 0.003251/64 [======================>.......] - ETA: 45s - loss: 4.4296 - acc: 0.003252/64 [=======================>......] - ETA: 42s - loss: 4.4293 - acc: 0.003253/64 [=======================>......] - ETA: 38s - loss: 4.4282 - acc: 0.003254/64 [========================>.....] - ETA: 35s - loss: 4.4277 - acc: 0.003255/64 [========================>.....] - ETA: 31s - loss: 4.4271 - acc: 0.003256/64 [=========================>....] - ETA: 27s - loss: 4.4264 - acc: 0.003257/64 [=========================>....] - ETA: 24s - loss: 4.4256 - acc: 0.003258/64 [==========================>...] - ETA: 20s - loss: 4.4249 - acc: 0.003259/64 [==========================>...] - ETA: 17s - loss: 4.4239 - acc: 0.003260/64 [===========================>..] - ETA: 13s - loss: 4.4228 - acc: 0.003261/64 [===========================>..] - ETA: 10s - loss: 4.4223 - acc: 0.003262/64 [============================>.] - ETA: 6s - loss: 4.4214 - acc: 0.0032 63/64 [============================>.] - ETA: 3s - loss: 4.4207 - acc: 0.003264/64 [==============================] - 220s 3s/step - loss: 4.4200 - acc: 0.0032
Finished Epoch 0
