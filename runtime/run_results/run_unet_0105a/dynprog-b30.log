WARNING:tensorflow:From ../run_training.py:27: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

WARNING:tensorflow:From ../run_training.py:27: The name tf.ConfigProto is deprecated. Please use tf.compat.v1.ConfigProto instead.

WARNING:tensorflow:From ../run_training.py:27: The name tf.GPUOptions is deprecated. Please use tf.compat.v1.GPUOptions instead.

WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1630: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
1 Physical GPUs, 1 Logical GPUs
Parsing arguments: [('batch_size', 30), ('epochs', 1), ('model_name', 'vgg_unet'), ('strategy', 'dynprog'), ('verbose', False)]
Cannot find config for batch_size=30, use 40 instead
There are 367 and 367 images downloaded for train and test
Verifying train dataset
  0%|          | 0/367 [00:00<?, ?it/s]  4%|▎         | 13/367 [00:00<00:02, 124.98it/s]  7%|▋         | 26/367 [00:00<00:02, 124.69it/s] 11%|█         | 39/367 [00:00<00:02, 126.40it/s] 14%|█▍        | 53/367 [00:00<00:02, 128.64it/s] 19%|█▉        | 69/367 [00:00<00:02, 138.17it/s] 23%|██▎       | 86/367 [00:00<00:01, 145.74it/s] 28%|██▊       | 103/367 [00:00<00:01, 152.24it/s] 33%|███▎      | 120/367 [00:00<00:01, 154.81it/s] 37%|███▋      | 136/367 [00:00<00:01, 155.64it/s] 41%|████▏     | 152/367 [00:01<00:01, 155.84it/s] 46%|████▌     | 169/367 [00:01<00:01, 158.32it/s] 50%|█████     | 185/367 [00:01<00:01, 157.69it/s] 55%|█████▌    | 202/367 [00:01<00:01, 158.55it/s] 60%|█████▉    | 219/367 [00:01<00:00, 159.68it/s] 64%|██████▍   | 235/367 [00:01<00:00, 158.23it/s] 69%|██████▊   | 252/367 [00:01<00:00, 159.42it/s] 73%|███████▎  | 269/367 [00:01<00:00, 160.10it/s] 78%|███████▊  | 286/367 [00:01<00:00, 160.27it/s] 83%|████████▎ | 303/367 [00:01<00:00, 160.73it/s] 87%|████████▋ | 320/367 [00:02<00:00, 159.96it/s] 92%|█████████▏| 337/367 [00:02<00:00, 160.60it/s] 96%|█████████▋| 354/367 [00:02<00:00, 159.81it/s]100%|██████████| 367/367 [00:02<00:00, 154.15it/s]
WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/stropt/lms.py:970: The name tf.train.SessionRunHook is deprecated. Please use tf.estimator.SessionRunHook instead.

WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/math_grad.py:1424: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/stropt/lms.py:928: The name tf.logging.info is deprecated. Please use tf.compat.v1.logging.info instead.

WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/contrib/graph_editor/select.py:554: get_backward_walk_ops (from tensorflow.contrib.graph_editor.select) is deprecated and will be removed after 2019-06-06.
Instructions for updating:
Please use tensorflow.python.ops.op_selector.get_backward_walk_ops.
Dataset verified! 
Starting Epoch  0
[STR DEBUG] Parsing STR configuration: [{'strategy': 'swap', 'verbose': 'true', 'tags': '/home/zongzan/dist_dnn_training/STR/optimizer/logs/VGG16_250/layer_names'}, {'p': '/home/zongzan/dist_dnn_training/STR/optimizer/logs/VGG16_250/P-dynprog', 'q': '/home/zongzan/dist_dnn_training/STR/optimizer/logs/VGG16_250/Q-dynprog'}]
[STR DEBUG] Use swap strategy of DYNPROG
[STR DEBUG] Processing layer 2's swapping, swap out at [3], swap in at [41]
[STR DEBUG] Find swapout ops: name: "block1_conv2/Relu"
op: "Relu"
input: "block1_conv2/BiasAdd"
attr {
  key: "T"
  value {
    type: DT_FLOAT
  }
}
, 
	choose swap tensor Tensor("block1_conv2/Relu:0", shape=(?, 320, 640, 64), dtype=float32), 
	finish at the end of ops: [<tf.Operation 'block1_pool/MaxPool' type=MaxPool>]
[STR DEBUG] Add swap-in op at name: "training/Adadelta/gradients/gradients/block1_pool/MaxPool_grad/MaxPoolGrad"
op: "MaxPoolGrad"
input: "block1_conv2/Relu"
input: "block1_pool/MaxPool"
input: "training/Adadelta/gradients/gradients/AddN_17"
attr {
  key: "T"
  value {
    type: DT_FLOAT
  }
}
attr {
  key: "data_format"
  value {
    s: "NHWC"
  }
}
attr {
  key: "ksize"
  value {
    list {
      i: 1
      i: 2
      i: 2
      i: 1
    }
  }
}
attr {
  key: "padding"
  value {
    s: "VALID"
  }
}
attr {
  key: "strides"
  value {
    list {
      i: 1
      i: 2
      i: 2
      i: 1
    }
  }
}
 for consumer [<tf.Operation 'training/Adadelta/gradients/gradients/block1_conv2/Relu_grad/ReluGrad' type=ReluGrad>]
[STR DEBUG] Processing layer 5's swapping, swap out at [6], swap in at [38]
[STR DEBUG] Find swapout ops: name: "block2_conv2/Relu"
op: "Relu"
input: "block2_conv2/BiasAdd"
attr {
  key: "T"
  value {
    type: DT_FLOAT
  }
}
, 
	choose swap tensor Tensor("block2_conv2/Relu:0", shape=(?, 160, 320, 128), dtype=float32), 
	finish at the end of ops: [<tf.Operation 'block2_pool/MaxPool' type=MaxPool>]
[STR DEBUG] Add swap-in op at name: "training/Adadelta/gradients/gradients/block2_pool/MaxPool_grad/MaxPoolGrad"
op: "MaxPoolGrad"
input: "block2_conv2/Relu"
input: "block2_pool/MaxPool"
input: "training/Adadelta/gradients/gradients/AddN_16"
attr {
  key: "T"
  value {
    type: DT_FLOAT
  }
}
attr {
  key: "data_format"
  value {
    s: "NHWC"
  }
}
attr {
  key: "ksize"
  value {
    list {
      i: 1
      i: 2
      i: 2
      i: 1
    }
  }
}
attr {
  key: "padding"
  value {
    s: "VALID"
  }
}
attr {
  key: "strides"
  value {
    list {
      i: 1
      i: 2
      i: 2
      i: 1
    }
  }
}
 for consumer [<tf.Operation 'training/Adadelta/gradients/gradients/block2_conv2/Relu_grad/ReluGrad' type=ReluGrad>]
 1/64 [..............................] - ETA: 22:33 - loss: 4.3438 - acc: 0.0279 2/64 [..............................] - ETA: 12:17 - loss: 4.3592 - acc: 0.0243 3/64 [>.............................] - ETA: 8:51 - loss: 4.3622 - acc: 0.0220  4/64 [>.............................] - ETA: 7:07 - loss: 4.3540 - acc: 0.0213 5/64 [=>............................] - ETA: 6:03 - loss: 4.3511 - acc: 0.0223 6/64 [=>............................] - ETA: 5:18 - loss: 4.3476 - acc: 0.0224 7/64 [==>...........................] - ETA: 4:46 - loss: 4.3463 - acc: 0.0218 8/64 [==>...........................] - ETA: 4:22 - loss: 4.3492 - acc: 0.0231 9/64 [===>..........................] - ETA: 4:02 - loss: 4.3486 - acc: 0.023210/64 [===>..........................] - ETA: 3:45 - loss: 4.3484 - acc: 0.024011/64 [====>.........................] - ETA: 3:31 - loss: 4.3472 - acc: 0.024112/64 [====>.........................] - ETA: 3:18 - loss: 4.3453 - acc: 0.024413/64 [=====>........................] - ETA: 3:08 - loss: 4.3442 - acc: 0.024914/64 [=====>........................] - ETA: 2:59 - loss: 4.3438 - acc: 0.025315/64 [======>.......................] - ETA: 2:51 - loss: 4.3441 - acc: 0.024716/64 [======>.......................] - ETA: 2:43 - loss: 4.3435 - acc: 0.024617/64 [======>.......................] - ETA: 2:37 - loss: 4.3407 - acc: 0.025118/64 [=======>......................] - ETA: 2:30 - loss: 4.3395 - acc: 0.025419/64 [=======>......................] - ETA: 2:24 - loss: 4.3385 - acc: 0.025120/64 [========>.....................] - ETA: 2:19 - loss: 4.3389 - acc: 0.025321/64 [========>.....................] - ETA: 2:14 - loss: 4.3384 - acc: 0.025522/64 [=========>....................] - ETA: 2:09 - loss: 4.3372 - acc: 0.026223/64 [=========>....................] - ETA: 2:04 - loss: 4.3373 - acc: 0.026524/64 [==========>...................] - ETA: 1:59 - loss: 4.3357 - acc: 0.026825/64 [==========>...................] - ETA: 1:55 - loss: 4.3344 - acc: 0.027026/64 [===========>..................] - ETA: 1:51 - loss: 4.3341 - acc: 0.027327/64 [===========>..................] - ETA: 1:47 - loss: 4.3341 - acc: 0.027428/64 [============>.................] - ETA: 1:43 - loss: 4.3332 - acc: 0.027429/64 [============>.................] - ETA: 1:40 - loss: 4.3317 - acc: 0.027630/64 [=============>................] - ETA: 1:36 - loss: 4.3300 - acc: 0.028231/64 [=============>................] - ETA: 1:33 - loss: 4.3292 - acc: 0.028032/64 [==============>...............] - ETA: 1:29 - loss: 4.3291 - acc: 0.028033/64 [==============>...............] - ETA: 1:26 - loss: 4.3288 - acc: 0.028334/64 [==============>...............] - ETA: 1:23 - loss: 4.3275 - acc: 0.028735/64 [===============>..............] - ETA: 1:19 - loss: 4.3276 - acc: 0.029236/64 [===============>..............] - ETA: 1:16 - loss: 4.3264 - acc: 0.029437/64 [================>.............] - ETA: 1:13 - loss: 4.3249 - acc: 0.029838/64 [================>.............] - ETA: 1:10 - loss: 4.3244 - acc: 0.030239/64 [=================>............] - ETA: 1:07 - loss: 4.3240 - acc: 0.030240/64 [=================>............] - ETA: 1:04 - loss: 4.3235 - acc: 0.030341/64 [==================>...........] - ETA: 1:01 - loss: 4.3224 - acc: 0.030542/64 [==================>...........] - ETA: 58s - loss: 4.3209 - acc: 0.0310 43/64 [===================>..........] - ETA: 55s - loss: 4.3199 - acc: 0.031044/64 [===================>..........] - ETA: 52s - loss: 4.3195 - acc: 0.031045/64 [====================>.........] - ETA: 50s - loss: 4.3192 - acc: 0.031446/64 [====================>.........] - ETA: 47s - loss: 4.3184 - acc: 0.031447/64 [=====================>........] - ETA: 44s - loss: 4.3179 - acc: 0.032048/64 [=====================>........] - ETA: 41s - loss: 4.3169 - acc: 0.032349/64 [=====================>........] - ETA: 39s - loss: 4.3156 - acc: 0.032650/64 [======================>.......] - ETA: 36s - loss: 4.3147 - acc: 0.033151/64 [======================>.......] - ETA: 33s - loss: 4.3142 - acc: 0.033352/64 [=======================>......] - ETA: 30s - loss: 4.3137 - acc: 0.033353/64 [=======================>......] - ETA: 28s - loss: 4.3128 - acc: 0.033454/64 [========================>.....] - ETA: 25s - loss: 4.3116 - acc: 0.033855/64 [========================>.....] - ETA: 23s - loss: 4.3107 - acc: 0.034056/64 [=========================>....] - ETA: 20s - loss: 4.3099 - acc: 0.034157/64 [=========================>....] - ETA: 17s - loss: 4.3094 - acc: 0.034558/64 [==========================>...] - ETA: 15s - loss: 4.3087 - acc: 0.034559/64 [==========================>...] - ETA: 12s - loss: 4.3079 - acc: 0.035260/64 [===========================>..] - ETA: 10s - loss: 4.3072 - acc: 0.035461/64 [===========================>..] - ETA: 7s - loss: 4.3061 - acc: 0.0358 62/64 [============================>.] - ETA: 5s - loss: 4.3051 - acc: 0.036363/64 [============================>.] - ETA: 2s - loss: 4.3045 - acc: 0.036664/64 [==============================] - 161s 3s/step - loss: 4.3040 - acc: 0.0366
Finished Epoch 0
