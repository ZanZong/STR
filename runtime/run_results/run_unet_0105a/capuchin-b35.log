WARNING:tensorflow:From ../run_training.py:27: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

WARNING:tensorflow:From ../run_training.py:27: The name tf.ConfigProto is deprecated. Please use tf.compat.v1.ConfigProto instead.

WARNING:tensorflow:From ../run_training.py:27: The name tf.GPUOptions is deprecated. Please use tf.compat.v1.GPUOptions instead.

WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1630: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
1 Physical GPUs, 1 Logical GPUs
Parsing arguments: [('batch_size', 35), ('epochs', 1), ('model_name', 'vgg_unet'), ('strategy', 'capuchin'), ('verbose', False)]
Cannot find config for batch_size=35, use 40 instead
There are 367 and 367 images downloaded for train and test
Verifying train dataset
  0%|          | 0/367 [00:00<?, ?it/s]  2%|▏         | 8/367 [00:00<00:04, 79.38it/s]  5%|▌         | 20/367 [00:00<00:03, 101.04it/s]  9%|▉         | 33/367 [00:00<00:02, 113.44it/s] 13%|█▎        | 47/367 [00:00<00:02, 121.01it/s] 16%|█▋        | 60/367 [00:00<00:02, 123.82it/s] 20%|█▉        | 73/367 [00:00<00:02, 125.68it/s] 23%|██▎       | 86/367 [00:00<00:02, 126.44it/s] 27%|██▋       | 100/367 [00:00<00:02, 128.66it/s] 31%|███▏      | 115/367 [00:00<00:01, 133.87it/s] 36%|███▌      | 131/367 [00:01<00:01, 141.59it/s] 40%|████      | 147/367 [00:01<00:01, 146.63it/s] 45%|████▍     | 164/367 [00:01<00:01, 151.02it/s] 49%|████▉     | 181/367 [00:01<00:01, 154.67it/s] 54%|█████▍    | 198/367 [00:01<00:01, 157.54it/s] 58%|█████▊    | 214/367 [00:01<00:00, 157.49it/s] 63%|██████▎   | 231/367 [00:01<00:00, 158.58it/s] 68%|██████▊   | 248/367 [00:01<00:00, 159.32it/s] 72%|███████▏  | 265/367 [00:01<00:00, 160.33it/s] 77%|███████▋  | 282/367 [00:01<00:00, 160.29it/s] 81%|████████▏ | 299/367 [00:02<00:00, 160.68it/s] 86%|████████▌ | 316/367 [00:02<00:00, 161.38it/s] 91%|█████████ | 333/367 [00:02<00:00, 161.68it/s] 95%|█████████▌| 350/367 [00:02<00:00, 160.96it/s]100%|██████████| 367/367 [00:02<00:00, 161.03it/s]100%|██████████| 367/367 [00:02<00:00, 147.51it/s]
WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/stropt/lms.py:970: The name tf.train.SessionRunHook is deprecated. Please use tf.estimator.SessionRunHook instead.

WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/stropt/str_strategy.py:122: get_backward_walk_ops (from tensorflow.contrib.graph_editor.select) is deprecated and will be removed after 2019-06-06.
Instructions for updating:
Please use tensorflow.python.ops.op_selector.get_backward_walk_ops.
WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/math_grad.py:1424: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/stropt/lms.py:928: The name tf.logging.info is deprecated. Please use tf.compat.v1.logging.info instead.

2022-01-05 01:40:10.740626: W tensorflow/core/common_runtime/bfc_allocator.cc:239] Allocator (GPU_0_bfc) ran out of memory trying to allocate 3.86GiB with freed_by_count=0. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
2022-01-05 01:40:10.740700: W tensorflow/core/common_runtime/bfc_allocator.cc:239] Allocator (GPU_0_bfc) ran out of memory trying to allocate 3.86GiB with freed_by_count=0. The caller indicates that this is not a failure, but may mean that there could be performance gains if more memory were available.
Dataset verified! 
Starting Epoch  0
[STR DEBUG] Parsing STR configuration: [{'strategy': 'hybrid', 'verbose': 'false', 'tags': '/home/zongzan/dist_dnn_training/STR/optimizer/logs/vgg_unet_40/layer_names'}, {'r': '/home/zongzan/dist_dnn_training/STR/optimizer/logs/vgg_unet_40/R-capuchin', 'p': '/home/zongzan/dist_dnn_training/STR/optimizer/logs/vgg_unet_40/P-capuchin', 'q': '/home/zongzan/dist_dnn_training/STR/optimizer/logs/vgg_unet_40/Q-capuchin'}]
[STR DEBUG] Processing layer 28's swapping, swap out at [30], swap in at [41]
[STR DEBUG] Cannot find swap-out activation nodes for layer 28 among [<tf.Operation 'up_sampling2d_2/strided_slice/stack_2' type=Const>, <tf.Operation 'up_sampling2d_2/strided_slice/stack' type=Const>, <tf.Operation 'up_sampling2d_2/Const' type=Const>, <tf.Operation 'up_sampling2d_2/Shape' type=Shape>, <tf.Operation 'up_sampling2d_2/strided_slice/stack_1' type=Const>, <tf.Operation 'up_sampling2d_2/strided_slice' type=StridedSlice>, <tf.Operation 'up_sampling2d_2/mul' type=Mul>, <tf.Operation 'up_sampling2d_2/resize/ResizeNearestNeighbor' type=ResizeNearestNeighbor>]
[STR DEBUG] Processing layer 29's swapping, swap out at [31], swap in at [40]
[STR DEBUG] Cannot find swap-out activation nodes for layer 29 among [<tf.Operation 'concatenate_2/concat/axis' type=Const>, <tf.Operation 'concatenate_2/concat' type=ConcatV2>]
[STR DEBUG] Processing layer 31's swapping, swap out at [34], swap in at [38]
[STR DEBUG] Cannot find swap-out activation nodes for layer 31 among [<tf.Operation 'conv2d_3/BiasAdd' type=BiasAdd>, <tf.Operation 'conv2d_3/BiasAdd/ReadVariableOp' type=ReadVariableOp>, <tf.Operation 'conv2d_3/Conv2D/ReadVariableOp' type=ReadVariableOp>, <tf.Operation 'conv2d_3/dilation_rate' type=Const>, <tf.Operation 'conv2d_3/kernel/Initializer/random_uniform/shape' type=Const>, <tf.Operation 'conv2d_3/kernel/Initializer/random_uniform/min' type=Const>, <tf.Operation 'conv2d_3/kernel/Initializer/random_uniform/max' type=Const>, <tf.Operation 'conv2d_3/kernel/Initializer/random_uniform/RandomUniform' type=RandomUniform>, <tf.Operation 'conv2d_3/kernel/Initializer/random_uniform/sub' type=Sub>, <tf.Operation 'conv2d_3/kernel/Initializer/random_uniform/mul' type=Mul>, <tf.Operation 'conv2d_3/kernel/Initializer/random_uniform' type=Add>, <tf.Operation 'conv2d_3/kernel' type=VarHandleOp>, <tf.Operation 'conv2d_3/kernel/IsInitialized/VarIsInitializedOp' type=VarIsInitializedOp>, <tf.Operation 'conv2d_3/kernel/Read/ReadVariableOp' type=ReadVariableOp>, <tf.Operation 'conv2d_3/kernel/Assign' type=AssignVariableOp>, <tf.Operation 'conv2d_3/bias/Initializer/zeros' type=Const>, <tf.Operation 'conv2d_3/bias' type=VarHandleOp>, <tf.Operation 'conv2d_3/bias/IsInitialized/VarIsInitializedOp' type=VarIsInitializedOp>, <tf.Operation 'conv2d_3/bias/Read/ReadVariableOp' type=ReadVariableOp>, <tf.Operation 'conv2d_3/Conv2D' type=Conv2D>, <tf.Operation 'conv2d_3/bias/Assign' type=AssignVariableOp>]
[STR DEBUG] Processing layer 33's swapping, swap out at [35], swap in at [36]
[STR DEBUG] Cannot find swap-out activation nodes for layer 33 among [<tf.Operation 'conv2d_4/kernel/Initializer/random_uniform/shape' type=Const>, <tf.Operation 'conv2d_4/kernel/Initializer/random_uniform/min' type=Const>, <tf.Operation 'conv2d_4/kernel/Initializer/random_uniform/max' type=Const>, <tf.Operation 'conv2d_4/kernel/Initializer/random_uniform/RandomUniform' type=RandomUniform>, <tf.Operation 'conv2d_4/kernel/Initializer/random_uniform/sub' type=Sub>, <tf.Operation 'conv2d_4/kernel/Initializer/random_uniform' type=Add>, <tf.Operation 'conv2d_4/kernel/Initializer/random_uniform/mul' type=Mul>, <tf.Operation 'conv2d_4/kernel' type=VarHandleOp>, <tf.Operation 'conv2d_4/kernel/IsInitialized/VarIsInitializedOp' type=VarIsInitializedOp>, <tf.Operation 'conv2d_4/kernel/Read/ReadVariableOp' type=ReadVariableOp>, <tf.Operation 'conv2d_4/dilation_rate' type=Const>, <tf.Operation 'conv2d_4/kernel/Assign' type=AssignVariableOp>, <tf.Operation 'conv2d_4/bias/Initializer/zeros' type=Const>, <tf.Operation 'conv2d_4/bias' type=VarHandleOp>, <tf.Operation 'conv2d_4/bias/IsInitialized/VarIsInitializedOp' type=VarIsInitializedOp>, <tf.Operation 'conv2d_4/bias/Read/ReadVariableOp' type=ReadVariableOp>, <tf.Operation 'conv2d_4/bias/Assign' type=AssignVariableOp>, <tf.Operation 'conv2d_4/Conv2D' type=Conv2D>, <tf.Operation 'conv2d_4/BiasAdd' type=BiasAdd>, <tf.Operation 'conv2d_4/BiasAdd/ReadVariableOp' type=ReadVariableOp>, <tf.Operation 'conv2d_4/Conv2D/ReadVariableOp' type=ReadVariableOp>]
 1/64 [..............................] - ETA: 25:29 - loss: 4.4833 - acc: 0.0127 2/64 [..............................] - ETA: 13:57 - loss: 4.4938 - acc: 0.0117 3/64 [>.............................] - ETA: 10:22 - loss: 4.4928 - acc: 0.0116 4/64 [>.............................] - ETA: 8:19 - loss: 4.4881 - acc: 0.0115  5/64 [=>............................] - ETA: 7:05 - loss: 4.4870 - acc: 0.0117 6/64 [=>............................] - ETA: 6:15 - loss: 4.4876 - acc: 0.0119 7/64 [==>...........................] - ETA: 5:39 - loss: 4.4806 - acc: 0.0121 8/64 [==>...........................] - ETA: 5:11 - loss: 4.4804 - acc: 0.0125 9/64 [===>..........................] - ETA: 4:47 - loss: 4.4786 - acc: 0.012410/64 [===>..........................] - ETA: 4:28 - loss: 4.4796 - acc: 0.012411/64 [====>.........................] - ETA: 4:12 - loss: 4.4777 - acc: 0.012812/64 [====>.........................] - ETA: 4:00 - loss: 4.4765 - acc: 0.012813/64 [=====>........................] - ETA: 3:48 - loss: 4.4778 - acc: 0.012614/64 [=====>........................] - ETA: 3:38 - loss: 4.4772 - acc: 0.012615/64 [======>.......................] - ETA: 3:31 - loss: 4.4768 - acc: 0.012716/64 [======>.......................] - ETA: 3:25 - loss: 4.4750 - acc: 0.012817/64 [======>.......................] - ETA: 3:17 - loss: 4.4744 - acc: 0.012918/64 [=======>......................] - ETA: 3:09 - loss: 4.4715 - acc: 0.013119/64 [=======>......................] - ETA: 3:02 - loss: 4.4709 - acc: 0.013320/64 [========>.....................] - ETA: 2:56 - loss: 4.4707 - acc: 0.013321/64 [========>.....................] - ETA: 2:50 - loss: 4.4698 - acc: 0.013522/64 [=========>....................] - ETA: 2:44 - loss: 4.4688 - acc: 0.013623/64 [=========>....................] - ETA: 2:39 - loss: 4.4689 - acc: 0.013624/64 [==========>...................] - ETA: 2:34 - loss: 4.4684 - acc: 0.013525/64 [==========>...................] - ETA: 2:29 - loss: 4.4670 - acc: 0.013626/64 [===========>..................] - ETA: 2:24 - loss: 4.4664 - acc: 0.013727/64 [===========>..................] - ETA: 2:19 - loss: 4.4661 - acc: 0.013828/64 [============>.................] - ETA: 2:14 - loss: 4.4639 - acc: 0.013929/64 [============>.................] - ETA: 2:09 - loss: 4.4635 - acc: 0.014130/64 [=============>................] - ETA: 2:05 - loss: 4.4621 - acc: 0.014131/64 [=============>................] - ETA: 2:01 - loss: 4.4620 - acc: 0.014232/64 [==============>...............] - ETA: 1:57 - loss: 4.4608 - acc: 0.014433/64 [==============>...............] - ETA: 1:53 - loss: 4.4595 - acc: 0.014534/64 [==============>...............] - ETA: 1:49 - loss: 4.4596 - acc: 0.014435/64 [===============>..............] - ETA: 1:44 - loss: 4.4589 - acc: 0.014536/64 [===============>..............] - ETA: 1:40 - loss: 4.4583 - acc: 0.014637/64 [================>.............] - ETA: 1:36 - loss: 4.4570 - acc: 0.014738/64 [================>.............] - ETA: 1:32 - loss: 4.4563 - acc: 0.014839/64 [=================>............] - ETA: 1:28 - loss: 4.4545 - acc: 0.015040/64 [=================>............] - ETA: 1:24 - loss: 4.4538 - acc: 0.015241/64 [==================>...........] - ETA: 1:20 - loss: 4.4533 - acc: 0.015242/64 [==================>...........] - ETA: 1:17 - loss: 4.4524 - acc: 0.015443/64 [===================>..........] - ETA: 1:13 - loss: 4.4514 - acc: 0.015644/64 [===================>..........] - ETA: 1:09 - loss: 4.4511 - acc: 0.015645/64 [====================>.........] - ETA: 1:05 - loss: 4.4505 - acc: 0.015646/64 [====================>.........] - ETA: 1:02 - loss: 4.4493 - acc: 0.015847/64 [=====================>........] - ETA: 58s - loss: 4.4486 - acc: 0.0159 48/64 [=====================>........] - ETA: 54s - loss: 4.4481 - acc: 0.016049/64 [=====================>........] - ETA: 51s - loss: 4.4466 - acc: 0.016250/64 [======================>.......] - ETA: 47s - loss: 4.4460 - acc: 0.016451/64 [======================>.......] - ETA: 43s - loss: 4.4447 - acc: 0.016552/64 [=======================>......] - ETA: 40s - loss: 4.4443 - acc: 0.016653/64 [=======================>......] - ETA: 36s - loss: 4.4431 - acc: 0.016954/64 [========================>.....] - ETA: 33s - loss: 4.4422 - acc: 0.017055/64 [========================>.....] - ETA: 30s - loss: 4.4418 - acc: 0.016956/64 [=========================>....] - ETA: 26s - loss: 4.4411 - acc: 0.017157/64 [=========================>....] - ETA: 23s - loss: 4.4404 - acc: 0.017358/64 [==========================>...] - ETA: 19s - loss: 4.4394 - acc: 0.017459/64 [==========================>...] - ETA: 16s - loss: 4.4384 - acc: 0.017560/64 [===========================>..] - ETA: 13s - loss: 4.4371 - acc: 0.017761/64 [===========================>..] - ETA: 9s - loss: 4.4363 - acc: 0.0180 62/64 [============================>.] - ETA: 6s - loss: 4.4357 - acc: 0.018063/64 [============================>.] - ETA: 3s - loss: 4.4348 - acc: 0.018364/64 [==============================] - 212s 3s/step - loss: 4.4339 - acc: 0.0185
Finished Epoch 0
