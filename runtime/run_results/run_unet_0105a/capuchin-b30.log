WARNING:tensorflow:From ../run_training.py:27: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

WARNING:tensorflow:From ../run_training.py:27: The name tf.ConfigProto is deprecated. Please use tf.compat.v1.ConfigProto instead.

WARNING:tensorflow:From ../run_training.py:27: The name tf.GPUOptions is deprecated. Please use tf.compat.v1.GPUOptions instead.

WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1630: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
1 Physical GPUs, 1 Logical GPUs
Parsing arguments: [('batch_size', 30), ('epochs', 1), ('model_name', 'vgg_unet'), ('strategy', 'capuchin'), ('verbose', False)]
Cannot find config for batch_size=30, use 40 instead
There are 367 and 367 images downloaded for train and test
Verifying train dataset
  0%|          | 0/367 [00:00<?, ?it/s]  4%|▎         | 13/367 [00:00<00:02, 120.89it/s]  7%|▋         | 26/367 [00:00<00:02, 122.71it/s] 11%|█         | 39/367 [00:00<00:02, 124.75it/s] 14%|█▍        | 53/367 [00:00<00:02, 128.54it/s] 19%|█▉        | 69/367 [00:00<00:02, 136.67it/s] 23%|██▎       | 85/367 [00:00<00:01, 142.64it/s] 28%|██▊       | 101/367 [00:00<00:01, 146.89it/s] 32%|███▏      | 116/367 [00:00<00:01, 147.35it/s] 36%|███▌      | 132/367 [00:00<00:01, 148.97it/s] 40%|████      | 148/367 [00:01<00:01, 149.80it/s] 45%|████▍     | 164/367 [00:01<00:01, 151.44it/s] 49%|████▉     | 180/367 [00:01<00:01, 153.15it/s] 53%|█████▎    | 196/367 [00:01<00:01, 153.71it/s] 58%|█████▊    | 212/367 [00:01<00:01, 153.17it/s] 62%|██████▏   | 228/367 [00:01<00:00, 152.08it/s] 66%|██████▋   | 244/367 [00:01<00:00, 153.18it/s] 71%|███████   | 260/367 [00:01<00:00, 154.34it/s] 75%|███████▌  | 276/367 [00:01<00:00, 152.87it/s] 80%|███████▉  | 292/367 [00:01<00:00, 154.29it/s] 84%|████████▍ | 308/367 [00:02<00:00, 154.52it/s] 88%|████████▊ | 324/367 [00:02<00:00, 154.76it/s] 93%|█████████▎| 340/367 [00:02<00:00, 155.00it/s] 97%|█████████▋| 356/367 [00:02<00:00, 154.02it/s]100%|██████████| 367/367 [00:02<00:00, 149.03it/s]
WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/stropt/lms.py:970: The name tf.train.SessionRunHook is deprecated. Please use tf.estimator.SessionRunHook instead.

WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/stropt/str_strategy.py:122: get_backward_walk_ops (from tensorflow.contrib.graph_editor.select) is deprecated and will be removed after 2019-06-06.
Instructions for updating:
Please use tensorflow.python.ops.op_selector.get_backward_walk_ops.
WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/math_grad.py:1424: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/stropt/lms.py:928: The name tf.logging.info is deprecated. Please use tf.compat.v1.logging.info instead.

Dataset verified! 
Starting Epoch  0
[STR DEBUG] Parsing STR configuration: [{'strategy': 'hybrid', 'verbose': 'false', 'tags': '/home/zongzan/dist_dnn_training/STR/optimizer/logs/vgg_unet_40/layer_names'}, {'r': '/home/zongzan/dist_dnn_training/STR/optimizer/logs/vgg_unet_40/R-capuchin', 'p': '/home/zongzan/dist_dnn_training/STR/optimizer/logs/vgg_unet_40/P-capuchin', 'q': '/home/zongzan/dist_dnn_training/STR/optimizer/logs/vgg_unet_40/Q-capuchin'}]
[STR DEBUG] Processing layer 28's swapping, swap out at [30], swap in at [41]
[STR DEBUG] Cannot find swap-out activation nodes for layer 28 among [<tf.Operation 'up_sampling2d_2/Const' type=Const>, <tf.Operation 'up_sampling2d_2/Shape' type=Shape>, <tf.Operation 'up_sampling2d_2/strided_slice/stack_1' type=Const>, <tf.Operation 'up_sampling2d_2/strided_slice/stack' type=Const>, <tf.Operation 'up_sampling2d_2/strided_slice' type=StridedSlice>, <tf.Operation 'up_sampling2d_2/mul' type=Mul>, <tf.Operation 'up_sampling2d_2/resize/ResizeNearestNeighbor' type=ResizeNearestNeighbor>, <tf.Operation 'up_sampling2d_2/strided_slice/stack_2' type=Const>]
[STR DEBUG] Processing layer 29's swapping, swap out at [31], swap in at [40]
[STR DEBUG] Cannot find swap-out activation nodes for layer 29 among [<tf.Operation 'concatenate_2/concat/axis' type=Const>, <tf.Operation 'concatenate_2/concat' type=ConcatV2>]
[STR DEBUG] Processing layer 31's swapping, swap out at [34], swap in at [38]
[STR DEBUG] Cannot find swap-out activation nodes for layer 31 among [<tf.Operation 'conv2d_3/kernel/IsInitialized/VarIsInitializedOp' type=VarIsInitializedOp>, <tf.Operation 'conv2d_3/kernel/Read/ReadVariableOp' type=ReadVariableOp>, <tf.Operation 'conv2d_3/kernel/Assign' type=AssignVariableOp>, <tf.Operation 'conv2d_3/bias/Initializer/zeros' type=Const>, <tf.Operation 'conv2d_3/bias' type=VarHandleOp>, <tf.Operation 'conv2d_3/bias/IsInitialized/VarIsInitializedOp' type=VarIsInitializedOp>, <tf.Operation 'conv2d_3/Conv2D' type=Conv2D>, <tf.Operation 'conv2d_3/bias/Read/ReadVariableOp' type=ReadVariableOp>, <tf.Operation 'conv2d_3/bias/Assign' type=AssignVariableOp>, <tf.Operation 'conv2d_3/BiasAdd' type=BiasAdd>, <tf.Operation 'conv2d_3/BiasAdd/ReadVariableOp' type=ReadVariableOp>, <tf.Operation 'conv2d_3/Conv2D/ReadVariableOp' type=ReadVariableOp>, <tf.Operation 'conv2d_3/dilation_rate' type=Const>, <tf.Operation 'conv2d_3/kernel/Initializer/random_uniform/shape' type=Const>, <tf.Operation 'conv2d_3/kernel/Initializer/random_uniform/min' type=Const>, <tf.Operation 'conv2d_3/kernel' type=VarHandleOp>, <tf.Operation 'conv2d_3/kernel/Initializer/random_uniform/max' type=Const>, <tf.Operation 'conv2d_3/kernel/Initializer/random_uniform/RandomUniform' type=RandomUniform>, <tf.Operation 'conv2d_3/kernel/Initializer/random_uniform/sub' type=Sub>, <tf.Operation 'conv2d_3/kernel/Initializer/random_uniform/mul' type=Mul>, <tf.Operation 'conv2d_3/kernel/Initializer/random_uniform' type=Add>]
[STR DEBUG] Processing layer 33's swapping, swap out at [35], swap in at [36]
[STR DEBUG] Cannot find swap-out activation nodes for layer 33 among [<tf.Operation 'conv2d_4/kernel/Assign' type=AssignVariableOp>, <tf.Operation 'conv2d_4/bias/Initializer/zeros' type=Const>, <tf.Operation 'conv2d_4/bias' type=VarHandleOp>, <tf.Operation 'conv2d_4/bias/IsInitialized/VarIsInitializedOp' type=VarIsInitializedOp>, <tf.Operation 'conv2d_4/bias/Read/ReadVariableOp' type=ReadVariableOp>, <tf.Operation 'conv2d_4/bias/Assign' type=AssignVariableOp>, <tf.Operation 'conv2d_4/Conv2D' type=Conv2D>, <tf.Operation 'conv2d_4/BiasAdd' type=BiasAdd>, <tf.Operation 'conv2d_4/BiasAdd/ReadVariableOp' type=ReadVariableOp>, <tf.Operation 'conv2d_4/Conv2D/ReadVariableOp' type=ReadVariableOp>, <tf.Operation 'conv2d_4/kernel/Initializer/random_uniform/shape' type=Const>, <tf.Operation 'conv2d_4/kernel/Initializer/random_uniform/min' type=Const>, <tf.Operation 'conv2d_4/kernel' type=VarHandleOp>, <tf.Operation 'conv2d_4/kernel/Initializer/random_uniform/max' type=Const>, <tf.Operation 'conv2d_4/kernel/Initializer/random_uniform/RandomUniform' type=RandomUniform>, <tf.Operation 'conv2d_4/kernel/Initializer/random_uniform/sub' type=Sub>, <tf.Operation 'conv2d_4/kernel/Initializer/random_uniform' type=Add>, <tf.Operation 'conv2d_4/kernel/Initializer/random_uniform/mul' type=Mul>, <tf.Operation 'conv2d_4/kernel/IsInitialized/VarIsInitializedOp' type=VarIsInitializedOp>, <tf.Operation 'conv2d_4/kernel/Read/ReadVariableOp' type=ReadVariableOp>, <tf.Operation 'conv2d_4/dilation_rate' type=Const>]
 1/64 [..............................] - ETA: 22:54 - loss: 4.4742 - acc: 0.0141 2/64 [..............................] - ETA: 12:28 - loss: 4.4969 - acc: 0.0133 3/64 [>.............................] - ETA: 8:55 - loss: 4.5052 - acc: 0.0140  4/64 [>.............................] - ETA: 7:09 - loss: 4.5051 - acc: 0.0146 5/64 [=>............................] - ETA: 6:04 - loss: 4.4985 - acc: 0.0142 6/64 [=>............................] - ETA: 5:21 - loss: 4.4952 - acc: 0.0144 7/64 [==>...........................] - ETA: 4:48 - loss: 4.4956 - acc: 0.0148 8/64 [==>...........................] - ETA: 4:23 - loss: 4.4920 - acc: 0.0148 9/64 [===>..........................] - ETA: 4:03 - loss: 4.4916 - acc: 0.014810/64 [===>..........................] - ETA: 3:47 - loss: 4.4893 - acc: 0.014811/64 [====>.........................] - ETA: 3:33 - loss: 4.4941 - acc: 0.014512/64 [====>.........................] - ETA: 3:21 - loss: 4.4922 - acc: 0.014513/64 [=====>........................] - ETA: 3:11 - loss: 4.4895 - acc: 0.014614/64 [=====>........................] - ETA: 3:02 - loss: 4.4890 - acc: 0.014415/64 [======>.......................] - ETA: 2:54 - loss: 4.4919 - acc: 0.014516/64 [======>.......................] - ETA: 2:46 - loss: 4.4913 - acc: 0.014717/64 [======>.......................] - ETA: 2:40 - loss: 4.4886 - acc: 0.014618/64 [=======>......................] - ETA: 2:33 - loss: 4.4867 - acc: 0.014519/64 [=======>......................] - ETA: 2:27 - loss: 4.4867 - acc: 0.014720/64 [========>.....................] - ETA: 2:22 - loss: 4.4851 - acc: 0.014821/64 [========>.....................] - ETA: 2:17 - loss: 4.4851 - acc: 0.014822/64 [=========>....................] - ETA: 2:12 - loss: 4.4831 - acc: 0.014823/64 [=========>....................] - ETA: 2:08 - loss: 4.4840 - acc: 0.014624/64 [==========>...................] - ETA: 2:04 - loss: 4.4837 - acc: 0.014625/64 [==========>...................] - ETA: 2:00 - loss: 4.4818 - acc: 0.014726/64 [===========>..................] - ETA: 1:56 - loss: 4.4811 - acc: 0.014727/64 [===========>..................] - ETA: 1:51 - loss: 4.4812 - acc: 0.014628/64 [============>.................] - ETA: 1:48 - loss: 4.4813 - acc: 0.014729/64 [============>.................] - ETA: 1:45 - loss: 4.4795 - acc: 0.014730/64 [=============>................] - ETA: 1:42 - loss: 4.4780 - acc: 0.014631/64 [=============>................] - ETA: 1:38 - loss: 4.4779 - acc: 0.014732/64 [==============>...............] - ETA: 1:34 - loss: 4.4767 - acc: 0.014833/64 [==============>...............] - ETA: 1:31 - loss: 4.4760 - acc: 0.014834/64 [==============>...............] - ETA: 1:28 - loss: 4.4752 - acc: 0.014835/64 [===============>..............] - ETA: 1:25 - loss: 4.4738 - acc: 0.014736/64 [===============>..............] - ETA: 1:21 - loss: 4.4744 - acc: 0.014737/64 [================>.............] - ETA: 1:18 - loss: 4.4730 - acc: 0.014838/64 [================>.............] - ETA: 1:15 - loss: 4.4715 - acc: 0.014739/64 [=================>............] - ETA: 1:12 - loss: 4.4719 - acc: 0.014740/64 [=================>............] - ETA: 1:09 - loss: 4.4714 - acc: 0.014741/64 [==================>...........] - ETA: 1:06 - loss: 4.4702 - acc: 0.014742/64 [==================>...........] - ETA: 1:03 - loss: 4.4687 - acc: 0.014743/64 [===================>..........] - ETA: 1:00 - loss: 4.4683 - acc: 0.014744/64 [===================>..........] - ETA: 57s - loss: 4.4674 - acc: 0.0148 45/64 [====================>.........] - ETA: 54s - loss: 4.4661 - acc: 0.014846/64 [====================>.........] - ETA: 50s - loss: 4.4658 - acc: 0.014947/64 [=====================>........] - ETA: 47s - loss: 4.4644 - acc: 0.014848/64 [=====================>........] - ETA: 44s - loss: 4.4646 - acc: 0.014749/64 [=====================>........] - ETA: 41s - loss: 4.4636 - acc: 0.014850/64 [======================>.......] - ETA: 39s - loss: 4.4625 - acc: 0.014851/64 [======================>.......] - ETA: 36s - loss: 4.4619 - acc: 0.014852/64 [=======================>......] - ETA: 33s - loss: 4.4615 - acc: 0.014853/64 [=======================>......] - ETA: 30s - loss: 4.4611 - acc: 0.014854/64 [========================>.....] - ETA: 27s - loss: 4.4598 - acc: 0.014855/64 [========================>.....] - ETA: 24s - loss: 4.4586 - acc: 0.014856/64 [=========================>....] - ETA: 22s - loss: 4.4579 - acc: 0.014857/64 [=========================>....] - ETA: 19s - loss: 4.4565 - acc: 0.014858/64 [==========================>...] - ETA: 16s - loss: 4.4562 - acc: 0.014959/64 [==========================>...] - ETA: 13s - loss: 4.4546 - acc: 0.014960/64 [===========================>..] - ETA: 10s - loss: 4.4549 - acc: 0.014861/64 [===========================>..] - ETA: 8s - loss: 4.4538 - acc: 0.0148 62/64 [============================>.] - ETA: 5s - loss: 4.4525 - acc: 0.014863/64 [============================>.] - ETA: 2s - loss: 4.4519 - acc: 0.014864/64 [==============================] - 174s 3s/step - loss: 4.4518 - acc: 0.0148
Finished Epoch 0
