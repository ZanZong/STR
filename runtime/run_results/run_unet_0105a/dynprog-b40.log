WARNING:tensorflow:From ../run_training.py:27: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

WARNING:tensorflow:From ../run_training.py:27: The name tf.ConfigProto is deprecated. Please use tf.compat.v1.ConfigProto instead.

WARNING:tensorflow:From ../run_training.py:27: The name tf.GPUOptions is deprecated. Please use tf.compat.v1.GPUOptions instead.

WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1630: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
1 Physical GPUs, 1 Logical GPUs
Parsing arguments: [('batch_size', 40), ('epochs', 1), ('model_name', 'vgg_unet'), ('strategy', 'dynprog'), ('verbose', False)]
There are 367 and 367 images downloaded for train and test
Verifying train dataset
  0%|          | 0/367 [00:00<?, ?it/s]  4%|▎         | 13/367 [00:00<00:02, 125.50it/s]  7%|▋         | 26/367 [00:00<00:02, 126.03it/s] 11%|█         | 39/367 [00:00<00:02, 127.09it/s] 14%|█▍        | 53/367 [00:00<00:02, 129.29it/s] 19%|█▉        | 69/367 [00:00<00:02, 137.50it/s] 23%|██▎       | 85/367 [00:00<00:01, 144.89it/s] 28%|██▊       | 102/367 [00:00<00:01, 150.77it/s] 32%|███▏      | 118/367 [00:00<00:01, 153.30it/s] 37%|███▋      | 134/367 [00:00<00:01, 155.32it/s] 41%|████      | 150/367 [00:01<00:01, 156.09it/s] 45%|████▌     | 166/367 [00:01<00:01, 157.18it/s] 50%|████▉     | 182/367 [00:01<00:01, 157.86it/s] 54%|█████▍    | 198/367 [00:01<00:01, 156.74it/s] 58%|█████▊    | 214/367 [00:01<00:00, 155.45it/s] 63%|██████▎   | 230/367 [00:01<00:00, 153.73it/s] 67%|██████▋   | 246/367 [00:01<00:00, 153.52it/s] 71%|███████▏  | 262/367 [00:01<00:00, 155.12it/s] 76%|███████▌  | 278/367 [00:01<00:00, 153.38it/s] 80%|████████  | 294/367 [00:01<00:00, 153.62it/s] 84%|████████▍ | 310/367 [00:02<00:00, 152.78it/s] 89%|████████▉ | 326/367 [00:02<00:00, 153.34it/s] 93%|█████████▎| 342/367 [00:02<00:00, 153.96it/s] 98%|█████████▊| 358/367 [00:02<00:00, 154.16it/s]100%|██████████| 367/367 [00:02<00:00, 150.97it/s]
WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/stropt/lms.py:970: The name tf.train.SessionRunHook is deprecated. Please use tf.estimator.SessionRunHook instead.

WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/math_grad.py:1424: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/stropt/lms.py:928: The name tf.logging.info is deprecated. Please use tf.compat.v1.logging.info instead.

WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/contrib/graph_editor/select.py:554: get_backward_walk_ops (from tensorflow.contrib.graph_editor.select) is deprecated and will be removed after 2019-06-06.
Instructions for updating:
Please use tensorflow.python.ops.op_selector.get_backward_walk_ops.
Dataset verified! 
Starting Epoch  0
[STR DEBUG] Parsing STR configuration: [{'strategy': 'swap', 'verbose': 'true', 'tags': '/home/zongzan/dist_dnn_training/STR/optimizer/logs/VGG16_250/layer_names'}, {'p': '/home/zongzan/dist_dnn_training/STR/optimizer/logs/VGG16_250/P-dynprog', 'q': '/home/zongzan/dist_dnn_training/STR/optimizer/logs/VGG16_250/Q-dynprog'}]
[STR DEBUG] Use swap strategy of DYNPROG
[STR DEBUG] Processing layer 2's swapping, swap out at [3], swap in at [41]
[STR DEBUG] Find swapout ops: name: "block1_conv2/Relu"
op: "Relu"
input: "block1_conv2/BiasAdd"
attr {
  key: "T"
  value {
    type: DT_FLOAT
  }
}
, 
	choose swap tensor Tensor("block1_conv2/Relu:0", shape=(?, 320, 640, 64), dtype=float32), 
	finish at the end of ops: [<tf.Operation 'block1_pool/MaxPool' type=MaxPool>]
[STR DEBUG] Add swap-in op at name: "training/Adadelta/gradients/gradients/block1_pool/MaxPool_grad/MaxPoolGrad"
op: "MaxPoolGrad"
input: "block1_conv2/Relu"
input: "block1_pool/MaxPool"
input: "training/Adadelta/gradients/gradients/AddN_17"
attr {
  key: "T"
  value {
    type: DT_FLOAT
  }
}
attr {
  key: "data_format"
  value {
    s: "NHWC"
  }
}
attr {
  key: "ksize"
  value {
    list {
      i: 1
      i: 2
      i: 2
      i: 1
    }
  }
}
attr {
  key: "padding"
  value {
    s: "VALID"
  }
}
attr {
  key: "strides"
  value {
    list {
      i: 1
      i: 2
      i: 2
      i: 1
    }
  }
}
 for consumer [<tf.Operation 'training/Adadelta/gradients/gradients/block1_conv2/Relu_grad/ReluGrad' type=ReluGrad>]
[STR DEBUG] Processing layer 5's swapping, swap out at [6], swap in at [38]
[STR DEBUG] Find swapout ops: name: "block2_conv2/Relu"
op: "Relu"
input: "block2_conv2/BiasAdd"
attr {
  key: "T"
  value {
    type: DT_FLOAT
  }
}
, 
	choose swap tensor Tensor("block2_conv2/Relu:0", shape=(?, 160, 320, 128), dtype=float32), 
	finish at the end of ops: [<tf.Operation 'block2_pool/MaxPool' type=MaxPool>]
[STR DEBUG] Add swap-in op at name: "training/Adadelta/gradients/gradients/block2_pool/MaxPool_grad/MaxPoolGrad"
op: "MaxPoolGrad"
input: "block2_conv2/Relu"
input: "block2_pool/MaxPool"
input: "training/Adadelta/gradients/gradients/AddN_16"
attr {
  key: "T"
  value {
    type: DT_FLOAT
  }
}
attr {
  key: "data_format"
  value {
    s: "NHWC"
  }
}
attr {
  key: "ksize"
  value {
    list {
      i: 1
      i: 2
      i: 2
      i: 1
    }
  }
}
attr {
  key: "padding"
  value {
    s: "VALID"
  }
}
attr {
  key: "strides"
  value {
    list {
      i: 1
      i: 2
      i: 2
      i: 1
    }
  }
}
 for consumer [<tf.Operation 'training/Adadelta/gradients/gradients/block2_conv2/Relu_grad/ReluGrad' type=ReluGrad>]
 1/64 [..............................] - ETA: 25:52 - loss: 4.5167 - acc: 0.0319 2/64 [..............................] - ETA: 14:16 - loss: 4.5324 - acc: 0.0265 3/64 [>.............................] - ETA: 10:19 - loss: 4.5448 - acc: 0.0245 4/64 [>.............................] - ETA: 8:21 - loss: 4.5431 - acc: 0.0241  5/64 [=>............................] - ETA: 7:09 - loss: 4.5354 - acc: 0.0251 6/64 [=>............................] - ETA: 6:22 - loss: 4.5261 - acc: 0.0251 7/64 [==>...........................] - ETA: 5:46 - loss: 4.5195 - acc: 0.0260 8/64 [==>...........................] - ETA: 5:19 - loss: 4.5237 - acc: 0.0267 9/64 [===>..........................] - ETA: 4:56 - loss: 4.5246 - acc: 0.027710/64 [===>..........................] - ETA: 4:38 - loss: 4.5231 - acc: 0.028411/64 [====>.........................] - ETA: 4:23 - loss: 4.5224 - acc: 0.028212/64 [====>.........................] - ETA: 4:10 - loss: 4.5249 - acc: 0.032413/64 [=====>........................] - ETA: 3:58 - loss: 4.5262 - acc: 0.032114/64 [=====>........................] - ETA: 3:47 - loss: 4.5242 - acc: 0.031815/64 [======>.......................] - ETA: 3:37 - loss: 4.5197 - acc: 0.031816/64 [======>.......................] - ETA: 3:28 - loss: 4.5169 - acc: 0.031917/64 [======>.......................] - ETA: 3:20 - loss: 4.5169 - acc: 0.032218/64 [=======>......................] - ETA: 3:12 - loss: 4.5174 - acc: 0.035119/64 [=======>......................] - ETA: 3:04 - loss: 4.5164 - acc: 0.035020/64 [========>.....................] - ETA: 2:58 - loss: 4.5162 - acc: 0.035221/64 [========>.....................] - ETA: 2:52 - loss: 4.5165 - acc: 0.037822/64 [=========>....................] - ETA: 2:46 - loss: 4.5169 - acc: 0.039923/64 [=========>....................] - ETA: 2:40 - loss: 4.5157 - acc: 0.039724/64 [==========>...................] - ETA: 2:35 - loss: 4.5129 - acc: 0.039625/64 [==========>...................] - ETA: 2:29 - loss: 4.5104 - acc: 0.039526/64 [===========>..................] - ETA: 2:24 - loss: 4.5097 - acc: 0.039427/64 [===========>..................] - ETA: 2:19 - loss: 4.5102 - acc: 0.041428/64 [============>.................] - ETA: 2:14 - loss: 4.5089 - acc: 0.041429/64 [============>.................] - ETA: 2:09 - loss: 4.5090 - acc: 0.043730/64 [=============>................] - ETA: 2:05 - loss: 4.5085 - acc: 0.045331/64 [=============>................] - ETA: 2:01 - loss: 4.5086 - acc: 0.046832/64 [==============>...............] - ETA: 1:57 - loss: 4.5080 - acc: 0.048233/64 [==============>...............] - ETA: 1:52 - loss: 4.5061 - acc: 0.048034/64 [==============>...............] - ETA: 1:48 - loss: 4.5037 - acc: 0.047735/64 [===============>..............] - ETA: 1:44 - loss: 4.5028 - acc: 0.049236/64 [===============>..............] - ETA: 1:40 - loss: 4.5030 - acc: 0.050637/64 [================>.............] - ETA: 1:36 - loss: 4.5020 - acc: 0.051838/64 [================>.............] - ETA: 1:32 - loss: 4.5014 - acc: 0.053539/64 [=================>............] - ETA: 1:28 - loss: 4.5010 - acc: 0.054740/64 [=================>............] - ETA: 1:24 - loss: 4.5008 - acc: 0.055641/64 [==================>...........] - ETA: 1:20 - loss: 4.5005 - acc: 0.056742/64 [==================>...........] - ETA: 1:17 - loss: 4.4987 - acc: 0.056543/64 [===================>..........] - ETA: 1:13 - loss: 4.4967 - acc: 0.056344/64 [===================>..........] - ETA: 1:09 - loss: 4.4954 - acc: 0.057245/64 [====================>.........] - ETA: 1:06 - loss: 4.4955 - acc: 0.058346/64 [====================>.........] - ETA: 1:02 - loss: 4.4946 - acc: 0.059247/64 [=====================>........] - ETA: 58s - loss: 4.4936 - acc: 0.0604 48/64 [=====================>........] - ETA: 55s - loss: 4.4933 - acc: 0.061549/64 [=====================>........] - ETA: 51s - loss: 4.4928 - acc: 0.062250/64 [======================>.......] - ETA: 48s - loss: 4.4925 - acc: 0.063051/64 [======================>.......] - ETA: 44s - loss: 4.4913 - acc: 0.063752/64 [=======================>......] - ETA: 41s - loss: 4.4895 - acc: 0.064853/64 [=======================>......] - ETA: 37s - loss: 4.4882 - acc: 0.065554/64 [========================>.....] - ETA: 34s - loss: 4.4877 - acc: 0.066355/64 [========================>.....] - ETA: 30s - loss: 4.4872 - acc: 0.067056/64 [=========================>....] - ETA: 27s - loss: 4.4861 - acc: 0.067957/64 [=========================>....] - ETA: 23s - loss: 4.4855 - acc: 0.068758/64 [==========================>...] - ETA: 20s - loss: 4.4855 - acc: 0.069259/64 [==========================>...] - ETA: 16s - loss: 4.4849 - acc: 0.069960/64 [===========================>..] - ETA: 13s - loss: 4.4838 - acc: 0.070461/64 [===========================>..] - ETA: 10s - loss: 4.4821 - acc: 0.071262/64 [============================>.] - ETA: 6s - loss: 4.4805 - acc: 0.0719 63/64 [============================>.] - ETA: 3s - loss: 4.4802 - acc: 0.072564/64 [==============================] - 214s 3s/step - loss: 4.4796 - acc: 0.0730
Finished Epoch 0
