WARNING:tensorflow:From ../run_training.py:27: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

WARNING:tensorflow:From ../run_training.py:27: The name tf.ConfigProto is deprecated. Please use tf.compat.v1.ConfigProto instead.

WARNING:tensorflow:From ../run_training.py:27: The name tf.GPUOptions is deprecated. Please use tf.compat.v1.GPUOptions instead.

WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1630: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
1 Physical GPUs, 1 Logical GPUs
Parsing arguments: [('batch_size', 35), ('epochs', 1), ('model_name', 'vgg_unet'), ('strategy', 'dynprog'), ('verbose', False)]
Cannot find config for batch_size=35, use 40 instead
There are 367 and 367 images downloaded for train and test
Verifying train dataset
  0%|          | 0/367 [00:00<?, ?it/s]  3%|▎         | 11/367 [00:00<00:03, 104.93it/s]  7%|▋         | 24/367 [00:00<00:02, 117.15it/s] 10%|█         | 37/367 [00:00<00:02, 121.71it/s] 14%|█▍        | 51/367 [00:00<00:02, 126.24it/s] 17%|█▋        | 64/367 [00:00<00:02, 126.98it/s] 21%|██        | 77/367 [00:00<00:02, 127.92it/s] 25%|██▍       | 91/367 [00:00<00:02, 129.34it/s] 29%|██▊       | 105/367 [00:00<00:02, 129.88it/s] 33%|███▎      | 122/367 [00:00<00:01, 139.79it/s] 38%|███▊      | 138/367 [00:01<00:01, 145.36it/s] 42%|████▏     | 154/367 [00:01<00:01, 149.41it/s] 47%|████▋     | 171/367 [00:01<00:01, 153.70it/s] 51%|█████     | 188/367 [00:01<00:01, 156.10it/s] 56%|█████▌    | 205/367 [00:01<00:01, 157.39it/s] 60%|██████    | 222/367 [00:01<00:00, 158.53it/s] 65%|██████▍   | 238/367 [00:01<00:00, 156.86it/s] 69%|██████▉   | 255/367 [00:01<00:00, 158.82it/s] 74%|███████▍  | 271/367 [00:01<00:00, 158.25it/s] 78%|███████▊  | 288/367 [00:01<00:00, 159.24it/s] 83%|████████▎ | 305/367 [00:02<00:00, 159.90it/s] 88%|████████▊ | 322/367 [00:02<00:00, 160.06it/s] 92%|█████████▏| 339/367 [00:02<00:00, 160.27it/s] 97%|█████████▋| 356/367 [00:02<00:00, 159.36it/s]100%|██████████| 367/367 [00:02<00:00, 148.72it/s]
WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/stropt/lms.py:970: The name tf.train.SessionRunHook is deprecated. Please use tf.estimator.SessionRunHook instead.

WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/math_grad.py:1424: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/stropt/lms.py:928: The name tf.logging.info is deprecated. Please use tf.compat.v1.logging.info instead.

WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/contrib/graph_editor/select.py:554: get_backward_walk_ops (from tensorflow.contrib.graph_editor.select) is deprecated and will be removed after 2019-06-06.
Instructions for updating:
Please use tensorflow.python.ops.op_selector.get_backward_walk_ops.
Dataset verified! 
Starting Epoch  0
[STR DEBUG] Parsing STR configuration: [{'strategy': 'swap', 'verbose': 'true', 'tags': '/home/zongzan/dist_dnn_training/STR/optimizer/logs/VGG16_250/layer_names'}, {'p': '/home/zongzan/dist_dnn_training/STR/optimizer/logs/VGG16_250/P-dynprog', 'q': '/home/zongzan/dist_dnn_training/STR/optimizer/logs/VGG16_250/Q-dynprog'}]
[STR DEBUG] Use swap strategy of DYNPROG
[STR DEBUG] Processing layer 2's swapping, swap out at [3], swap in at [41]
[STR DEBUG] Find swapout ops: name: "block1_conv2/Relu"
op: "Relu"
input: "block1_conv2/BiasAdd"
attr {
  key: "T"
  value {
    type: DT_FLOAT
  }
}
, 
	choose swap tensor Tensor("block1_conv2/Relu:0", shape=(?, 320, 640, 64), dtype=float32), 
	finish at the end of ops: [<tf.Operation 'block1_pool/MaxPool' type=MaxPool>]
[STR DEBUG] Add swap-in op at name: "training/Adadelta/gradients/gradients/block1_pool/MaxPool_grad/MaxPoolGrad"
op: "MaxPoolGrad"
input: "block1_conv2/Relu"
input: "block1_pool/MaxPool"
input: "training/Adadelta/gradients/gradients/AddN_17"
attr {
  key: "T"
  value {
    type: DT_FLOAT
  }
}
attr {
  key: "data_format"
  value {
    s: "NHWC"
  }
}
attr {
  key: "ksize"
  value {
    list {
      i: 1
      i: 2
      i: 2
      i: 1
    }
  }
}
attr {
  key: "padding"
  value {
    s: "VALID"
  }
}
attr {
  key: "strides"
  value {
    list {
      i: 1
      i: 2
      i: 2
      i: 1
    }
  }
}
 for consumer [<tf.Operation 'training/Adadelta/gradients/gradients/block1_conv2/Relu_grad/ReluGrad' type=ReluGrad>]
[STR DEBUG] Processing layer 5's swapping, swap out at [6], swap in at [38]
[STR DEBUG] Find swapout ops: name: "block2_conv2/Relu"
op: "Relu"
input: "block2_conv2/BiasAdd"
attr {
  key: "T"
  value {
    type: DT_FLOAT
  }
}
, 
	choose swap tensor Tensor("block2_conv2/Relu:0", shape=(?, 160, 320, 128), dtype=float32), 
	finish at the end of ops: [<tf.Operation 'block2_pool/MaxPool' type=MaxPool>]
[STR DEBUG] Add swap-in op at name: "training/Adadelta/gradients/gradients/block2_pool/MaxPool_grad/MaxPoolGrad"
op: "MaxPoolGrad"
input: "block2_conv2/Relu"
input: "block2_pool/MaxPool"
input: "training/Adadelta/gradients/gradients/AddN_16"
attr {
  key: "T"
  value {
    type: DT_FLOAT
  }
}
attr {
  key: "data_format"
  value {
    s: "NHWC"
  }
}
attr {
  key: "ksize"
  value {
    list {
      i: 1
      i: 2
      i: 2
      i: 1
    }
  }
}
attr {
  key: "padding"
  value {
    s: "VALID"
  }
}
attr {
  key: "strides"
  value {
    list {
      i: 1
      i: 2
      i: 2
      i: 1
    }
  }
}
 for consumer [<tf.Operation 'training/Adadelta/gradients/gradients/block2_conv2/Relu_grad/ReluGrad' type=ReluGrad>]
 1/64 [..............................] - ETA: 23:44 - loss: 4.5540 - acc: 0.0089 2/64 [..............................] - ETA: 12:56 - loss: 4.5535 - acc: 0.0089 3/64 [>.............................] - ETA: 9:21 - loss: 4.5529 - acc: 0.0089  4/64 [>.............................] - ETA: 7:30 - loss: 4.5519 - acc: 0.0091 5/64 [=>............................] - ETA: 6:23 - loss: 4.5534 - acc: 0.0090 6/64 [=>............................] - ETA: 5:38 - loss: 4.5534 - acc: 0.0088 7/64 [==>...........................] - ETA: 5:05 - loss: 4.5474 - acc: 0.0089 8/64 [==>...........................] - ETA: 4:41 - loss: 4.5442 - acc: 0.0089 9/64 [===>..........................] - ETA: 4:21 - loss: 4.5439 - acc: 0.009110/64 [===>..........................] - ETA: 4:04 - loss: 4.5460 - acc: 0.009111/64 [====>.........................] - ETA: 3:50 - loss: 4.5443 - acc: 0.009112/64 [====>.........................] - ETA: 3:39 - loss: 4.5437 - acc: 0.009113/64 [=====>........................] - ETA: 3:28 - loss: 4.5425 - acc: 0.009114/64 [=====>........................] - ETA: 3:18 - loss: 4.5422 - acc: 0.009115/64 [======>.......................] - ETA: 3:10 - loss: 4.5431 - acc: 0.009216/64 [======>.......................] - ETA: 3:02 - loss: 4.5411 - acc: 0.009117/64 [======>.......................] - ETA: 2:55 - loss: 4.5403 - acc: 0.009118/64 [=======>......................] - ETA: 2:48 - loss: 4.5372 - acc: 0.009119/64 [=======>......................] - ETA: 2:42 - loss: 4.5363 - acc: 0.009120/64 [========>.....................] - ETA: 2:35 - loss: 4.5369 - acc: 0.009221/64 [========>.....................] - ETA: 2:30 - loss: 4.5361 - acc: 0.009222/64 [=========>....................] - ETA: 2:25 - loss: 4.5353 - acc: 0.009223/64 [=========>....................] - ETA: 2:19 - loss: 4.5347 - acc: 0.009224/64 [==========>...................] - ETA: 2:16 - loss: 4.5339 - acc: 0.009225/64 [==========>...................] - ETA: 2:12 - loss: 4.5330 - acc: 0.009326/64 [===========>..................] - ETA: 2:07 - loss: 4.5326 - acc: 0.009227/64 [===========>..................] - ETA: 2:03 - loss: 4.5321 - acc: 0.009228/64 [============>.................] - ETA: 1:58 - loss: 4.5301 - acc: 0.009229/64 [============>.................] - ETA: 1:54 - loss: 4.5286 - acc: 0.009230/64 [=============>................] - ETA: 1:50 - loss: 4.5278 - acc: 0.009331/64 [=============>................] - ETA: 1:46 - loss: 4.5278 - acc: 0.009332/64 [==============>...............] - ETA: 1:43 - loss: 4.5267 - acc: 0.009333/64 [==============>...............] - ETA: 1:39 - loss: 4.5257 - acc: 0.009334/64 [==============>...............] - ETA: 1:35 - loss: 4.5248 - acc: 0.009335/64 [===============>..............] - ETA: 1:32 - loss: 4.5242 - acc: 0.009336/64 [===============>..............] - ETA: 1:29 - loss: 4.5241 - acc: 0.009337/64 [================>.............] - ETA: 1:25 - loss: 4.5227 - acc: 0.009338/64 [================>.............] - ETA: 1:22 - loss: 4.5218 - acc: 0.009339/64 [=================>............] - ETA: 1:18 - loss: 4.5201 - acc: 0.009340/64 [=================>............] - ETA: 1:15 - loss: 4.5192 - acc: 0.009341/64 [==================>...........] - ETA: 1:11 - loss: 4.5190 - acc: 0.009442/64 [==================>...........] - ETA: 1:08 - loss: 4.5182 - acc: 0.009443/64 [===================>..........] - ETA: 1:04 - loss: 4.5173 - acc: 0.009444/64 [===================>..........] - ETA: 1:01 - loss: 4.5165 - acc: 0.009445/64 [====================>.........] - ETA: 58s - loss: 4.5157 - acc: 0.0094 46/64 [====================>.........] - ETA: 54s - loss: 4.5148 - acc: 0.009447/64 [=====================>........] - ETA: 51s - loss: 4.5142 - acc: 0.009448/64 [=====================>........] - ETA: 48s - loss: 4.5135 - acc: 0.009449/64 [=====================>........] - ETA: 45s - loss: 4.5121 - acc: 0.009450/64 [======================>.......] - ETA: 42s - loss: 4.5110 - acc: 0.009451/64 [======================>.......] - ETA: 38s - loss: 4.5100 - acc: 0.009552/64 [=======================>......] - ETA: 35s - loss: 4.5096 - acc: 0.009553/64 [=======================>......] - ETA: 32s - loss: 4.5086 - acc: 0.009554/64 [========================>.....] - ETA: 29s - loss: 4.5077 - acc: 0.009555/64 [========================>.....] - ETA: 26s - loss: 4.5068 - acc: 0.009556/64 [=========================>....] - ETA: 23s - loss: 4.5061 - acc: 0.009557/64 [=========================>....] - ETA: 20s - loss: 4.5056 - acc: 0.009558/64 [==========================>...] - ETA: 17s - loss: 4.5045 - acc: 0.009559/64 [==========================>...] - ETA: 14s - loss: 4.5036 - acc: 0.009560/64 [===========================>..] - ETA: 11s - loss: 4.5022 - acc: 0.009561/64 [===========================>..] - ETA: 8s - loss: 4.5012 - acc: 0.0096 62/64 [============================>.] - ETA: 5s - loss: 4.5008 - acc: 0.009663/64 [============================>.] - ETA: 2s - loss: 4.4999 - acc: 0.009664/64 [==============================] - 186s 3s/step - loss: 4.4991 - acc: 0.0096
Finished Epoch 0
