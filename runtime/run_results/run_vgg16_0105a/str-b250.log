WARNING:tensorflow:From ../run_training.py:27: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

WARNING:tensorflow:From ../run_training.py:27: The name tf.ConfigProto is deprecated. Please use tf.compat.v1.ConfigProto instead.

WARNING:tensorflow:From ../run_training.py:27: The name tf.GPUOptions is deprecated. Please use tf.compat.v1.GPUOptions instead.

WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/resource_variable_ops.py:1630: calling BaseResourceVariable.__init__ (from tensorflow.python.ops.resource_variable_ops) with constraint is deprecated and will be removed in a future version.
Instructions for updating:
If using Keras pass *_constraint arguments to layers.
WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/stropt/lms.py:970: The name tf.train.SessionRunHook is deprecated. Please use tf.estimator.SessionRunHook instead.

WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/stropt/str_strategy.py:116: get_backward_walk_ops (from tensorflow.contrib.graph_editor.select) is deprecated and will be removed after 2019-06-06.
Instructions for updating:
Please use tensorflow.python.ops.op_selector.get_backward_walk_ops.
1 Physical GPUs, 1 Logical GPUs
Parsing arguments: [('batch_size', 250), ('epochs', 1), ('model_name', 'VGG16'), ('strategy', 'str'), ('verbose', False)]
Shape of x_train: (50000, 224, 224, 3), shape of x_test: (10000, 224, 224, 3)
[STR DEBUG] Parsing STR configuration: [{'strategy': 'hybrid', 'verbose': 'false', 'tags': '/home/zongzan/dist_dnn_training/STR/optimizer/logs/VGG16_250/layer_names'}, {'r': '/home/zongzan/dist_dnn_training/STR/optimizer/logs/VGG16_250/R', 'p': '/home/zongzan/dist_dnn_training/STR/optimizer/logs/VGG16_250/P', 'q': '/home/zongzan/dist_dnn_training/STR/optimizer/logs/VGG16_250/PrunedQ'}]
[STR DEBUG] Edit graph for recomputation ops
[STR DEBUG] Sorted forward ops: [<tf.Operation 'block1_conv2/Conv2D' type=Conv2D>, <tf.Operation 'block3_conv3/Conv2D' type=Conv2D>, <tf.Operation 'block1_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'fc2/BiasAdd' type=BiasAdd>, <tf.Operation 'predictions/BiasAdd' type=BiasAdd>, <tf.Operation 'block2_conv2/Conv2D' type=Conv2D>, <tf.Operation 'block1_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'block2_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'block4_conv3/Conv2D' type=Conv2D>, <tf.Operation 'fc2/MatMul' type=MatMul>, <tf.Operation 'block5_conv3/Conv2D' type=Conv2D>, <tf.Operation 'block3_conv3/BiasAdd' type=BiasAdd>, <tf.Operation 'block4_conv3/BiasAdd' type=BiasAdd>, <tf.Operation 'block5_conv3/BiasAdd' type=BiasAdd>, <tf.Operation 'block2_conv1/Conv2D' type=Conv2D>, <tf.Operation 'block3_conv2/Conv2D' type=Conv2D>, <tf.Operation 'block2_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'block4_conv2/Conv2D' type=Conv2D>, <tf.Operation 'block5_conv2/Conv2D' type=Conv2D>, <tf.Operation 'block3_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'block4_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'block5_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'block3_conv1/Conv2D' type=Conv2D>, <tf.Operation 'block4_conv1/Conv2D' type=Conv2D>, <tf.Operation 'block5_conv1/Conv2D' type=Conv2D>, <tf.Operation 'block3_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'fc1/BiasAdd' type=BiasAdd>, <tf.Operation 'block1_conv1/Conv2D' type=Conv2D>, <tf.Operation 'block5_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'block4_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'fc1/MatMul' type=MatMul>, <tf.Operation 'predictions/MatMul' type=MatMul>, <tf.Operation 'block3_conv2/Relu' type=Relu>, <tf.Operation 'block4_conv2/Relu' type=Relu>, <tf.Operation 'block3_conv3/Relu' type=Relu>, <tf.Operation 'block5_conv2/Relu' type=Relu>, <tf.Operation 'fc2/Relu' type=Relu>, <tf.Operation 'block4_conv3/Relu' type=Relu>, <tf.Operation 'block5_conv3/Relu' type=Relu>, <tf.Operation 'fc1/Relu' type=Relu>, <tf.Operation 'block3_conv1/Relu' type=Relu>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Shape_1' type=Shape>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Reshape' type=Reshape>, <tf.Operation 'block2_conv2/Relu' type=Relu>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Shape' type=Shape>, <tf.Operation 'block1_conv1/Relu' type=Relu>, <tf.Operation 'block1_conv2/Relu' type=Relu>, <tf.Operation 'block2_conv1/Relu' type=Relu>, <tf.Operation 'block4_conv1/Relu' type=Relu>, <tf.Operation 'block5_conv1/Relu' type=Relu>, <tf.Operation 'block5_pool/MaxPool' type=MaxPool>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits' type=SoftmaxCrossEntropyWithLogits>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Slice' type=Slice>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Slice_2' type=Slice>, <tf.Operation 'block1_pool/MaxPool' type=MaxPool>, <tf.Operation 'block2_pool/MaxPool' type=MaxPool>, <tf.Operation 'block3_pool/MaxPool' type=MaxPool>, <tf.Operation 'block4_pool/MaxPool' type=MaxPool>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Reshape_2' type=Reshape>, <tf.Operation 'flatten/Shape' type=Shape>, <tf.Operation 'flatten/Reshape' type=Reshape>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/concat' type=ConcatV2>, <tf.Operation 'loss/predictions_loss/weighted_loss/Mul' type=Mul>, <tf.Operation 'loss/predictions_loss/weighted_loss/broadcast_weights/ones_like/Shape' type=Shape>, <tf.Operation 'flatten/strided_slice' type=StridedSlice>, <tf.Operation 'loss/predictions_loss/weighted_loss/broadcast_weights/ones_like' type=Fill>, <tf.Operation 'loss/predictions_loss/Sum' type=Sum>, <tf.Operation 'flatten/Reshape/shape' type=Pack>, <tf.Operation 'loss/predictions_loss/num_elements' type=Size>, <tf.Operation 'loss/predictions_loss/Sum_1' type=Sum>, <tf.Operation 'loss/predictions_loss/weighted_loss/broadcast_weights' type=Mul>, <tf.Operation 'loss/predictions_loss/num_elements/Cast' type=Cast>, <tf.Operation 'loss/predictions_loss/value' type=DivNoNan>, <tf.Operation 'loss/mul' type=Mul>]
[STR DEBUG] Ops to be recomputed: [<tf.Operation 'block1_conv2/Conv2D' type=Conv2D>, <tf.Operation 'block1_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'block1_conv2/Relu' type=Relu>, <tf.Operation 'block2_conv2/Conv2D' type=Conv2D>, <tf.Operation 'block2_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'block2_conv2/Relu' type=Relu>, <tf.Operation 'block3_conv3/Conv2D' type=Conv2D>, <tf.Operation 'block3_conv3/BiasAdd' type=BiasAdd>, <tf.Operation 'block3_conv3/Relu' type=Relu>, <tf.Operation 'block4_conv3/Conv2D' type=Conv2D>, <tf.Operation 'block4_conv3/BiasAdd' type=BiasAdd>, <tf.Operation 'block4_conv3/Relu' type=Relu>, <tf.Operation 'block5_conv3/Conv2D' type=Conv2D>, <tf.Operation 'block5_conv3/BiasAdd' type=BiasAdd>, <tf.Operation 'block5_conv3/Relu' type=Relu>, <tf.Operation 'block5_pool/MaxPool' type=MaxPool>, <tf.Operation 'predictions/MatMul' type=MatMul>, <tf.Operation 'predictions/BiasAdd' type=BiasAdd>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Shape' type=Shape>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Shape_1' type=Shape>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Slice' type=Slice>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/concat' type=ConcatV2>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Reshape' type=Reshape>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits' type=SoftmaxCrossEntropyWithLogits>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Slice_2' type=Slice>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Reshape_2' type=Reshape>, <tf.Operation 'loss/predictions_loss/weighted_loss/broadcast_weights/ones_like/Shape' type=Shape>, <tf.Operation 'loss/predictions_loss/weighted_loss/broadcast_weights/ones_like' type=Fill>, <tf.Operation 'loss/predictions_loss/weighted_loss/broadcast_weights' type=Mul>, <tf.Operation 'loss/predictions_loss/weighted_loss/Mul' type=Mul>, <tf.Operation 'loss/predictions_loss/Sum' type=Sum>, <tf.Operation 'loss/predictions_loss/num_elements' type=Size>, <tf.Operation 'loss/predictions_loss/num_elements/Cast' type=Cast>, <tf.Operation 'loss/predictions_loss/Sum_1' type=Sum>, <tf.Operation 'loss/predictions_loss/value' type=DivNoNan>]
[STR DEBUG] Supplementary tensors to be checkpoints: [<tf.Tensor 'block1_conv1/Relu:0' shape=(?, 224, 224, 64) dtype=float32>, <tf.Tensor 'block2_conv1/Relu:0' shape=(?, 112, 112, 128) dtype=float32>, <tf.Tensor 'block3_conv1/Relu:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'block3_conv2/Relu:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'block4_conv1/Relu:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'block4_conv2/Relu:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'block5_conv1/Relu:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'block5_conv2/Relu:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'fc1/Relu:0' shape=(?, 4096) dtype=float32>, <tf.Tensor 'fc2/Relu:0' shape=(?, 4096) dtype=float32>]
[STR DEBUG] Checkpointed tensors and distconnected: {<tf.Tensor 'block1_conv1/Relu:0' shape=(?, 224, 224, 64) dtype=float32>: <tf.Tensor 'training/RMSprop/gradients/block1_conv1/Relu_sg:0' shape=(?, 224, 224, 64) dtype=float32>, <tf.Tensor 'block2_conv1/Relu:0' shape=(?, 112, 112, 128) dtype=float32>: <tf.Tensor 'training/RMSprop/gradients/block2_conv1/Relu_sg:0' shape=(?, 112, 112, 128) dtype=float32>, <tf.Tensor 'block3_conv1/Relu:0' shape=(?, 56, 56, 256) dtype=float32>: <tf.Tensor 'training/RMSprop/gradients/block3_conv1/Relu_sg:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'block3_conv2/Relu:0' shape=(?, 56, 56, 256) dtype=float32>: <tf.Tensor 'training/RMSprop/gradients/block3_conv2/Relu_sg:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'block4_conv1/Relu:0' shape=(?, 28, 28, 512) dtype=float32>: <tf.Tensor 'training/RMSprop/gradients/block4_conv1/Relu_sg:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'block4_conv2/Relu:0' shape=(?, 28, 28, 512) dtype=float32>: <tf.Tensor 'training/RMSprop/gradients/block4_conv2/Relu_sg:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'block5_conv1/Relu:0' shape=(?, 14, 14, 512) dtype=float32>: <tf.Tensor 'training/RMSprop/gradients/block5_conv1/Relu_sg:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'block5_conv2/Relu:0' shape=(?, 14, 14, 512) dtype=float32>: <tf.Tensor 'training/RMSprop/gradients/block5_conv2/Relu_sg:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'fc1/Relu:0' shape=(?, 4096) dtype=float32>: <tf.Tensor 'training/RMSprop/gradients/fc1/Relu_sg:0' shape=(?, 4096) dtype=float32>, <tf.Tensor 'fc2/Relu:0' shape=(?, 4096) dtype=float32>: <tf.Tensor 'training/RMSprop/gradients/fc2/Relu_sg:0' shape=(?, 4096) dtype=float32>}
[STR DEBUG] Found 20 ops to copy within fwd_ops [<tf.Operation 'block1_conv2/Conv2D' type=Conv2D>, <tf.Operation 'block3_conv3/Conv2D' type=Conv2D>, <tf.Operation 'block1_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'fc2/BiasAdd' type=BiasAdd>, <tf.Operation 'predictions/BiasAdd' type=BiasAdd>, <tf.Operation 'block2_conv2/Conv2D' type=Conv2D>, <tf.Operation 'block1_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'block2_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'block4_conv3/Conv2D' type=Conv2D>, <tf.Operation 'fc2/MatMul' type=MatMul>, <tf.Operation 'block5_conv3/Conv2D' type=Conv2D>, <tf.Operation 'block3_conv3/BiasAdd' type=BiasAdd>, <tf.Operation 'block4_conv3/BiasAdd' type=BiasAdd>, <tf.Operation 'block5_conv3/BiasAdd' type=BiasAdd>, <tf.Operation 'block2_conv1/Conv2D' type=Conv2D>, <tf.Operation 'block3_conv2/Conv2D' type=Conv2D>, <tf.Operation 'block2_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'block4_conv2/Conv2D' type=Conv2D>, <tf.Operation 'block5_conv2/Conv2D' type=Conv2D>, <tf.Operation 'block3_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'block4_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'block5_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'block3_conv1/Conv2D' type=Conv2D>, <tf.Operation 'block4_conv1/Conv2D' type=Conv2D>, <tf.Operation 'block5_conv1/Conv2D' type=Conv2D>, <tf.Operation 'block3_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'fc1/BiasAdd' type=BiasAdd>, <tf.Operation 'block1_conv1/Conv2D' type=Conv2D>, <tf.Operation 'block5_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'block4_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'fc1/MatMul' type=MatMul>, <tf.Operation 'predictions/MatMul' type=MatMul>, <tf.Operation 'block3_conv2/Relu' type=Relu>, <tf.Operation 'block4_conv2/Relu' type=Relu>, <tf.Operation 'block3_conv3/Relu' type=Relu>, <tf.Operation 'block5_conv2/Relu' type=Relu>, <tf.Operation 'fc2/Relu' type=Relu>, <tf.Operation 'block4_conv3/Relu' type=Relu>, <tf.Operation 'block5_conv3/Relu' type=Relu>, <tf.Operation 'fc1/Relu' type=Relu>, <tf.Operation 'block3_conv1/Relu' type=Relu>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Shape_1' type=Shape>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Reshape' type=Reshape>, <tf.Operation 'block2_conv2/Relu' type=Relu>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Shape' type=Shape>, <tf.Operation 'block1_conv1/Relu' type=Relu>, <tf.Operation 'block1_conv2/Relu' type=Relu>, <tf.Operation 'block2_conv1/Relu' type=Relu>, <tf.Operation 'block4_conv1/Relu' type=Relu>, <tf.Operation 'block5_conv1/Relu' type=Relu>, <tf.Operation 'block5_pool/MaxPool' type=MaxPool>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits' type=SoftmaxCrossEntropyWithLogits>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Slice' type=Slice>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Slice_2' type=Slice>, <tf.Operation 'block1_pool/MaxPool' type=MaxPool>, <tf.Operation 'block2_pool/MaxPool' type=MaxPool>, <tf.Operation 'block3_pool/MaxPool' type=MaxPool>, <tf.Operation 'block4_pool/MaxPool' type=MaxPool>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Reshape_2' type=Reshape>, <tf.Operation 'flatten/Shape' type=Shape>, <tf.Operation 'flatten/Reshape' type=Reshape>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/concat' type=ConcatV2>, <tf.Operation 'loss/predictions_loss/weighted_loss/Mul' type=Mul>, <tf.Operation 'loss/predictions_loss/weighted_loss/broadcast_weights/ones_like/Shape' type=Shape>, <tf.Operation 'flatten/strided_slice' type=StridedSlice>, <tf.Operation 'loss/predictions_loss/weighted_loss/broadcast_weights/ones_like' type=Fill>, <tf.Operation 'loss/predictions_loss/Sum' type=Sum>, <tf.Operation 'flatten/Reshape/shape' type=Pack>, <tf.Operation 'loss/predictions_loss/num_elements' type=Size>, <tf.Operation 'loss/predictions_loss/Sum_1' type=Sum>, <tf.Operation 'loss/predictions_loss/weighted_loss/broadcast_weights' type=Mul>, <tf.Operation 'loss/predictions_loss/num_elements/Cast' type=Cast>, <tf.Operation 'loss/predictions_loss/value' type=DivNoNan>, <tf.Operation 'loss/mul' type=Mul>], seed [<tf.Operation 'loss/mul' type=Mul>], stop_at [<tf.Tensor 'block1_conv1/Relu:0' shape=(?, 224, 224, 64) dtype=float32>, <tf.Tensor 'block2_conv1/Relu:0' shape=(?, 112, 112, 128) dtype=float32>, <tf.Tensor 'block3_conv1/Relu:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'block3_conv2/Relu:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'block4_conv1/Relu:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'block4_conv2/Relu:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'block5_conv1/Relu:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'block5_conv2/Relu:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'fc1/Relu:0' shape=(?, 4096) dtype=float32>, <tf.Tensor 'fc2/Relu:0' shape=(?, 4096) dtype=float32>]
[STR DEBUG] ops_to_copy = [<tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits' type=SoftmaxCrossEntropyWithLogits>, <tf.Operation 'loss/predictions_loss/num_elements' type=Size>, <tf.Operation 'loss/predictions_loss/weighted_loss/broadcast_weights/ones_like/Shape' type=Shape>, <tf.Operation 'predictions/BiasAdd' type=BiasAdd>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Shape_1' type=Shape>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Slice_2' type=Slice>, <tf.Operation 'loss/predictions_loss/weighted_loss/Mul' type=Mul>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Reshape_2' type=Reshape>, <tf.Operation 'loss/predictions_loss/weighted_loss/broadcast_weights' type=Mul>, <tf.Operation 'loss/mul' type=Mul>, <tf.Operation 'loss/predictions_loss/num_elements/Cast' type=Cast>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/concat' type=ConcatV2>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Slice' type=Slice>, <tf.Operation 'loss/predictions_loss/Sum' type=Sum>, <tf.Operation 'loss/predictions_loss/Sum_1' type=Sum>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Reshape' type=Reshape>, <tf.Operation 'loss/predictions_loss/weighted_loss/broadcast_weights/ones_like' type=Fill>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Shape' type=Shape>, <tf.Operation 'predictions/MatMul' type=MatMul>, <tf.Operation 'loss/predictions_loss/value' type=DivNoNan>]
[STR DEBUG] Processing list [<tf.Tensor 'loss/mul:0' shape=() dtype=float32>]
[STR DEBUG] Copied_svg: SubGraphView (graphid=140629659721232):
** ops[20]:
  training/RMSprop/gradients/predictions/MatMul
  training/RMSprop/gradients/predictions/BiasAdd
  training/RMSprop/gradients/loss/predictions_loss/softmax_cross_entropy_with_logits/Shape
  training/RMSprop/gradients/loss/predictions_loss/softmax_cross_entropy_with_logits/Shape_1
  training/RMSprop/gradients/loss/predictions_loss/softmax_cross_entropy_with_logits/Slice
  training/RMSprop/gradients/loss/predictions_loss/softmax_cross_entropy_with_logits/concat
  training/RMSprop/gradients/loss/predictions_loss/softmax_cross_entropy_with_logits/Reshape
  training/RMSprop/gradients/loss/predictions_loss/softmax_cross_entropy_with_logits
  training/RMSprop/gradients/loss/predictions_loss/softmax_cross_entropy_with_logits/Slice_2
  training/RMSprop/gradients/loss/predictions_loss/softmax_cross_entropy_with_logits/Reshape_2
  training/RMSprop/gradients/loss/predictions_loss/weighted_loss/broadcast_weights/ones_like/Shape
  training/RMSprop/gradients/loss/predictions_loss/weighted_loss/broadcast_weights/ones_like
  training/RMSprop/gradients/loss/predictions_loss/weighted_loss/broadcast_weights
  training/RMSprop/gradients/loss/predictions_loss/weighted_loss/Mul
  training/RMSprop/gradients/loss/predictions_loss/Sum
  training/RMSprop/gradients/loss/predictions_loss/num_elements
  training/RMSprop/gradients/loss/predictions_loss/num_elements/Cast
  training/RMSprop/gradients/loss/predictions_loss/Sum_1
  training/RMSprop/gradients/loss/predictions_loss/value
  training/RMSprop/gradients/loss/mul
** inputs: empty
** outputs[2]:
  training/RMSprop/gradients/loss/predictions_loss/softmax_cross_entropy_with_logits:1
  training/RMSprop/gradients/loss/mul:0

[STR DEBUG] Copied [<tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits' type=SoftmaxCrossEntropyWithLogits>, <tf.Operation 'loss/predictions_loss/num_elements' type=Size>, <tf.Operation 'loss/predictions_loss/weighted_loss/broadcast_weights/ones_like/Shape' type=Shape>, <tf.Operation 'predictions/BiasAdd' type=BiasAdd>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Shape_1' type=Shape>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Slice_2' type=Slice>, <tf.Operation 'loss/predictions_loss/weighted_loss/Mul' type=Mul>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Reshape_2' type=Reshape>, <tf.Operation 'loss/predictions_loss/weighted_loss/broadcast_weights' type=Mul>, <tf.Operation 'loss/mul' type=Mul>, <tf.Operation 'loss/predictions_loss/num_elements/Cast' type=Cast>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/concat' type=ConcatV2>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Slice' type=Slice>, <tf.Operation 'loss/predictions_loss/Sum' type=Sum>, <tf.Operation 'loss/predictions_loss/Sum_1' type=Sum>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Reshape' type=Reshape>, <tf.Operation 'loss/predictions_loss/weighted_loss/broadcast_weights/ones_like' type=Fill>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Shape' type=Shape>, <tf.Operation 'predictions/MatMul' type=MatMul>, <tf.Operation 'loss/predictions_loss/value' type=DivNoNan>] to dict_values([<tf.Operation 'training/RMSprop/gradients/predictions/MatMul' type=MatMul>, <tf.Operation 'training/RMSprop/gradients/predictions/BiasAdd' type=BiasAdd>, <tf.Operation 'training/RMSprop/gradients/loss/predictions_loss/softmax_cross_entropy_with_logits/Shape' type=Shape>, <tf.Operation 'training/RMSprop/gradients/loss/predictions_loss/softmax_cross_entropy_with_logits/Shape_1' type=Shape>, <tf.Operation 'training/RMSprop/gradients/loss/predictions_loss/softmax_cross_entropy_with_logits/Slice' type=Slice>, <tf.Operation 'training/RMSprop/gradients/loss/predictions_loss/softmax_cross_entropy_with_logits/concat' type=ConcatV2>, <tf.Operation 'training/RMSprop/gradients/loss/predictions_loss/softmax_cross_entropy_with_logits/Reshape' type=Reshape>, <tf.Operation 'training/RMSprop/gradients/loss/predictions_loss/softmax_cross_entropy_with_logits' type=SoftmaxCrossEntropyWithLogits>, <tf.Operation 'training/RMSprop/gradients/loss/predictions_loss/softmax_cross_entropy_with_logits/Slice_2' type=Slice>, <tf.Operation 'training/RMSprop/gradients/loss/predictions_loss/softmax_cross_entropy_with_logits/Reshape_2' type=Reshape>, <tf.Operation 'training/RMSprop/gradients/loss/predictions_loss/weighted_loss/broadcast_weights/ones_like/Shape' type=Shape>, <tf.Operation 'training/RMSprop/gradients/loss/predictions_loss/weighted_loss/broadcast_weights/ones_like' type=Fill>, <tf.Operation 'training/RMSprop/gradients/loss/predictions_loss/weighted_loss/broadcast_weights' type=Mul>, <tf.Operation 'training/RMSprop/gradients/loss/predictions_loss/weighted_loss/Mul' type=Mul>, <tf.Operation 'training/RMSprop/gradients/loss/predictions_loss/Sum' type=Sum>, <tf.Operation 'training/RMSprop/gradients/loss/predictions_loss/num_elements' type=Size>, <tf.Operation 'training/RMSprop/gradients/loss/predictions_loss/num_elements/Cast' type=Cast>, <tf.Operation 'training/RMSprop/gradients/loss/predictions_loss/Sum_1' type=Sum>, <tf.Operation 'training/RMSprop/gradients/loss/predictions_loss/value' type=DivNoNan>, <tf.Operation 'training/RMSprop/gradients/loss/mul' type=Mul>])
[STR DEBUG] Rewired dict_values([<tf.Tensor 'training/RMSprop/gradients/block1_conv1/Relu_sg:0' shape=(?, 224, 224, 64) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block2_conv1/Relu_sg:0' shape=(?, 112, 112, 128) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block3_conv1/Relu_sg:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block3_conv2/Relu_sg:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block4_conv1/Relu_sg:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block4_conv2/Relu_sg:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block5_conv1/Relu_sg:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block5_conv2/Relu_sg:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/fc1/Relu_sg:0' shape=(?, 4096) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/fc2/Relu_sg:0' shape=(?, 4096) dtype=float32>]) in place of dict_keys([<tf.Tensor 'block1_conv1/Relu:0' shape=(?, 224, 224, 64) dtype=float32>, <tf.Tensor 'block2_conv1/Relu:0' shape=(?, 112, 112, 128) dtype=float32>, <tf.Tensor 'block3_conv1/Relu:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'block3_conv2/Relu:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'block4_conv1/Relu:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'block4_conv2/Relu:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'block5_conv1/Relu:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'block5_conv2/Relu:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'fc1/Relu:0' shape=(?, 4096) dtype=float32>, <tf.Tensor 'fc2/Relu:0' shape=(?, 4096) dtype=float32>]) restricted to dict_values([<tf.Operation 'training/RMSprop/gradients/predictions/MatMul' type=MatMul>, <tf.Operation 'training/RMSprop/gradients/predictions/BiasAdd' type=BiasAdd>, <tf.Operation 'training/RMSprop/gradients/loss/predictions_loss/softmax_cross_entropy_with_logits/Shape' type=Shape>, <tf.Operation 'training/RMSprop/gradients/loss/predictions_loss/softmax_cross_entropy_with_logits/Shape_1' type=Shape>, <tf.Operation 'training/RMSprop/gradients/loss/predictions_loss/softmax_cross_entropy_with_logits/Slice' type=Slice>, <tf.Operation 'training/RMSprop/gradients/loss/predictions_loss/softmax_cross_entropy_with_logits/concat' type=ConcatV2>, <tf.Operation 'training/RMSprop/gradients/loss/predictions_loss/softmax_cross_entropy_with_logits/Reshape' type=Reshape>, <tf.Operation 'training/RMSprop/gradients/loss/predictions_loss/softmax_cross_entropy_with_logits' type=SoftmaxCrossEntropyWithLogits>, <tf.Operation 'training/RMSprop/gradients/loss/predictions_loss/softmax_cross_entropy_with_logits/Slice_2' type=Slice>, <tf.Operation 'training/RMSprop/gradients/loss/predictions_loss/softmax_cross_entropy_with_logits/Reshape_2' type=Reshape>, <tf.Operation 'training/RMSprop/gradients/loss/predictions_loss/weighted_loss/broadcast_weights/ones_like/Shape' type=Shape>, <tf.Operation 'training/RMSprop/gradients/loss/predictions_loss/weighted_loss/broadcast_weights/ones_like' type=Fill>, <tf.Operation 'training/RMSprop/gradients/loss/predictions_loss/weighted_loss/broadcast_weights' type=Mul>, <tf.Operation 'training/RMSprop/gradients/loss/predictions_loss/weighted_loss/Mul' type=Mul>, <tf.Operation 'training/RMSprop/gradients/loss/predictions_loss/Sum' type=Sum>, <tf.Operation 'training/RMSprop/gradients/loss/predictions_loss/num_elements' type=Size>, <tf.Operation 'training/RMSprop/gradients/loss/predictions_loss/num_elements/Cast' type=Cast>, <tf.Operation 'training/RMSprop/gradients/loss/predictions_loss/Sum_1' type=Sum>, <tf.Operation 'training/RMSprop/gradients/loss/predictions_loss/value' type=DivNoNan>, <tf.Operation 'training/RMSprop/gradients/loss/mul' type=Mul>])
[STR DEBUG] Got gradients [None, None, None, None, None, None, None, None, None, <tf.Tensor 'training/RMSprop/gradients/gradients/training/RMSprop/gradients/predictions/MatMul_grad/MatMul:0' shape=(?, 4096) dtype=float32>, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, <tf.Tensor 'training/RMSprop/gradients/gradients/training/RMSprop/gradients/predictions/MatMul_grad/MatMul_1:0' shape=(4096, 10) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/gradients/training/RMSprop/gradients/predictions/BiasAdd_grad/BiasAddGrad:0' shape=(10,) dtype=float32>]
[STR DEBUG] for [<tf.Tensor 'training/RMSprop/gradients/loss/mul:0' shape=() dtype=float32>]
[STR DEBUG] with respect to ops, boundary:[<tf.Tensor 'training/RMSprop/gradients/block1_conv1/Relu_sg:0' shape=(?, 224, 224, 64) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block2_conv1/Relu_sg:0' shape=(?, 112, 112, 128) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block3_conv1/Relu_sg:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block3_conv2/Relu_sg:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block4_conv1/Relu_sg:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block4_conv2/Relu_sg:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block5_conv1/Relu_sg:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block5_conv2/Relu_sg:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/fc1/Relu_sg:0' shape=(?, 4096) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/fc2/Relu_sg:0' shape=(?, 4096) dtype=float32>], xs:[<tf.Variable 'block1_conv1/kernel:0' shape=(3, 3, 3, 64) dtype=float32>, <tf.Variable 'block1_conv1/bias:0' shape=(64,) dtype=float32>, <tf.Variable 'block1_conv2/kernel:0' shape=(3, 3, 64, 64) dtype=float32>, <tf.Variable 'block1_conv2/bias:0' shape=(64,) dtype=float32>, <tf.Variable 'block2_conv1/kernel:0' shape=(3, 3, 64, 128) dtype=float32>, <tf.Variable 'block2_conv1/bias:0' shape=(128,) dtype=float32>, <tf.Variable 'block2_conv2/kernel:0' shape=(3, 3, 128, 128) dtype=float32>, <tf.Variable 'block2_conv2/bias:0' shape=(128,) dtype=float32>, <tf.Variable 'block3_conv1/kernel:0' shape=(3, 3, 128, 256) dtype=float32>, <tf.Variable 'block3_conv1/bias:0' shape=(256,) dtype=float32>, <tf.Variable 'block3_conv2/kernel:0' shape=(3, 3, 256, 256) dtype=float32>, <tf.Variable 'block3_conv2/bias:0' shape=(256,) dtype=float32>, <tf.Variable 'block3_conv3/kernel:0' shape=(3, 3, 256, 256) dtype=float32>, <tf.Variable 'block3_conv3/bias:0' shape=(256,) dtype=float32>, <tf.Variable 'block4_conv1/kernel:0' shape=(3, 3, 256, 512) dtype=float32>, <tf.Variable 'block4_conv1/bias:0' shape=(512,) dtype=float32>, <tf.Variable 'block4_conv2/kernel:0' shape=(3, 3, 512, 512) dtype=float32>, <tf.Variable 'block4_conv2/bias:0' shape=(512,) dtype=float32>, <tf.Variable 'block4_conv3/kernel:0' shape=(3, 3, 512, 512) dtype=float32>, <tf.Variable 'block4_conv3/bias:0' shape=(512,) dtype=float32>, <tf.Variable 'block5_conv1/kernel:0' shape=(3, 3, 512, 512) dtype=float32>, <tf.Variable 'block5_conv1/bias:0' shape=(512,) dtype=float32>, <tf.Variable 'block5_conv2/kernel:0' shape=(3, 3, 512, 512) dtype=float32>, <tf.Variable 'block5_conv2/bias:0' shape=(512,) dtype=float32>, <tf.Variable 'block5_conv3/kernel:0' shape=(3, 3, 512, 512) dtype=float32>, <tf.Variable 'block5_conv3/bias:0' shape=(512,) dtype=float32>, <tf.Variable 'fc1/kernel:0' shape=(25088, 4096) dtype=float32>, <tf.Variable 'fc1/bias:0' shape=(4096,) dtype=float32>, <tf.Variable 'fc2/kernel:0' shape=(4096, 4096) dtype=float32>, <tf.Variable 'fc2/bias:0' shape=(4096,) dtype=float32>, <tf.Variable 'predictions/kernel:0' shape=(4096, 10) dtype=float32>, <tf.Variable 'predictions/bias:0' shape=(10,) dtype=float32>]
[STR DEBUG] dv of checkpoints: {<tf.Tensor 'block1_conv1/Relu:0' shape=(?, 224, 224, 64) dtype=float32>: None, <tf.Tensor 'block2_conv1/Relu:0' shape=(?, 112, 112, 128) dtype=float32>: None, <tf.Tensor 'block3_conv1/Relu:0' shape=(?, 56, 56, 256) dtype=float32>: None, <tf.Tensor 'block3_conv2/Relu:0' shape=(?, 56, 56, 256) dtype=float32>: None, <tf.Tensor 'block4_conv1/Relu:0' shape=(?, 28, 28, 512) dtype=float32>: None, <tf.Tensor 'block4_conv2/Relu:0' shape=(?, 28, 28, 512) dtype=float32>: None, <tf.Tensor 'block5_conv1/Relu:0' shape=(?, 14, 14, 512) dtype=float32>: None, <tf.Tensor 'block5_conv2/Relu:0' shape=(?, 14, 14, 512) dtype=float32>: None, <tf.Tensor 'fc1/Relu:0' shape=(?, 4096) dtype=float32>: None, <tf.Tensor 'fc2/Relu:0' shape=(?, 4096) dtype=float32>: <tf.Tensor 'training/RMSprop/gradients/gradients/training/RMSprop/gradients/predictions/MatMul_grad/MatMul:0' shape=(?, 4096) dtype=float32>}
[STR DEBUG] checkpoints_sorted_lists: [[<tf.Tensor 'block1_conv1/Relu:0' shape=(?, 224, 224, 64) dtype=float32>], [<tf.Tensor 'block2_conv1/Relu:0' shape=(?, 112, 112, 128) dtype=float32>], [<tf.Tensor 'block3_conv1/Relu:0' shape=(?, 56, 56, 256) dtype=float32>], [<tf.Tensor 'block3_conv2/Relu:0' shape=(?, 56, 56, 256) dtype=float32>], [<tf.Tensor 'block4_conv1/Relu:0' shape=(?, 28, 28, 512) dtype=float32>], [<tf.Tensor 'block4_conv2/Relu:0' shape=(?, 28, 28, 512) dtype=float32>], [<tf.Tensor 'block5_conv1/Relu:0' shape=(?, 14, 14, 512) dtype=float32>], [<tf.Tensor 'block5_conv2/Relu:0' shape=(?, 14, 14, 512) dtype=float32>], [<tf.Tensor 'fc1/Relu:0' shape=(?, 4096) dtype=float32>], [<tf.Tensor 'fc2/Relu:0' shape=(?, 4096) dtype=float32>]]
[STR DEBUG] =========loop========
[STR DEBUG] Processing list [<tf.Tensor 'fc2/Relu:0' shape=(?, 4096) dtype=float32>]
[STR DEBUG] Found 3 ops to copy within [<tf.Operation 'block1_conv2/Conv2D' type=Conv2D>, <tf.Operation 'block3_conv3/Conv2D' type=Conv2D>, <tf.Operation 'block1_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'fc2/BiasAdd' type=BiasAdd>, <tf.Operation 'predictions/BiasAdd' type=BiasAdd>, <tf.Operation 'block2_conv2/Conv2D' type=Conv2D>, <tf.Operation 'block1_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'block2_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'block4_conv3/Conv2D' type=Conv2D>, <tf.Operation 'fc2/MatMul' type=MatMul>, <tf.Operation 'block5_conv3/Conv2D' type=Conv2D>, <tf.Operation 'block3_conv3/BiasAdd' type=BiasAdd>, <tf.Operation 'block4_conv3/BiasAdd' type=BiasAdd>, <tf.Operation 'block5_conv3/BiasAdd' type=BiasAdd>, <tf.Operation 'block2_conv1/Conv2D' type=Conv2D>, <tf.Operation 'block3_conv2/Conv2D' type=Conv2D>, <tf.Operation 'block2_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'block4_conv2/Conv2D' type=Conv2D>, <tf.Operation 'block5_conv2/Conv2D' type=Conv2D>, <tf.Operation 'block3_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'block4_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'block5_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'block3_conv1/Conv2D' type=Conv2D>, <tf.Operation 'block4_conv1/Conv2D' type=Conv2D>, <tf.Operation 'block5_conv1/Conv2D' type=Conv2D>, <tf.Operation 'block3_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'fc1/BiasAdd' type=BiasAdd>, <tf.Operation 'block1_conv1/Conv2D' type=Conv2D>, <tf.Operation 'block5_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'block4_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'fc1/MatMul' type=MatMul>, <tf.Operation 'predictions/MatMul' type=MatMul>, <tf.Operation 'block3_conv2/Relu' type=Relu>, <tf.Operation 'block4_conv2/Relu' type=Relu>, <tf.Operation 'block3_conv3/Relu' type=Relu>, <tf.Operation 'block5_conv2/Relu' type=Relu>, <tf.Operation 'fc2/Relu' type=Relu>, <tf.Operation 'block4_conv3/Relu' type=Relu>, <tf.Operation 'block5_conv3/Relu' type=Relu>, <tf.Operation 'fc1/Relu' type=Relu>, <tf.Operation 'block3_conv1/Relu' type=Relu>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Shape_1' type=Shape>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Reshape' type=Reshape>, <tf.Operation 'block2_conv2/Relu' type=Relu>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Shape' type=Shape>, <tf.Operation 'block1_conv1/Relu' type=Relu>, <tf.Operation 'block1_conv2/Relu' type=Relu>, <tf.Operation 'block2_conv1/Relu' type=Relu>, <tf.Operation 'block4_conv1/Relu' type=Relu>, <tf.Operation 'block5_conv1/Relu' type=Relu>, <tf.Operation 'block5_pool/MaxPool' type=MaxPool>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits' type=SoftmaxCrossEntropyWithLogits>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Slice' type=Slice>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Slice_2' type=Slice>, <tf.Operation 'block1_pool/MaxPool' type=MaxPool>, <tf.Operation 'block2_pool/MaxPool' type=MaxPool>, <tf.Operation 'block3_pool/MaxPool' type=MaxPool>, <tf.Operation 'block4_pool/MaxPool' type=MaxPool>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Reshape_2' type=Reshape>, <tf.Operation 'flatten/Shape' type=Shape>, <tf.Operation 'flatten/Reshape' type=Reshape>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/concat' type=ConcatV2>, <tf.Operation 'loss/predictions_loss/weighted_loss/Mul' type=Mul>, <tf.Operation 'loss/predictions_loss/weighted_loss/broadcast_weights/ones_like/Shape' type=Shape>, <tf.Operation 'flatten/strided_slice' type=StridedSlice>, <tf.Operation 'loss/predictions_loss/weighted_loss/broadcast_weights/ones_like' type=Fill>, <tf.Operation 'loss/predictions_loss/Sum' type=Sum>, <tf.Operation 'flatten/Reshape/shape' type=Pack>, <tf.Operation 'loss/predictions_loss/num_elements' type=Size>, <tf.Operation 'loss/predictions_loss/Sum_1' type=Sum>, <tf.Operation 'loss/predictions_loss/weighted_loss/broadcast_weights' type=Mul>, <tf.Operation 'loss/predictions_loss/num_elements/Cast' type=Cast>, <tf.Operation 'loss/predictions_loss/value' type=DivNoNan>, <tf.Operation 'loss/mul' type=Mul>], seed [<tf.Operation 'fc2/Relu' type=Relu>], stop_at [<tf.Tensor 'block1_conv1/Relu:0' shape=(?, 224, 224, 64) dtype=float32>, <tf.Tensor 'block2_conv1/Relu:0' shape=(?, 112, 112, 128) dtype=float32>, <tf.Tensor 'block3_conv1/Relu:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'block3_conv2/Relu:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'block4_conv1/Relu:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'block4_conv2/Relu:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'block5_conv1/Relu:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'block5_conv2/Relu:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'fc1/Relu:0' shape=(?, 4096) dtype=float32>]
[STR DEBUG] ops_to_copy = [<tf.Operation 'fc2/BiasAdd' type=BiasAdd>, <tf.Operation 'fc2/MatMul' type=MatMul>, <tf.Operation 'fc2/Relu' type=Relu>]
[STR DEBUG] Copied [<tf.Operation 'fc2/BiasAdd' type=BiasAdd>, <tf.Operation 'fc2/MatMul' type=MatMul>, <tf.Operation 'fc2/Relu' type=Relu>] to dict_values([<tf.Operation 'training/RMSprop/gradients/fc2/MatMul' type=MatMul>, <tf.Operation 'training/RMSprop/gradients/fc2/BiasAdd' type=BiasAdd>, <tf.Operation 'training/RMSprop/gradients/fc2/Relu' type=Relu>])
[STR DEBUG] Rewired [<tf.Tensor 'training/RMSprop/gradients/block1_conv1/Relu_sg:0' shape=(?, 224, 224, 64) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block2_conv1/Relu_sg:0' shape=(?, 112, 112, 128) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block3_conv1/Relu_sg:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block3_conv2/Relu_sg:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block4_conv1/Relu_sg:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block4_conv2/Relu_sg:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block5_conv1/Relu_sg:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block5_conv2/Relu_sg:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/fc1/Relu_sg:0' shape=(?, 4096) dtype=float32>] in place of [<tf.Tensor 'block1_conv1/Relu:0' shape=(?, 224, 224, 64) dtype=float32>, <tf.Tensor 'block2_conv1/Relu:0' shape=(?, 112, 112, 128) dtype=float32>, <tf.Tensor 'block3_conv1/Relu:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'block3_conv2/Relu:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'block4_conv1/Relu:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'block4_conv2/Relu:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'block5_conv1/Relu:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'block5_conv2/Relu:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'fc1/Relu:0' shape=(?, 4096) dtype=float32>] restricted to dict_values([<tf.Operation 'training/RMSprop/gradients/fc2/MatMul' type=MatMul>, <tf.Operation 'training/RMSprop/gradients/fc2/BiasAdd' type=BiasAdd>, <tf.Operation 'training/RMSprop/gradients/fc2/Relu' type=Relu>])
[STR DEBUG] Got gradients [None, None, None, None, None, None, None, None, <tf.Tensor 'training/RMSprop/gradients/gradients_1/training/RMSprop/gradients/fc2/MatMul_grad/MatMul:0' shape=(?, 4096) dtype=float32>, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, <tf.Tensor 'training/RMSprop/gradients/gradients_1/training/RMSprop/gradients/fc2/MatMul_grad/MatMul_1:0' shape=(4096, 4096) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/gradients_1/training/RMSprop/gradients/fc2/BiasAdd_grad/BiasAddGrad:0' shape=(4096,) dtype=float32>, None, None]
[STR DEBUG] for [<tf.Tensor 'training/RMSprop/gradients/fc2/Relu:0' shape=(?, 4096) dtype=float32>]
[STR DEBUG] with respect to boundary: [<tf.Tensor 'training/RMSprop/gradients/block1_conv1/Relu_sg:0' shape=(?, 224, 224, 64) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block2_conv1/Relu_sg:0' shape=(?, 112, 112, 128) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block3_conv1/Relu_sg:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block3_conv2/Relu_sg:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block4_conv1/Relu_sg:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block4_conv2/Relu_sg:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block5_conv1/Relu_sg:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block5_conv2/Relu_sg:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/fc1/Relu_sg:0' shape=(?, 4096) dtype=float32>], xs: [<tf.Variable 'block1_conv1/kernel:0' shape=(3, 3, 3, 64) dtype=float32>, <tf.Variable 'block1_conv1/bias:0' shape=(64,) dtype=float32>, <tf.Variable 'block1_conv2/kernel:0' shape=(3, 3, 64, 64) dtype=float32>, <tf.Variable 'block1_conv2/bias:0' shape=(64,) dtype=float32>, <tf.Variable 'block2_conv1/kernel:0' shape=(3, 3, 64, 128) dtype=float32>, <tf.Variable 'block2_conv1/bias:0' shape=(128,) dtype=float32>, <tf.Variable 'block2_conv2/kernel:0' shape=(3, 3, 128, 128) dtype=float32>, <tf.Variable 'block2_conv2/bias:0' shape=(128,) dtype=float32>, <tf.Variable 'block3_conv1/kernel:0' shape=(3, 3, 128, 256) dtype=float32>, <tf.Variable 'block3_conv1/bias:0' shape=(256,) dtype=float32>, <tf.Variable 'block3_conv2/kernel:0' shape=(3, 3, 256, 256) dtype=float32>, <tf.Variable 'block3_conv2/bias:0' shape=(256,) dtype=float32>, <tf.Variable 'block3_conv3/kernel:0' shape=(3, 3, 256, 256) dtype=float32>, <tf.Variable 'block3_conv3/bias:0' shape=(256,) dtype=float32>, <tf.Variable 'block4_conv1/kernel:0' shape=(3, 3, 256, 512) dtype=float32>, <tf.Variable 'block4_conv1/bias:0' shape=(512,) dtype=float32>, <tf.Variable 'block4_conv2/kernel:0' shape=(3, 3, 512, 512) dtype=float32>, <tf.Variable 'block4_conv2/bias:0' shape=(512,) dtype=float32>, <tf.Variable 'block4_conv3/kernel:0' shape=(3, 3, 512, 512) dtype=float32>, <tf.Variable 'block4_conv3/bias:0' shape=(512,) dtype=float32>, <tf.Variable 'block5_conv1/kernel:0' shape=(3, 3, 512, 512) dtype=float32>, <tf.Variable 'block5_conv1/bias:0' shape=(512,) dtype=float32>, <tf.Variable 'block5_conv2/kernel:0' shape=(3, 3, 512, 512) dtype=float32>, <tf.Variable 'block5_conv2/bias:0' shape=(512,) dtype=float32>, <tf.Variable 'block5_conv3/kernel:0' shape=(3, 3, 512, 512) dtype=float32>, <tf.Variable 'block5_conv3/bias:0' shape=(512,) dtype=float32>, <tf.Variable 'fc1/kernel:0' shape=(25088, 4096) dtype=float32>, <tf.Variable 'fc1/bias:0' shape=(4096,) dtype=float32>, <tf.Variable 'fc2/kernel:0' shape=(4096, 4096) dtype=float32>, <tf.Variable 'fc2/bias:0' shape=(4096,) dtype=float32>, <tf.Variable 'predictions/kernel:0' shape=(4096, 10) dtype=float32>, <tf.Variable 'predictions/bias:0' shape=(10,) dtype=float32>]
[STR DEBUG] with boundary backprop substitutions [<tf.Tensor 'training/RMSprop/gradients/gradients/training/RMSprop/gradients/predictions/MatMul_grad/MatMul:0' shape=(?, 4096) dtype=float32>]
[STR DEBUG] =========end========
[STR DEBUG] =========loop========
[STR DEBUG] Processing list [<tf.Tensor 'fc1/Relu:0' shape=(?, 4096) dtype=float32>]
[STR DEBUG] Found 11 ops to copy within [<tf.Operation 'block1_conv2/Conv2D' type=Conv2D>, <tf.Operation 'block3_conv3/Conv2D' type=Conv2D>, <tf.Operation 'block1_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'fc2/BiasAdd' type=BiasAdd>, <tf.Operation 'predictions/BiasAdd' type=BiasAdd>, <tf.Operation 'block2_conv2/Conv2D' type=Conv2D>, <tf.Operation 'block1_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'block2_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'block4_conv3/Conv2D' type=Conv2D>, <tf.Operation 'fc2/MatMul' type=MatMul>, <tf.Operation 'block5_conv3/Conv2D' type=Conv2D>, <tf.Operation 'block3_conv3/BiasAdd' type=BiasAdd>, <tf.Operation 'block4_conv3/BiasAdd' type=BiasAdd>, <tf.Operation 'block5_conv3/BiasAdd' type=BiasAdd>, <tf.Operation 'block2_conv1/Conv2D' type=Conv2D>, <tf.Operation 'block3_conv2/Conv2D' type=Conv2D>, <tf.Operation 'block2_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'block4_conv2/Conv2D' type=Conv2D>, <tf.Operation 'block5_conv2/Conv2D' type=Conv2D>, <tf.Operation 'block3_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'block4_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'block5_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'block3_conv1/Conv2D' type=Conv2D>, <tf.Operation 'block4_conv1/Conv2D' type=Conv2D>, <tf.Operation 'block5_conv1/Conv2D' type=Conv2D>, <tf.Operation 'block3_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'fc1/BiasAdd' type=BiasAdd>, <tf.Operation 'block1_conv1/Conv2D' type=Conv2D>, <tf.Operation 'block5_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'block4_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'fc1/MatMul' type=MatMul>, <tf.Operation 'predictions/MatMul' type=MatMul>, <tf.Operation 'block3_conv2/Relu' type=Relu>, <tf.Operation 'block4_conv2/Relu' type=Relu>, <tf.Operation 'block3_conv3/Relu' type=Relu>, <tf.Operation 'block5_conv2/Relu' type=Relu>, <tf.Operation 'fc2/Relu' type=Relu>, <tf.Operation 'block4_conv3/Relu' type=Relu>, <tf.Operation 'block5_conv3/Relu' type=Relu>, <tf.Operation 'fc1/Relu' type=Relu>, <tf.Operation 'block3_conv1/Relu' type=Relu>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Shape_1' type=Shape>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Reshape' type=Reshape>, <tf.Operation 'block2_conv2/Relu' type=Relu>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Shape' type=Shape>, <tf.Operation 'block1_conv1/Relu' type=Relu>, <tf.Operation 'block1_conv2/Relu' type=Relu>, <tf.Operation 'block2_conv1/Relu' type=Relu>, <tf.Operation 'block4_conv1/Relu' type=Relu>, <tf.Operation 'block5_conv1/Relu' type=Relu>, <tf.Operation 'block5_pool/MaxPool' type=MaxPool>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits' type=SoftmaxCrossEntropyWithLogits>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Slice' type=Slice>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Slice_2' type=Slice>, <tf.Operation 'block1_pool/MaxPool' type=MaxPool>, <tf.Operation 'block2_pool/MaxPool' type=MaxPool>, <tf.Operation 'block3_pool/MaxPool' type=MaxPool>, <tf.Operation 'block4_pool/MaxPool' type=MaxPool>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Reshape_2' type=Reshape>, <tf.Operation 'flatten/Shape' type=Shape>, <tf.Operation 'flatten/Reshape' type=Reshape>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/concat' type=ConcatV2>, <tf.Operation 'loss/predictions_loss/weighted_loss/Mul' type=Mul>, <tf.Operation 'loss/predictions_loss/weighted_loss/broadcast_weights/ones_like/Shape' type=Shape>, <tf.Operation 'flatten/strided_slice' type=StridedSlice>, <tf.Operation 'loss/predictions_loss/weighted_loss/broadcast_weights/ones_like' type=Fill>, <tf.Operation 'loss/predictions_loss/Sum' type=Sum>, <tf.Operation 'flatten/Reshape/shape' type=Pack>, <tf.Operation 'loss/predictions_loss/num_elements' type=Size>, <tf.Operation 'loss/predictions_loss/Sum_1' type=Sum>, <tf.Operation 'loss/predictions_loss/weighted_loss/broadcast_weights' type=Mul>, <tf.Operation 'loss/predictions_loss/num_elements/Cast' type=Cast>, <tf.Operation 'loss/predictions_loss/value' type=DivNoNan>, <tf.Operation 'loss/mul' type=Mul>], seed [<tf.Operation 'fc1/Relu' type=Relu>], stop_at [<tf.Tensor 'block1_conv1/Relu:0' shape=(?, 224, 224, 64) dtype=float32>, <tf.Tensor 'block2_conv1/Relu:0' shape=(?, 112, 112, 128) dtype=float32>, <tf.Tensor 'block3_conv1/Relu:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'block3_conv2/Relu:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'block4_conv1/Relu:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'block4_conv2/Relu:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'block5_conv1/Relu:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'block5_conv2/Relu:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'fc2/Relu:0' shape=(?, 4096) dtype=float32>]
[STR DEBUG] ops_to_copy = [<tf.Operation 'block5_conv3/BiasAdd' type=BiasAdd>, <tf.Operation 'block5_pool/MaxPool' type=MaxPool>, <tf.Operation 'block5_conv3/Relu' type=Relu>, <tf.Operation 'fc1/Relu' type=Relu>, <tf.Operation 'fc1/BiasAdd' type=BiasAdd>, <tf.Operation 'flatten/Shape' type=Shape>, <tf.Operation 'flatten/Reshape' type=Reshape>, <tf.Operation 'block5_conv3/Conv2D' type=Conv2D>, <tf.Operation 'fc1/MatMul' type=MatMul>, <tf.Operation 'flatten/strided_slice' type=StridedSlice>, <tf.Operation 'flatten/Reshape/shape' type=Pack>]
[STR DEBUG] Copied [<tf.Operation 'block5_conv3/BiasAdd' type=BiasAdd>, <tf.Operation 'block5_pool/MaxPool' type=MaxPool>, <tf.Operation 'block5_conv3/Relu' type=Relu>, <tf.Operation 'fc1/Relu' type=Relu>, <tf.Operation 'fc1/BiasAdd' type=BiasAdd>, <tf.Operation 'flatten/Shape' type=Shape>, <tf.Operation 'flatten/Reshape' type=Reshape>, <tf.Operation 'block5_conv3/Conv2D' type=Conv2D>, <tf.Operation 'fc1/MatMul' type=MatMul>, <tf.Operation 'flatten/strided_slice' type=StridedSlice>, <tf.Operation 'flatten/Reshape/shape' type=Pack>] to dict_values([<tf.Operation 'training/RMSprop/gradients/block5_conv3/Conv2D' type=Conv2D>, <tf.Operation 'training/RMSprop/gradients/block5_conv3/BiasAdd' type=BiasAdd>, <tf.Operation 'training/RMSprop/gradients/block5_conv3/Relu' type=Relu>, <tf.Operation 'training/RMSprop/gradients/block5_pool/MaxPool' type=MaxPool>, <tf.Operation 'training/RMSprop/gradients/flatten/Shape' type=Shape>, <tf.Operation 'training/RMSprop/gradients/flatten/strided_slice' type=StridedSlice>, <tf.Operation 'training/RMSprop/gradients/flatten/Reshape/shape' type=Pack>, <tf.Operation 'training/RMSprop/gradients/flatten/Reshape' type=Reshape>, <tf.Operation 'training/RMSprop/gradients/fc1/MatMul' type=MatMul>, <tf.Operation 'training/RMSprop/gradients/fc1/BiasAdd' type=BiasAdd>, <tf.Operation 'training/RMSprop/gradients/fc1/Relu' type=Relu>])
[STR DEBUG] Rewired [<tf.Tensor 'training/RMSprop/gradients/block1_conv1/Relu_sg:0' shape=(?, 224, 224, 64) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block2_conv1/Relu_sg:0' shape=(?, 112, 112, 128) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block3_conv1/Relu_sg:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block3_conv2/Relu_sg:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block4_conv1/Relu_sg:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block4_conv2/Relu_sg:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block5_conv1/Relu_sg:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block5_conv2/Relu_sg:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/fc2/Relu_sg:0' shape=(?, 4096) dtype=float32>] in place of [<tf.Tensor 'block1_conv1/Relu:0' shape=(?, 224, 224, 64) dtype=float32>, <tf.Tensor 'block2_conv1/Relu:0' shape=(?, 112, 112, 128) dtype=float32>, <tf.Tensor 'block3_conv1/Relu:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'block3_conv2/Relu:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'block4_conv1/Relu:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'block4_conv2/Relu:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'block5_conv1/Relu:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'block5_conv2/Relu:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'fc2/Relu:0' shape=(?, 4096) dtype=float32>] restricted to dict_values([<tf.Operation 'training/RMSprop/gradients/block5_conv3/Conv2D' type=Conv2D>, <tf.Operation 'training/RMSprop/gradients/block5_conv3/BiasAdd' type=BiasAdd>, <tf.Operation 'training/RMSprop/gradients/block5_conv3/Relu' type=Relu>, <tf.Operation 'training/RMSprop/gradients/block5_pool/MaxPool' type=MaxPool>, <tf.Operation 'training/RMSprop/gradients/flatten/Shape' type=Shape>, <tf.Operation 'training/RMSprop/gradients/flatten/strided_slice' type=StridedSlice>, <tf.Operation 'training/RMSprop/gradients/flatten/Reshape/shape' type=Pack>, <tf.Operation 'training/RMSprop/gradients/flatten/Reshape' type=Reshape>, <tf.Operation 'training/RMSprop/gradients/fc1/MatMul' type=MatMul>, <tf.Operation 'training/RMSprop/gradients/fc1/BiasAdd' type=BiasAdd>, <tf.Operation 'training/RMSprop/gradients/fc1/Relu' type=Relu>])
[STR DEBUG] Got gradients [None, None, None, None, None, None, None, <tf.Tensor 'training/RMSprop/gradients/gradients_2/training/RMSprop/gradients/block5_conv3/Conv2D_grad/Conv2DBackpropInput:0' shape=(?, 14, 14, 512) dtype=float32>, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, <tf.Tensor 'training/RMSprop/gradients/gradients_2/training/RMSprop/gradients/block5_conv3/Conv2D_grad/Conv2DBackpropFilter:0' shape=(3, 3, 512, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/gradients_2/training/RMSprop/gradients/block5_conv3/BiasAdd_grad/BiasAddGrad:0' shape=(512,) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/gradients_2/training/RMSprop/gradients/fc1/MatMul_grad/MatMul_1:0' shape=(25088, 4096) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/gradients_2/training/RMSprop/gradients/fc1/BiasAdd_grad/BiasAddGrad:0' shape=(4096,) dtype=float32>, None, None, None, None]
[STR DEBUG] for [<tf.Tensor 'training/RMSprop/gradients/fc1/Relu:0' shape=(?, 4096) dtype=float32>]
[STR DEBUG] with respect to boundary: [<tf.Tensor 'training/RMSprop/gradients/block1_conv1/Relu_sg:0' shape=(?, 224, 224, 64) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block2_conv1/Relu_sg:0' shape=(?, 112, 112, 128) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block3_conv1/Relu_sg:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block3_conv2/Relu_sg:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block4_conv1/Relu_sg:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block4_conv2/Relu_sg:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block5_conv1/Relu_sg:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block5_conv2/Relu_sg:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/fc2/Relu_sg:0' shape=(?, 4096) dtype=float32>], xs: [<tf.Variable 'block1_conv1/kernel:0' shape=(3, 3, 3, 64) dtype=float32>, <tf.Variable 'block1_conv1/bias:0' shape=(64,) dtype=float32>, <tf.Variable 'block1_conv2/kernel:0' shape=(3, 3, 64, 64) dtype=float32>, <tf.Variable 'block1_conv2/bias:0' shape=(64,) dtype=float32>, <tf.Variable 'block2_conv1/kernel:0' shape=(3, 3, 64, 128) dtype=float32>, <tf.Variable 'block2_conv1/bias:0' shape=(128,) dtype=float32>, <tf.Variable 'block2_conv2/kernel:0' shape=(3, 3, 128, 128) dtype=float32>, <tf.Variable 'block2_conv2/bias:0' shape=(128,) dtype=float32>, <tf.Variable 'block3_conv1/kernel:0' shape=(3, 3, 128, 256) dtype=float32>, <tf.Variable 'block3_conv1/bias:0' shape=(256,) dtype=float32>, <tf.Variable 'block3_conv2/kernel:0' shape=(3, 3, 256, 256) dtype=float32>, <tf.Variable 'block3_conv2/bias:0' shape=(256,) dtype=float32>, <tf.Variable 'block3_conv3/kernel:0' shape=(3, 3, 256, 256) dtype=float32>, <tf.Variable 'block3_conv3/bias:0' shape=(256,) dtype=float32>, <tf.Variable 'block4_conv1/kernel:0' shape=(3, 3, 256, 512) dtype=float32>, <tf.Variable 'block4_conv1/bias:0' shape=(512,) dtype=float32>, <tf.Variable 'block4_conv2/kernel:0' shape=(3, 3, 512, 512) dtype=float32>, <tf.Variable 'block4_conv2/bias:0' shape=(512,) dtype=float32>, <tf.Variable 'block4_conv3/kernel:0' shape=(3, 3, 512, 512) dtype=float32>, <tf.Variable 'block4_conv3/bias:0' shape=(512,) dtype=float32>, <tf.Variable 'block5_conv1/kernel:0' shape=(3, 3, 512, 512) dtype=float32>, <tf.Variable 'block5_conv1/bias:0' shape=(512,) dtype=float32>, <tf.Variable 'block5_conv2/kernel:0' shape=(3, 3, 512, 512) dtype=float32>, <tf.Variable 'block5_conv2/bias:0' shape=(512,) dtype=float32>, <tf.Variable 'block5_conv3/kernel:0' shape=(3, 3, 512, 512) dtype=float32>, <tf.Variable 'block5_conv3/bias:0' shape=(512,) dtype=float32>, <tf.Variable 'fc1/kernel:0' shape=(25088, 4096) dtype=float32>, <tf.Variable 'fc1/bias:0' shape=(4096,) dtype=float32>, <tf.Variable 'fc2/kernel:0' shape=(4096, 4096) dtype=float32>, <tf.Variable 'fc2/bias:0' shape=(4096,) dtype=float32>, <tf.Variable 'predictions/kernel:0' shape=(4096, 10) dtype=float32>, <tf.Variable 'predictions/bias:0' shape=(10,) dtype=float32>]
[STR DEBUG] with boundary backprop substitutions [<tf.Tensor 'training/RMSprop/gradients/gradients_1/training/RMSprop/gradients/fc2/MatMul_grad/MatMul:0' shape=(?, 4096) dtype=float32>]
[STR DEBUG] =========end========
[STR DEBUG] =========loop========
[STR DEBUG] Processing list [<tf.Tensor 'block5_conv2/Relu:0' shape=(?, 14, 14, 512) dtype=float32>]
[STR DEBUG] Found 3 ops to copy within [<tf.Operation 'block1_conv2/Conv2D' type=Conv2D>, <tf.Operation 'block3_conv3/Conv2D' type=Conv2D>, <tf.Operation 'block1_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'fc2/BiasAdd' type=BiasAdd>, <tf.Operation 'predictions/BiasAdd' type=BiasAdd>, <tf.Operation 'block2_conv2/Conv2D' type=Conv2D>, <tf.Operation 'block1_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'block2_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'block4_conv3/Conv2D' type=Conv2D>, <tf.Operation 'fc2/MatMul' type=MatMul>, <tf.Operation 'block5_conv3/Conv2D' type=Conv2D>, <tf.Operation 'block3_conv3/BiasAdd' type=BiasAdd>, <tf.Operation 'block4_conv3/BiasAdd' type=BiasAdd>, <tf.Operation 'block5_conv3/BiasAdd' type=BiasAdd>, <tf.Operation 'block2_conv1/Conv2D' type=Conv2D>, <tf.Operation 'block3_conv2/Conv2D' type=Conv2D>, <tf.Operation 'block2_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'block4_conv2/Conv2D' type=Conv2D>, <tf.Operation 'block5_conv2/Conv2D' type=Conv2D>, <tf.Operation 'block3_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'block4_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'block5_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'block3_conv1/Conv2D' type=Conv2D>, <tf.Operation 'block4_conv1/Conv2D' type=Conv2D>, <tf.Operation 'block5_conv1/Conv2D' type=Conv2D>, <tf.Operation 'block3_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'fc1/BiasAdd' type=BiasAdd>, <tf.Operation 'block1_conv1/Conv2D' type=Conv2D>, <tf.Operation 'block5_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'block4_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'fc1/MatMul' type=MatMul>, <tf.Operation 'predictions/MatMul' type=MatMul>, <tf.Operation 'block3_conv2/Relu' type=Relu>, <tf.Operation 'block4_conv2/Relu' type=Relu>, <tf.Operation 'block3_conv3/Relu' type=Relu>, <tf.Operation 'block5_conv2/Relu' type=Relu>, <tf.Operation 'fc2/Relu' type=Relu>, <tf.Operation 'block4_conv3/Relu' type=Relu>, <tf.Operation 'block5_conv3/Relu' type=Relu>, <tf.Operation 'fc1/Relu' type=Relu>, <tf.Operation 'block3_conv1/Relu' type=Relu>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Shape_1' type=Shape>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Reshape' type=Reshape>, <tf.Operation 'block2_conv2/Relu' type=Relu>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Shape' type=Shape>, <tf.Operation 'block1_conv1/Relu' type=Relu>, <tf.Operation 'block1_conv2/Relu' type=Relu>, <tf.Operation 'block2_conv1/Relu' type=Relu>, <tf.Operation 'block4_conv1/Relu' type=Relu>, <tf.Operation 'block5_conv1/Relu' type=Relu>, <tf.Operation 'block5_pool/MaxPool' type=MaxPool>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits' type=SoftmaxCrossEntropyWithLogits>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Slice' type=Slice>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Slice_2' type=Slice>, <tf.Operation 'block1_pool/MaxPool' type=MaxPool>, <tf.Operation 'block2_pool/MaxPool' type=MaxPool>, <tf.Operation 'block3_pool/MaxPool' type=MaxPool>, <tf.Operation 'block4_pool/MaxPool' type=MaxPool>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Reshape_2' type=Reshape>, <tf.Operation 'flatten/Shape' type=Shape>, <tf.Operation 'flatten/Reshape' type=Reshape>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/concat' type=ConcatV2>, <tf.Operation 'loss/predictions_loss/weighted_loss/Mul' type=Mul>, <tf.Operation 'loss/predictions_loss/weighted_loss/broadcast_weights/ones_like/Shape' type=Shape>, <tf.Operation 'flatten/strided_slice' type=StridedSlice>, <tf.Operation 'loss/predictions_loss/weighted_loss/broadcast_weights/ones_like' type=Fill>, <tf.Operation 'loss/predictions_loss/Sum' type=Sum>, <tf.Operation 'flatten/Reshape/shape' type=Pack>, <tf.Operation 'loss/predictions_loss/num_elements' type=Size>, <tf.Operation 'loss/predictions_loss/Sum_1' type=Sum>, <tf.Operation 'loss/predictions_loss/weighted_loss/broadcast_weights' type=Mul>, <tf.Operation 'loss/predictions_loss/num_elements/Cast' type=Cast>, <tf.Operation 'loss/predictions_loss/value' type=DivNoNan>, <tf.Operation 'loss/mul' type=Mul>], seed [<tf.Operation 'block5_conv2/Relu' type=Relu>], stop_at [<tf.Tensor 'block1_conv1/Relu:0' shape=(?, 224, 224, 64) dtype=float32>, <tf.Tensor 'block2_conv1/Relu:0' shape=(?, 112, 112, 128) dtype=float32>, <tf.Tensor 'block3_conv1/Relu:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'block3_conv2/Relu:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'block4_conv1/Relu:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'block4_conv2/Relu:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'block5_conv1/Relu:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'fc1/Relu:0' shape=(?, 4096) dtype=float32>, <tf.Tensor 'fc2/Relu:0' shape=(?, 4096) dtype=float32>]
[STR DEBUG] ops_to_copy = [<tf.Operation 'block5_conv2/Conv2D' type=Conv2D>, <tf.Operation 'block5_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'block5_conv2/Relu' type=Relu>]
[STR DEBUG] Copied [<tf.Operation 'block5_conv2/Conv2D' type=Conv2D>, <tf.Operation 'block5_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'block5_conv2/Relu' type=Relu>] to dict_values([<tf.Operation 'training/RMSprop/gradients/block5_conv2/Conv2D' type=Conv2D>, <tf.Operation 'training/RMSprop/gradients/block5_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'training/RMSprop/gradients/block5_conv2/Relu' type=Relu>])
[STR DEBUG] Rewired [<tf.Tensor 'training/RMSprop/gradients/block1_conv1/Relu_sg:0' shape=(?, 224, 224, 64) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block2_conv1/Relu_sg:0' shape=(?, 112, 112, 128) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block3_conv1/Relu_sg:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block3_conv2/Relu_sg:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block4_conv1/Relu_sg:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block4_conv2/Relu_sg:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block5_conv1/Relu_sg:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/fc1/Relu_sg:0' shape=(?, 4096) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/fc2/Relu_sg:0' shape=(?, 4096) dtype=float32>] in place of [<tf.Tensor 'block1_conv1/Relu:0' shape=(?, 224, 224, 64) dtype=float32>, <tf.Tensor 'block2_conv1/Relu:0' shape=(?, 112, 112, 128) dtype=float32>, <tf.Tensor 'block3_conv1/Relu:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'block3_conv2/Relu:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'block4_conv1/Relu:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'block4_conv2/Relu:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'block5_conv1/Relu:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'fc1/Relu:0' shape=(?, 4096) dtype=float32>, <tf.Tensor 'fc2/Relu:0' shape=(?, 4096) dtype=float32>] restricted to dict_values([<tf.Operation 'training/RMSprop/gradients/block5_conv2/Conv2D' type=Conv2D>, <tf.Operation 'training/RMSprop/gradients/block5_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'training/RMSprop/gradients/block5_conv2/Relu' type=Relu>])
[STR DEBUG] Got gradients [None, None, None, None, None, None, <tf.Tensor 'training/RMSprop/gradients/gradients_3/training/RMSprop/gradients/block5_conv2/Conv2D_grad/Conv2DBackpropInput:0' shape=(?, 14, 14, 512) dtype=float32>, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, <tf.Tensor 'training/RMSprop/gradients/gradients_3/training/RMSprop/gradients/block5_conv2/Conv2D_grad/Conv2DBackpropFilter:0' shape=(3, 3, 512, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/gradients_3/training/RMSprop/gradients/block5_conv2/BiasAdd_grad/BiasAddGrad:0' shape=(512,) dtype=float32>, None, None, None, None, None, None, None, None]
[STR DEBUG] for [<tf.Tensor 'training/RMSprop/gradients/block5_conv2/Relu:0' shape=(?, 14, 14, 512) dtype=float32>]
[STR DEBUG] with respect to boundary: [<tf.Tensor 'training/RMSprop/gradients/block1_conv1/Relu_sg:0' shape=(?, 224, 224, 64) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block2_conv1/Relu_sg:0' shape=(?, 112, 112, 128) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block3_conv1/Relu_sg:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block3_conv2/Relu_sg:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block4_conv1/Relu_sg:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block4_conv2/Relu_sg:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block5_conv1/Relu_sg:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/fc1/Relu_sg:0' shape=(?, 4096) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/fc2/Relu_sg:0' shape=(?, 4096) dtype=float32>], xs: [<tf.Variable 'block1_conv1/kernel:0' shape=(3, 3, 3, 64) dtype=float32>, <tf.Variable 'block1_conv1/bias:0' shape=(64,) dtype=float32>, <tf.Variable 'block1_conv2/kernel:0' shape=(3, 3, 64, 64) dtype=float32>, <tf.Variable 'block1_conv2/bias:0' shape=(64,) dtype=float32>, <tf.Variable 'block2_conv1/kernel:0' shape=(3, 3, 64, 128) dtype=float32>, <tf.Variable 'block2_conv1/bias:0' shape=(128,) dtype=float32>, <tf.Variable 'block2_conv2/kernel:0' shape=(3, 3, 128, 128) dtype=float32>, <tf.Variable 'block2_conv2/bias:0' shape=(128,) dtype=float32>, <tf.Variable 'block3_conv1/kernel:0' shape=(3, 3, 128, 256) dtype=float32>, <tf.Variable 'block3_conv1/bias:0' shape=(256,) dtype=float32>, <tf.Variable 'block3_conv2/kernel:0' shape=(3, 3, 256, 256) dtype=float32>, <tf.Variable 'block3_conv2/bias:0' shape=(256,) dtype=float32>, <tf.Variable 'block3_conv3/kernel:0' shape=(3, 3, 256, 256) dtype=float32>, <tf.Variable 'block3_conv3/bias:0' shape=(256,) dtype=float32>, <tf.Variable 'block4_conv1/kernel:0' shape=(3, 3, 256, 512) dtype=float32>, <tf.Variable 'block4_conv1/bias:0' shape=(512,) dtype=float32>, <tf.Variable 'block4_conv2/kernel:0' shape=(3, 3, 512, 512) dtype=float32>, <tf.Variable 'block4_conv2/bias:0' shape=(512,) dtype=float32>, <tf.Variable 'block4_conv3/kernel:0' shape=(3, 3, 512, 512) dtype=float32>, <tf.Variable 'block4_conv3/bias:0' shape=(512,) dtype=float32>, <tf.Variable 'block5_conv1/kernel:0' shape=(3, 3, 512, 512) dtype=float32>, <tf.Variable 'block5_conv1/bias:0' shape=(512,) dtype=float32>, <tf.Variable 'block5_conv2/kernel:0' shape=(3, 3, 512, 512) dtype=float32>, <tf.Variable 'block5_conv2/bias:0' shape=(512,) dtype=float32>, <tf.Variable 'block5_conv3/kernel:0' shape=(3, 3, 512, 512) dtype=float32>, <tf.Variable 'block5_conv3/bias:0' shape=(512,) dtype=float32>, <tf.Variable 'fc1/kernel:0' shape=(25088, 4096) dtype=float32>, <tf.Variable 'fc1/bias:0' shape=(4096,) dtype=float32>, <tf.Variable 'fc2/kernel:0' shape=(4096, 4096) dtype=float32>, <tf.Variable 'fc2/bias:0' shape=(4096,) dtype=float32>, <tf.Variable 'predictions/kernel:0' shape=(4096, 10) dtype=float32>, <tf.Variable 'predictions/bias:0' shape=(10,) dtype=float32>]
[STR DEBUG] with boundary backprop substitutions [<tf.Tensor 'training/RMSprop/gradients/gradients_2/training/RMSprop/gradients/block5_conv3/Conv2D_grad/Conv2DBackpropInput:0' shape=(?, 14, 14, 512) dtype=float32>]
[STR DEBUG] =========end========
[STR DEBUG] =========loop========
[STR DEBUG] Processing list [<tf.Tensor 'block5_conv1/Relu:0' shape=(?, 14, 14, 512) dtype=float32>]
[STR DEBUG] Found 7 ops to copy within [<tf.Operation 'block1_conv2/Conv2D' type=Conv2D>, <tf.Operation 'block3_conv3/Conv2D' type=Conv2D>, <tf.Operation 'block1_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'fc2/BiasAdd' type=BiasAdd>, <tf.Operation 'predictions/BiasAdd' type=BiasAdd>, <tf.Operation 'block2_conv2/Conv2D' type=Conv2D>, <tf.Operation 'block1_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'block2_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'block4_conv3/Conv2D' type=Conv2D>, <tf.Operation 'fc2/MatMul' type=MatMul>, <tf.Operation 'block5_conv3/Conv2D' type=Conv2D>, <tf.Operation 'block3_conv3/BiasAdd' type=BiasAdd>, <tf.Operation 'block4_conv3/BiasAdd' type=BiasAdd>, <tf.Operation 'block5_conv3/BiasAdd' type=BiasAdd>, <tf.Operation 'block2_conv1/Conv2D' type=Conv2D>, <tf.Operation 'block3_conv2/Conv2D' type=Conv2D>, <tf.Operation 'block2_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'block4_conv2/Conv2D' type=Conv2D>, <tf.Operation 'block5_conv2/Conv2D' type=Conv2D>, <tf.Operation 'block3_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'block4_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'block5_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'block3_conv1/Conv2D' type=Conv2D>, <tf.Operation 'block4_conv1/Conv2D' type=Conv2D>, <tf.Operation 'block5_conv1/Conv2D' type=Conv2D>, <tf.Operation 'block3_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'fc1/BiasAdd' type=BiasAdd>, <tf.Operation 'block1_conv1/Conv2D' type=Conv2D>, <tf.Operation 'block5_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'block4_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'fc1/MatMul' type=MatMul>, <tf.Operation 'predictions/MatMul' type=MatMul>, <tf.Operation 'block3_conv2/Relu' type=Relu>, <tf.Operation 'block4_conv2/Relu' type=Relu>, <tf.Operation 'block3_conv3/Relu' type=Relu>, <tf.Operation 'block5_conv2/Relu' type=Relu>, <tf.Operation 'fc2/Relu' type=Relu>, <tf.Operation 'block4_conv3/Relu' type=Relu>, <tf.Operation 'block5_conv3/Relu' type=Relu>, <tf.Operation 'fc1/Relu' type=Relu>, <tf.Operation 'block3_conv1/Relu' type=Relu>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Shape_1' type=Shape>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Reshape' type=Reshape>, <tf.Operation 'block2_conv2/Relu' type=Relu>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Shape' type=Shape>, <tf.Operation 'block1_conv1/Relu' type=Relu>, <tf.Operation 'block1_conv2/Relu' type=Relu>, <tf.Operation 'block2_conv1/Relu' type=Relu>, <tf.Operation 'block4_conv1/Relu' type=Relu>, <tf.Operation 'block5_conv1/Relu' type=Relu>, <tf.Operation 'block5_pool/MaxPool' type=MaxPool>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits' type=SoftmaxCrossEntropyWithLogits>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Slice' type=Slice>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Slice_2' type=Slice>, <tf.Operation 'block1_pool/MaxPool' type=MaxPool>, <tf.Operation 'block2_pool/MaxPool' type=MaxPool>, <tf.Operation 'block3_pool/MaxPool' type=MaxPool>, <tf.Operation 'block4_pool/MaxPool' type=MaxPool>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Reshape_2' type=Reshape>, <tf.Operation 'flatten/Shape' type=Shape>, <tf.Operation 'flatten/Reshape' type=Reshape>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/concat' type=ConcatV2>, <tf.Operation 'loss/predictions_loss/weighted_loss/Mul' type=Mul>, <tf.Operation 'loss/predictions_loss/weighted_loss/broadcast_weights/ones_like/Shape' type=Shape>, <tf.Operation 'flatten/strided_slice' type=StridedSlice>, <tf.Operation 'loss/predictions_loss/weighted_loss/broadcast_weights/ones_like' type=Fill>, <tf.Operation 'loss/predictions_loss/Sum' type=Sum>, <tf.Operation 'flatten/Reshape/shape' type=Pack>, <tf.Operation 'loss/predictions_loss/num_elements' type=Size>, <tf.Operation 'loss/predictions_loss/Sum_1' type=Sum>, <tf.Operation 'loss/predictions_loss/weighted_loss/broadcast_weights' type=Mul>, <tf.Operation 'loss/predictions_loss/num_elements/Cast' type=Cast>, <tf.Operation 'loss/predictions_loss/value' type=DivNoNan>, <tf.Operation 'loss/mul' type=Mul>], seed [<tf.Operation 'block5_conv1/Relu' type=Relu>], stop_at [<tf.Tensor 'block1_conv1/Relu:0' shape=(?, 224, 224, 64) dtype=float32>, <tf.Tensor 'block2_conv1/Relu:0' shape=(?, 112, 112, 128) dtype=float32>, <tf.Tensor 'block3_conv1/Relu:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'block3_conv2/Relu:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'block4_conv1/Relu:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'block4_conv2/Relu:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'block5_conv2/Relu:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'fc1/Relu:0' shape=(?, 4096) dtype=float32>, <tf.Tensor 'fc2/Relu:0' shape=(?, 4096) dtype=float32>]
[STR DEBUG] ops_to_copy = [<tf.Operation 'block4_conv3/Conv2D' type=Conv2D>, <tf.Operation 'block5_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'block5_conv1/Conv2D' type=Conv2D>, <tf.Operation 'block4_conv3/BiasAdd' type=BiasAdd>, <tf.Operation 'block4_conv3/Relu' type=Relu>, <tf.Operation 'block4_pool/MaxPool' type=MaxPool>, <tf.Operation 'block5_conv1/Relu' type=Relu>]
[STR DEBUG] Copied [<tf.Operation 'block4_conv3/Conv2D' type=Conv2D>, <tf.Operation 'block5_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'block5_conv1/Conv2D' type=Conv2D>, <tf.Operation 'block4_conv3/BiasAdd' type=BiasAdd>, <tf.Operation 'block4_conv3/Relu' type=Relu>, <tf.Operation 'block4_pool/MaxPool' type=MaxPool>, <tf.Operation 'block5_conv1/Relu' type=Relu>] to dict_values([<tf.Operation 'training/RMSprop/gradients/block4_conv3/Conv2D' type=Conv2D>, <tf.Operation 'training/RMSprop/gradients/block4_conv3/BiasAdd' type=BiasAdd>, <tf.Operation 'training/RMSprop/gradients/block4_conv3/Relu' type=Relu>, <tf.Operation 'training/RMSprop/gradients/block4_pool/MaxPool' type=MaxPool>, <tf.Operation 'training/RMSprop/gradients/block5_conv1/Conv2D' type=Conv2D>, <tf.Operation 'training/RMSprop/gradients/block5_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'training/RMSprop/gradients/block5_conv1/Relu' type=Relu>])
[STR DEBUG] Rewired [<tf.Tensor 'training/RMSprop/gradients/block1_conv1/Relu_sg:0' shape=(?, 224, 224, 64) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block2_conv1/Relu_sg:0' shape=(?, 112, 112, 128) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block3_conv1/Relu_sg:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block3_conv2/Relu_sg:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block4_conv1/Relu_sg:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block4_conv2/Relu_sg:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block5_conv2/Relu_sg:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/fc1/Relu_sg:0' shape=(?, 4096) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/fc2/Relu_sg:0' shape=(?, 4096) dtype=float32>] in place of [<tf.Tensor 'block1_conv1/Relu:0' shape=(?, 224, 224, 64) dtype=float32>, <tf.Tensor 'block2_conv1/Relu:0' shape=(?, 112, 112, 128) dtype=float32>, <tf.Tensor 'block3_conv1/Relu:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'block3_conv2/Relu:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'block4_conv1/Relu:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'block4_conv2/Relu:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'block5_conv2/Relu:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'fc1/Relu:0' shape=(?, 4096) dtype=float32>, <tf.Tensor 'fc2/Relu:0' shape=(?, 4096) dtype=float32>] restricted to dict_values([<tf.Operation 'training/RMSprop/gradients/block4_conv3/Conv2D' type=Conv2D>, <tf.Operation 'training/RMSprop/gradients/block4_conv3/BiasAdd' type=BiasAdd>, <tf.Operation 'training/RMSprop/gradients/block4_conv3/Relu' type=Relu>, <tf.Operation 'training/RMSprop/gradients/block4_pool/MaxPool' type=MaxPool>, <tf.Operation 'training/RMSprop/gradients/block5_conv1/Conv2D' type=Conv2D>, <tf.Operation 'training/RMSprop/gradients/block5_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'training/RMSprop/gradients/block5_conv1/Relu' type=Relu>])
[STR DEBUG] Got gradients [None, None, None, None, None, <tf.Tensor 'training/RMSprop/gradients/gradients_4/training/RMSprop/gradients/block4_conv3/Conv2D_grad/Conv2DBackpropInput:0' shape=(?, 28, 28, 512) dtype=float32>, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, <tf.Tensor 'training/RMSprop/gradients/gradients_4/training/RMSprop/gradients/block4_conv3/Conv2D_grad/Conv2DBackpropFilter:0' shape=(3, 3, 512, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/gradients_4/training/RMSprop/gradients/block4_conv3/BiasAdd_grad/BiasAddGrad:0' shape=(512,) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/gradients_4/training/RMSprop/gradients/block5_conv1/Conv2D_grad/Conv2DBackpropFilter:0' shape=(3, 3, 512, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/gradients_4/training/RMSprop/gradients/block5_conv1/BiasAdd_grad/BiasAddGrad:0' shape=(512,) dtype=float32>, None, None, None, None, None, None, None, None, None, None]
[STR DEBUG] for [<tf.Tensor 'training/RMSprop/gradients/block5_conv1/Relu:0' shape=(?, 14, 14, 512) dtype=float32>]
[STR DEBUG] with respect to boundary: [<tf.Tensor 'training/RMSprop/gradients/block1_conv1/Relu_sg:0' shape=(?, 224, 224, 64) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block2_conv1/Relu_sg:0' shape=(?, 112, 112, 128) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block3_conv1/Relu_sg:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block3_conv2/Relu_sg:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block4_conv1/Relu_sg:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block4_conv2/Relu_sg:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block5_conv2/Relu_sg:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/fc1/Relu_sg:0' shape=(?, 4096) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/fc2/Relu_sg:0' shape=(?, 4096) dtype=float32>], xs: [<tf.Variable 'block1_conv1/kernel:0' shape=(3, 3, 3, 64) dtype=float32>, <tf.Variable 'block1_conv1/bias:0' shape=(64,) dtype=float32>, <tf.Variable 'block1_conv2/kernel:0' shape=(3, 3, 64, 64) dtype=float32>, <tf.Variable 'block1_conv2/bias:0' shape=(64,) dtype=float32>, <tf.Variable 'block2_conv1/kernel:0' shape=(3, 3, 64, 128) dtype=float32>, <tf.Variable 'block2_conv1/bias:0' shape=(128,) dtype=float32>, <tf.Variable 'block2_conv2/kernel:0' shape=(3, 3, 128, 128) dtype=float32>, <tf.Variable 'block2_conv2/bias:0' shape=(128,) dtype=float32>, <tf.Variable 'block3_conv1/kernel:0' shape=(3, 3, 128, 256) dtype=float32>, <tf.Variable 'block3_conv1/bias:0' shape=(256,) dtype=float32>, <tf.Variable 'block3_conv2/kernel:0' shape=(3, 3, 256, 256) dtype=float32>, <tf.Variable 'block3_conv2/bias:0' shape=(256,) dtype=float32>, <tf.Variable 'block3_conv3/kernel:0' shape=(3, 3, 256, 256) dtype=float32>, <tf.Variable 'block3_conv3/bias:0' shape=(256,) dtype=float32>, <tf.Variable 'block4_conv1/kernel:0' shape=(3, 3, 256, 512) dtype=float32>, <tf.Variable 'block4_conv1/bias:0' shape=(512,) dtype=float32>, <tf.Variable 'block4_conv2/kernel:0' shape=(3, 3, 512, 512) dtype=float32>, <tf.Variable 'block4_conv2/bias:0' shape=(512,) dtype=float32>, <tf.Variable 'block4_conv3/kernel:0' shape=(3, 3, 512, 512) dtype=float32>, <tf.Variable 'block4_conv3/bias:0' shape=(512,) dtype=float32>, <tf.Variable 'block5_conv1/kernel:0' shape=(3, 3, 512, 512) dtype=float32>, <tf.Variable 'block5_conv1/bias:0' shape=(512,) dtype=float32>, <tf.Variable 'block5_conv2/kernel:0' shape=(3, 3, 512, 512) dtype=float32>, <tf.Variable 'block5_conv2/bias:0' shape=(512,) dtype=float32>, <tf.Variable 'block5_conv3/kernel:0' shape=(3, 3, 512, 512) dtype=float32>, <tf.Variable 'block5_conv3/bias:0' shape=(512,) dtype=float32>, <tf.Variable 'fc1/kernel:0' shape=(25088, 4096) dtype=float32>, <tf.Variable 'fc1/bias:0' shape=(4096,) dtype=float32>, <tf.Variable 'fc2/kernel:0' shape=(4096, 4096) dtype=float32>, <tf.Variable 'fc2/bias:0' shape=(4096,) dtype=float32>, <tf.Variable 'predictions/kernel:0' shape=(4096, 10) dtype=float32>, <tf.Variable 'predictions/bias:0' shape=(10,) dtype=float32>]
[STR DEBUG] with boundary backprop substitutions [<tf.Tensor 'training/RMSprop/gradients/gradients_3/training/RMSprop/gradients/block5_conv2/Conv2D_grad/Conv2DBackpropInput:0' shape=(?, 14, 14, 512) dtype=float32>]
[STR DEBUG] =========end========
[STR DEBUG] =========loop========
[STR DEBUG] Processing list [<tf.Tensor 'block4_conv2/Relu:0' shape=(?, 28, 28, 512) dtype=float32>]
[STR DEBUG] Found 3 ops to copy within [<tf.Operation 'block1_conv2/Conv2D' type=Conv2D>, <tf.Operation 'block3_conv3/Conv2D' type=Conv2D>, <tf.Operation 'block1_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'fc2/BiasAdd' type=BiasAdd>, <tf.Operation 'predictions/BiasAdd' type=BiasAdd>, <tf.Operation 'block2_conv2/Conv2D' type=Conv2D>, <tf.Operation 'block1_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'block2_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'block4_conv3/Conv2D' type=Conv2D>, <tf.Operation 'fc2/MatMul' type=MatMul>, <tf.Operation 'block5_conv3/Conv2D' type=Conv2D>, <tf.Operation 'block3_conv3/BiasAdd' type=BiasAdd>, <tf.Operation 'block4_conv3/BiasAdd' type=BiasAdd>, <tf.Operation 'block5_conv3/BiasAdd' type=BiasAdd>, <tf.Operation 'block2_conv1/Conv2D' type=Conv2D>, <tf.Operation 'block3_conv2/Conv2D' type=Conv2D>, <tf.Operation 'block2_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'block4_conv2/Conv2D' type=Conv2D>, <tf.Operation 'block5_conv2/Conv2D' type=Conv2D>, <tf.Operation 'block3_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'block4_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'block5_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'block3_conv1/Conv2D' type=Conv2D>, <tf.Operation 'block4_conv1/Conv2D' type=Conv2D>, <tf.Operation 'block5_conv1/Conv2D' type=Conv2D>, <tf.Operation 'block3_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'fc1/BiasAdd' type=BiasAdd>, <tf.Operation 'block1_conv1/Conv2D' type=Conv2D>, <tf.Operation 'block5_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'block4_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'fc1/MatMul' type=MatMul>, <tf.Operation 'predictions/MatMul' type=MatMul>, <tf.Operation 'block3_conv2/Relu' type=Relu>, <tf.Operation 'block4_conv2/Relu' type=Relu>, <tf.Operation 'block3_conv3/Relu' type=Relu>, <tf.Operation 'block5_conv2/Relu' type=Relu>, <tf.Operation 'fc2/Relu' type=Relu>, <tf.Operation 'block4_conv3/Relu' type=Relu>, <tf.Operation 'block5_conv3/Relu' type=Relu>, <tf.Operation 'fc1/Relu' type=Relu>, <tf.Operation 'block3_conv1/Relu' type=Relu>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Shape_1' type=Shape>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Reshape' type=Reshape>, <tf.Operation 'block2_conv2/Relu' type=Relu>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Shape' type=Shape>, <tf.Operation 'block1_conv1/Relu' type=Relu>, <tf.Operation 'block1_conv2/Relu' type=Relu>, <tf.Operation 'block2_conv1/Relu' type=Relu>, <tf.Operation 'block4_conv1/Relu' type=Relu>, <tf.Operation 'block5_conv1/Relu' type=Relu>, <tf.Operation 'block5_pool/MaxPool' type=MaxPool>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits' type=SoftmaxCrossEntropyWithLogits>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Slice' type=Slice>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Slice_2' type=Slice>, <tf.Operation 'block1_pool/MaxPool' type=MaxPool>, <tf.Operation 'block2_pool/MaxPool' type=MaxPool>, <tf.Operation 'block3_pool/MaxPool' type=MaxPool>, <tf.Operation 'block4_pool/MaxPool' type=MaxPool>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Reshape_2' type=Reshape>, <tf.Operation 'flatten/Shape' type=Shape>, <tf.Operation 'flatten/Reshape' type=Reshape>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/concat' type=ConcatV2>, <tf.Operation 'loss/predictions_loss/weighted_loss/Mul' type=Mul>, <tf.Operation 'loss/predictions_loss/weighted_loss/broadcast_weights/ones_like/Shape' type=Shape>, <tf.Operation 'flatten/strided_slice' type=StridedSlice>, <tf.Operation 'loss/predictions_loss/weighted_loss/broadcast_weights/ones_like' type=Fill>, <tf.Operation 'loss/predictions_loss/Sum' type=Sum>, <tf.Operation 'flatten/Reshape/shape' type=Pack>, <tf.Operation 'loss/predictions_loss/num_elements' type=Size>, <tf.Operation 'loss/predictions_loss/Sum_1' type=Sum>, <tf.Operation 'loss/predictions_loss/weighted_loss/broadcast_weights' type=Mul>, <tf.Operation 'loss/predictions_loss/num_elements/Cast' type=Cast>, <tf.Operation 'loss/predictions_loss/value' type=DivNoNan>, <tf.Operation 'loss/mul' type=Mul>], seed [<tf.Operation 'block4_conv2/Relu' type=Relu>], stop_at [<tf.Tensor 'block1_conv1/Relu:0' shape=(?, 224, 224, 64) dtype=float32>, <tf.Tensor 'block2_conv1/Relu:0' shape=(?, 112, 112, 128) dtype=float32>, <tf.Tensor 'block3_conv1/Relu:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'block3_conv2/Relu:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'block4_conv1/Relu:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'block5_conv1/Relu:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'block5_conv2/Relu:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'fc1/Relu:0' shape=(?, 4096) dtype=float32>, <tf.Tensor 'fc2/Relu:0' shape=(?, 4096) dtype=float32>]
[STR DEBUG] ops_to_copy = [<tf.Operation 'block4_conv2/Conv2D' type=Conv2D>, <tf.Operation 'block4_conv2/Relu' type=Relu>, <tf.Operation 'block4_conv2/BiasAdd' type=BiasAdd>]
[STR DEBUG] Copied [<tf.Operation 'block4_conv2/Conv2D' type=Conv2D>, <tf.Operation 'block4_conv2/Relu' type=Relu>, <tf.Operation 'block4_conv2/BiasAdd' type=BiasAdd>] to dict_values([<tf.Operation 'training/RMSprop/gradients/block4_conv2/Conv2D' type=Conv2D>, <tf.Operation 'training/RMSprop/gradients/block4_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'training/RMSprop/gradients/block4_conv2/Relu' type=Relu>])
[STR DEBUG] Rewired [<tf.Tensor 'training/RMSprop/gradients/block1_conv1/Relu_sg:0' shape=(?, 224, 224, 64) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block2_conv1/Relu_sg:0' shape=(?, 112, 112, 128) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block3_conv1/Relu_sg:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block3_conv2/Relu_sg:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block4_conv1/Relu_sg:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block5_conv1/Relu_sg:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block5_conv2/Relu_sg:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/fc1/Relu_sg:0' shape=(?, 4096) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/fc2/Relu_sg:0' shape=(?, 4096) dtype=float32>] in place of [<tf.Tensor 'block1_conv1/Relu:0' shape=(?, 224, 224, 64) dtype=float32>, <tf.Tensor 'block2_conv1/Relu:0' shape=(?, 112, 112, 128) dtype=float32>, <tf.Tensor 'block3_conv1/Relu:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'block3_conv2/Relu:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'block4_conv1/Relu:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'block5_conv1/Relu:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'block5_conv2/Relu:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'fc1/Relu:0' shape=(?, 4096) dtype=float32>, <tf.Tensor 'fc2/Relu:0' shape=(?, 4096) dtype=float32>] restricted to dict_values([<tf.Operation 'training/RMSprop/gradients/block4_conv2/Conv2D' type=Conv2D>, <tf.Operation 'training/RMSprop/gradients/block4_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'training/RMSprop/gradients/block4_conv2/Relu' type=Relu>])
[STR DEBUG] Got gradients [None, None, None, None, <tf.Tensor 'training/RMSprop/gradients/gradients_5/training/RMSprop/gradients/block4_conv2/Conv2D_grad/Conv2DBackpropInput:0' shape=(?, 28, 28, 512) dtype=float32>, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, <tf.Tensor 'training/RMSprop/gradients/gradients_5/training/RMSprop/gradients/block4_conv2/Conv2D_grad/Conv2DBackpropFilter:0' shape=(3, 3, 512, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/gradients_5/training/RMSprop/gradients/block4_conv2/BiasAdd_grad/BiasAddGrad:0' shape=(512,) dtype=float32>, None, None, None, None, None, None, None, None, None, None, None, None, None, None]
[STR DEBUG] for [<tf.Tensor 'training/RMSprop/gradients/block4_conv2/Relu:0' shape=(?, 28, 28, 512) dtype=float32>]
[STR DEBUG] with respect to boundary: [<tf.Tensor 'training/RMSprop/gradients/block1_conv1/Relu_sg:0' shape=(?, 224, 224, 64) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block2_conv1/Relu_sg:0' shape=(?, 112, 112, 128) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block3_conv1/Relu_sg:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block3_conv2/Relu_sg:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block4_conv1/Relu_sg:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block5_conv1/Relu_sg:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block5_conv2/Relu_sg:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/fc1/Relu_sg:0' shape=(?, 4096) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/fc2/Relu_sg:0' shape=(?, 4096) dtype=float32>], xs: [<tf.Variable 'block1_conv1/kernel:0' shape=(3, 3, 3, 64) dtype=float32>, <tf.Variable 'block1_conv1/bias:0' shape=(64,) dtype=float32>, <tf.Variable 'block1_conv2/kernel:0' shape=(3, 3, 64, 64) dtype=float32>, <tf.Variable 'block1_conv2/bias:0' shape=(64,) dtype=float32>, <tf.Variable 'block2_conv1/kernel:0' shape=(3, 3, 64, 128) dtype=float32>, <tf.Variable 'block2_conv1/bias:0' shape=(128,) dtype=float32>, <tf.Variable 'block2_conv2/kernel:0' shape=(3, 3, 128, 128) dtype=float32>, <tf.Variable 'block2_conv2/bias:0' shape=(128,) dtype=float32>, <tf.Variable 'block3_conv1/kernel:0' shape=(3, 3, 128, 256) dtype=float32>, <tf.Variable 'block3_conv1/bias:0' shape=(256,) dtype=float32>, <tf.Variable 'block3_conv2/kernel:0' shape=(3, 3, 256, 256) dtype=float32>, <tf.Variable 'block3_conv2/bias:0' shape=(256,) dtype=float32>, <tf.Variable 'block3_conv3/kernel:0' shape=(3, 3, 256, 256) dtype=float32>, <tf.Variable 'block3_conv3/bias:0' shape=(256,) dtype=float32>, <tf.Variable 'block4_conv1/kernel:0' shape=(3, 3, 256, 512) dtype=float32>, <tf.Variable 'block4_conv1/bias:0' shape=(512,) dtype=float32>, <tf.Variable 'block4_conv2/kernel:0' shape=(3, 3, 512, 512) dtype=float32>, <tf.Variable 'block4_conv2/bias:0' shape=(512,) dtype=float32>, <tf.Variable 'block4_conv3/kernel:0' shape=(3, 3, 512, 512) dtype=float32>, <tf.Variable 'block4_conv3/bias:0' shape=(512,) dtype=float32>, <tf.Variable 'block5_conv1/kernel:0' shape=(3, 3, 512, 512) dtype=float32>, <tf.Variable 'block5_conv1/bias:0' shape=(512,) dtype=float32>, <tf.Variable 'block5_conv2/kernel:0' shape=(3, 3, 512, 512) dtype=float32>, <tf.Variable 'block5_conv2/bias:0' shape=(512,) dtype=float32>, <tf.Variable 'block5_conv3/kernel:0' shape=(3, 3, 512, 512) dtype=float32>, <tf.Variable 'block5_conv3/bias:0' shape=(512,) dtype=float32>, <tf.Variable 'fc1/kernel:0' shape=(25088, 4096) dtype=float32>, <tf.Variable 'fc1/bias:0' shape=(4096,) dtype=float32>, <tf.Variable 'fc2/kernel:0' shape=(4096, 4096) dtype=float32>, <tf.Variable 'fc2/bias:0' shape=(4096,) dtype=float32>, <tf.Variable 'predictions/kernel:0' shape=(4096, 10) dtype=float32>, <tf.Variable 'predictions/bias:0' shape=(10,) dtype=float32>]
[STR DEBUG] with boundary backprop substitutions [<tf.Tensor 'training/RMSprop/gradients/gradients_4/training/RMSprop/gradients/block4_conv3/Conv2D_grad/Conv2DBackpropInput:0' shape=(?, 28, 28, 512) dtype=float32>]
[STR DEBUG] =========end========
[STR DEBUG] =========loop========
[STR DEBUG] Processing list [<tf.Tensor 'block4_conv1/Relu:0' shape=(?, 28, 28, 512) dtype=float32>]
[STR DEBUG] Found 7 ops to copy within [<tf.Operation 'block1_conv2/Conv2D' type=Conv2D>, <tf.Operation 'block3_conv3/Conv2D' type=Conv2D>, <tf.Operation 'block1_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'fc2/BiasAdd' type=BiasAdd>, <tf.Operation 'predictions/BiasAdd' type=BiasAdd>, <tf.Operation 'block2_conv2/Conv2D' type=Conv2D>, <tf.Operation 'block1_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'block2_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'block4_conv3/Conv2D' type=Conv2D>, <tf.Operation 'fc2/MatMul' type=MatMul>, <tf.Operation 'block5_conv3/Conv2D' type=Conv2D>, <tf.Operation 'block3_conv3/BiasAdd' type=BiasAdd>, <tf.Operation 'block4_conv3/BiasAdd' type=BiasAdd>, <tf.Operation 'block5_conv3/BiasAdd' type=BiasAdd>, <tf.Operation 'block2_conv1/Conv2D' type=Conv2D>, <tf.Operation 'block3_conv2/Conv2D' type=Conv2D>, <tf.Operation 'block2_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'block4_conv2/Conv2D' type=Conv2D>, <tf.Operation 'block5_conv2/Conv2D' type=Conv2D>, <tf.Operation 'block3_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'block4_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'block5_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'block3_conv1/Conv2D' type=Conv2D>, <tf.Operation 'block4_conv1/Conv2D' type=Conv2D>, <tf.Operation 'block5_conv1/Conv2D' type=Conv2D>, <tf.Operation 'block3_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'fc1/BiasAdd' type=BiasAdd>, <tf.Operation 'block1_conv1/Conv2D' type=Conv2D>, <tf.Operation 'block5_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'block4_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'fc1/MatMul' type=MatMul>, <tf.Operation 'predictions/MatMul' type=MatMul>, <tf.Operation 'block3_conv2/Relu' type=Relu>, <tf.Operation 'block4_conv2/Relu' type=Relu>, <tf.Operation 'block3_conv3/Relu' type=Relu>, <tf.Operation 'block5_conv2/Relu' type=Relu>, <tf.Operation 'fc2/Relu' type=Relu>, <tf.Operation 'block4_conv3/Relu' type=Relu>, <tf.Operation 'block5_conv3/Relu' type=Relu>, <tf.Operation 'fc1/Relu' type=Relu>, <tf.Operation 'block3_conv1/Relu' type=Relu>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Shape_1' type=Shape>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Reshape' type=Reshape>, <tf.Operation 'block2_conv2/Relu' type=Relu>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Shape' type=Shape>, <tf.Operation 'block1_conv1/Relu' type=Relu>, <tf.Operation 'block1_conv2/Relu' type=Relu>, <tf.Operation 'block2_conv1/Relu' type=Relu>, <tf.Operation 'block4_conv1/Relu' type=Relu>, <tf.Operation 'block5_conv1/Relu' type=Relu>, <tf.Operation 'block5_pool/MaxPool' type=MaxPool>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits' type=SoftmaxCrossEntropyWithLogits>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Slice' type=Slice>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Slice_2' type=Slice>, <tf.Operation 'block1_pool/MaxPool' type=MaxPool>, <tf.Operation 'block2_pool/MaxPool' type=MaxPool>, <tf.Operation 'block3_pool/MaxPool' type=MaxPool>, <tf.Operation 'block4_pool/MaxPool' type=MaxPool>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Reshape_2' type=Reshape>, <tf.Operation 'flatten/Shape' type=Shape>, <tf.Operation 'flatten/Reshape' type=Reshape>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/concat' type=ConcatV2>, <tf.Operation 'loss/predictions_loss/weighted_loss/Mul' type=Mul>, <tf.Operation 'loss/predictions_loss/weighted_loss/broadcast_weights/ones_like/Shape' type=Shape>, <tf.Operation 'flatten/strided_slice' type=StridedSlice>, <tf.Operation 'loss/predictions_loss/weighted_loss/broadcast_weights/ones_like' type=Fill>, <tf.Operation 'loss/predictions_loss/Sum' type=Sum>, <tf.Operation 'flatten/Reshape/shape' type=Pack>, <tf.Operation 'loss/predictions_loss/num_elements' type=Size>, <tf.Operation 'loss/predictions_loss/Sum_1' type=Sum>, <tf.Operation 'loss/predictions_loss/weighted_loss/broadcast_weights' type=Mul>, <tf.Operation 'loss/predictions_loss/num_elements/Cast' type=Cast>, <tf.Operation 'loss/predictions_loss/value' type=DivNoNan>, <tf.Operation 'loss/mul' type=Mul>], seed [<tf.Operation 'block4_conv1/Relu' type=Relu>], stop_at [<tf.Tensor 'block1_conv1/Relu:0' shape=(?, 224, 224, 64) dtype=float32>, <tf.Tensor 'block2_conv1/Relu:0' shape=(?, 112, 112, 128) dtype=float32>, <tf.Tensor 'block3_conv1/Relu:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'block3_conv2/Relu:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'block4_conv2/Relu:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'block5_conv1/Relu:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'block5_conv2/Relu:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'fc1/Relu:0' shape=(?, 4096) dtype=float32>, <tf.Tensor 'fc2/Relu:0' shape=(?, 4096) dtype=float32>]
[STR DEBUG] ops_to_copy = [<tf.Operation 'block4_conv1/Conv2D' type=Conv2D>, <tf.Operation 'block3_conv3/Relu' type=Relu>, <tf.Operation 'block4_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'block3_pool/MaxPool' type=MaxPool>, <tf.Operation 'block3_conv3/BiasAdd' type=BiasAdd>, <tf.Operation 'block3_conv3/Conv2D' type=Conv2D>, <tf.Operation 'block4_conv1/Relu' type=Relu>]
[STR DEBUG] Copied [<tf.Operation 'block4_conv1/Conv2D' type=Conv2D>, <tf.Operation 'block3_conv3/Relu' type=Relu>, <tf.Operation 'block4_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'block3_pool/MaxPool' type=MaxPool>, <tf.Operation 'block3_conv3/BiasAdd' type=BiasAdd>, <tf.Operation 'block3_conv3/Conv2D' type=Conv2D>, <tf.Operation 'block4_conv1/Relu' type=Relu>] to dict_values([<tf.Operation 'training/RMSprop/gradients/block3_conv3/Conv2D' type=Conv2D>, <tf.Operation 'training/RMSprop/gradients/block3_conv3/BiasAdd' type=BiasAdd>, <tf.Operation 'training/RMSprop/gradients/block3_conv3/Relu' type=Relu>, <tf.Operation 'training/RMSprop/gradients/block3_pool/MaxPool' type=MaxPool>, <tf.Operation 'training/RMSprop/gradients/block4_conv1/Conv2D' type=Conv2D>, <tf.Operation 'training/RMSprop/gradients/block4_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'training/RMSprop/gradients/block4_conv1/Relu' type=Relu>])
[STR DEBUG] Rewired [<tf.Tensor 'training/RMSprop/gradients/block1_conv1/Relu_sg:0' shape=(?, 224, 224, 64) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block2_conv1/Relu_sg:0' shape=(?, 112, 112, 128) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block3_conv1/Relu_sg:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block3_conv2/Relu_sg:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block4_conv2/Relu_sg:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block5_conv1/Relu_sg:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block5_conv2/Relu_sg:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/fc1/Relu_sg:0' shape=(?, 4096) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/fc2/Relu_sg:0' shape=(?, 4096) dtype=float32>] in place of [<tf.Tensor 'block1_conv1/Relu:0' shape=(?, 224, 224, 64) dtype=float32>, <tf.Tensor 'block2_conv1/Relu:0' shape=(?, 112, 112, 128) dtype=float32>, <tf.Tensor 'block3_conv1/Relu:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'block3_conv2/Relu:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'block4_conv2/Relu:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'block5_conv1/Relu:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'block5_conv2/Relu:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'fc1/Relu:0' shape=(?, 4096) dtype=float32>, <tf.Tensor 'fc2/Relu:0' shape=(?, 4096) dtype=float32>] restricted to dict_values([<tf.Operation 'training/RMSprop/gradients/block3_conv3/Conv2D' type=Conv2D>, <tf.Operation 'training/RMSprop/gradients/block3_conv3/BiasAdd' type=BiasAdd>, <tf.Operation 'training/RMSprop/gradients/block3_conv3/Relu' type=Relu>, <tf.Operation 'training/RMSprop/gradients/block3_pool/MaxPool' type=MaxPool>, <tf.Operation 'training/RMSprop/gradients/block4_conv1/Conv2D' type=Conv2D>, <tf.Operation 'training/RMSprop/gradients/block4_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'training/RMSprop/gradients/block4_conv1/Relu' type=Relu>])
[STR DEBUG] Got gradients [None, None, None, <tf.Tensor 'training/RMSprop/gradients/gradients_6/training/RMSprop/gradients/block3_conv3/Conv2D_grad/Conv2DBackpropInput:0' shape=(?, 56, 56, 256) dtype=float32>, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, <tf.Tensor 'training/RMSprop/gradients/gradients_6/training/RMSprop/gradients/block3_conv3/Conv2D_grad/Conv2DBackpropFilter:0' shape=(3, 3, 256, 256) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/gradients_6/training/RMSprop/gradients/block3_conv3/BiasAdd_grad/BiasAddGrad:0' shape=(256,) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/gradients_6/training/RMSprop/gradients/block4_conv1/Conv2D_grad/Conv2DBackpropFilter:0' shape=(3, 3, 256, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/gradients_6/training/RMSprop/gradients/block4_conv1/BiasAdd_grad/BiasAddGrad:0' shape=(512,) dtype=float32>, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None]
[STR DEBUG] for [<tf.Tensor 'training/RMSprop/gradients/block4_conv1/Relu:0' shape=(?, 28, 28, 512) dtype=float32>]
[STR DEBUG] with respect to boundary: [<tf.Tensor 'training/RMSprop/gradients/block1_conv1/Relu_sg:0' shape=(?, 224, 224, 64) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block2_conv1/Relu_sg:0' shape=(?, 112, 112, 128) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block3_conv1/Relu_sg:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block3_conv2/Relu_sg:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block4_conv2/Relu_sg:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block5_conv1/Relu_sg:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block5_conv2/Relu_sg:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/fc1/Relu_sg:0' shape=(?, 4096) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/fc2/Relu_sg:0' shape=(?, 4096) dtype=float32>], xs: [<tf.Variable 'block1_conv1/kernel:0' shape=(3, 3, 3, 64) dtype=float32>, <tf.Variable 'block1_conv1/bias:0' shape=(64,) dtype=float32>, <tf.Variable 'block1_conv2/kernel:0' shape=(3, 3, 64, 64) dtype=float32>, <tf.Variable 'block1_conv2/bias:0' shape=(64,) dtype=float32>, <tf.Variable 'block2_conv1/kernel:0' shape=(3, 3, 64, 128) dtype=float32>, <tf.Variable 'block2_conv1/bias:0' shape=(128,) dtype=float32>, <tf.Variable 'block2_conv2/kernel:0' shape=(3, 3, 128, 128) dtype=float32>, <tf.Variable 'block2_conv2/bias:0' shape=(128,) dtype=float32>, <tf.Variable 'block3_conv1/kernel:0' shape=(3, 3, 128, 256) dtype=float32>, <tf.Variable 'block3_conv1/bias:0' shape=(256,) dtype=float32>, <tf.Variable 'block3_conv2/kernel:0' shape=(3, 3, 256, 256) dtype=float32>, <tf.Variable 'block3_conv2/bias:0' shape=(256,) dtype=float32>, <tf.Variable 'block3_conv3/kernel:0' shape=(3, 3, 256, 256) dtype=float32>, <tf.Variable 'block3_conv3/bias:0' shape=(256,) dtype=float32>, <tf.Variable 'block4_conv1/kernel:0' shape=(3, 3, 256, 512) dtype=float32>, <tf.Variable 'block4_conv1/bias:0' shape=(512,) dtype=float32>, <tf.Variable 'block4_conv2/kernel:0' shape=(3, 3, 512, 512) dtype=float32>, <tf.Variable 'block4_conv2/bias:0' shape=(512,) dtype=float32>, <tf.Variable 'block4_conv3/kernel:0' shape=(3, 3, 512, 512) dtype=float32>, <tf.Variable 'block4_conv3/bias:0' shape=(512,) dtype=float32>, <tf.Variable 'block5_conv1/kernel:0' shape=(3, 3, 512, 512) dtype=float32>, <tf.Variable 'block5_conv1/bias:0' shape=(512,) dtype=float32>, <tf.Variable 'block5_conv2/kernel:0' shape=(3, 3, 512, 512) dtype=float32>, <tf.Variable 'block5_conv2/bias:0' shape=(512,) dtype=float32>, <tf.Variable 'block5_conv3/kernel:0' shape=(3, 3, 512, 512) dtype=float32>, <tf.Variable 'block5_conv3/bias:0' shape=(512,) dtype=float32>, <tf.Variable 'fc1/kernel:0' shape=(25088, 4096) dtype=float32>, <tf.Variable 'fc1/bias:0' shape=(4096,) dtype=float32>, <tf.Variable 'fc2/kernel:0' shape=(4096, 4096) dtype=float32>, <tf.Variable 'fc2/bias:0' shape=(4096,) dtype=float32>, <tf.Variable 'predictions/kernel:0' shape=(4096, 10) dtype=float32>, <tf.Variable 'predictions/bias:0' shape=(10,) dtype=float32>]
[STR DEBUG] with boundary backprop substitutions [<tf.Tensor 'training/RMSprop/gradients/gradients_5/training/RMSprop/gradients/block4_conv2/Conv2D_grad/Conv2DBackpropInput:0' shape=(?, 28, 28, 512) dtype=float32>]
[STR DEBUG] =========end========
[STR DEBUG] =========loop========
[STR DEBUG] Processing list [<tf.Tensor 'block3_conv2/Relu:0' shape=(?, 56, 56, 256) dtype=float32>]
[STR DEBUG] Found 3 ops to copy within [<tf.Operation 'block1_conv2/Conv2D' type=Conv2D>, <tf.Operation 'block3_conv3/Conv2D' type=Conv2D>, <tf.Operation 'block1_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'fc2/BiasAdd' type=BiasAdd>, <tf.Operation 'predictions/BiasAdd' type=BiasAdd>, <tf.Operation 'block2_conv2/Conv2D' type=Conv2D>, <tf.Operation 'block1_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'block2_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'block4_conv3/Conv2D' type=Conv2D>, <tf.Operation 'fc2/MatMul' type=MatMul>, <tf.Operation 'block5_conv3/Conv2D' type=Conv2D>, <tf.Operation 'block3_conv3/BiasAdd' type=BiasAdd>, <tf.Operation 'block4_conv3/BiasAdd' type=BiasAdd>, <tf.Operation 'block5_conv3/BiasAdd' type=BiasAdd>, <tf.Operation 'block2_conv1/Conv2D' type=Conv2D>, <tf.Operation 'block3_conv2/Conv2D' type=Conv2D>, <tf.Operation 'block2_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'block4_conv2/Conv2D' type=Conv2D>, <tf.Operation 'block5_conv2/Conv2D' type=Conv2D>, <tf.Operation 'block3_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'block4_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'block5_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'block3_conv1/Conv2D' type=Conv2D>, <tf.Operation 'block4_conv1/Conv2D' type=Conv2D>, <tf.Operation 'block5_conv1/Conv2D' type=Conv2D>, <tf.Operation 'block3_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'fc1/BiasAdd' type=BiasAdd>, <tf.Operation 'block1_conv1/Conv2D' type=Conv2D>, <tf.Operation 'block5_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'block4_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'fc1/MatMul' type=MatMul>, <tf.Operation 'predictions/MatMul' type=MatMul>, <tf.Operation 'block3_conv2/Relu' type=Relu>, <tf.Operation 'block4_conv2/Relu' type=Relu>, <tf.Operation 'block3_conv3/Relu' type=Relu>, <tf.Operation 'block5_conv2/Relu' type=Relu>, <tf.Operation 'fc2/Relu' type=Relu>, <tf.Operation 'block4_conv3/Relu' type=Relu>, <tf.Operation 'block5_conv3/Relu' type=Relu>, <tf.Operation 'fc1/Relu' type=Relu>, <tf.Operation 'block3_conv1/Relu' type=Relu>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Shape_1' type=Shape>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Reshape' type=Reshape>, <tf.Operation 'block2_conv2/Relu' type=Relu>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Shape' type=Shape>, <tf.Operation 'block1_conv1/Relu' type=Relu>, <tf.Operation 'block1_conv2/Relu' type=Relu>, <tf.Operation 'block2_conv1/Relu' type=Relu>, <tf.Operation 'block4_conv1/Relu' type=Relu>, <tf.Operation 'block5_conv1/Relu' type=Relu>, <tf.Operation 'block5_pool/MaxPool' type=MaxPool>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits' type=SoftmaxCrossEntropyWithLogits>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Slice' type=Slice>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Slice_2' type=Slice>, <tf.Operation 'block1_pool/MaxPool' type=MaxPool>, <tf.Operation 'block2_pool/MaxPool' type=MaxPool>, <tf.Operation 'block3_pool/MaxPool' type=MaxPool>, <tf.Operation 'block4_pool/MaxPool' type=MaxPool>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Reshape_2' type=Reshape>, <tf.Operation 'flatten/Shape' type=Shape>, <tf.Operation 'flatten/Reshape' type=Reshape>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/concat' type=ConcatV2>, <tf.Operation 'loss/predictions_loss/weighted_loss/Mul' type=Mul>, <tf.Operation 'loss/predictions_loss/weighted_loss/broadcast_weights/ones_like/Shape' type=Shape>, <tf.Operation 'flatten/strided_slice' type=StridedSlice>, <tf.Operation 'loss/predictions_loss/weighted_loss/broadcast_weights/ones_like' type=Fill>, <tf.Operation 'loss/predictions_loss/Sum' type=Sum>, <tf.Operation 'flatten/Reshape/shape' type=Pack>, <tf.Operation 'loss/predictions_loss/num_elements' type=Size>, <tf.Operation 'loss/predictions_loss/Sum_1' type=Sum>, <tf.Operation 'loss/predictions_loss/weighted_loss/broadcast_weights' type=Mul>, <tf.Operation 'loss/predictions_loss/num_elements/Cast' type=Cast>, <tf.Operation 'loss/predictions_loss/value' type=DivNoNan>, <tf.Operation 'loss/mul' type=Mul>], seed [<tf.Operation 'block3_conv2/Relu' type=Relu>], stop_at [<tf.Tensor 'block1_conv1/Relu:0' shape=(?, 224, 224, 64) dtype=float32>, <tf.Tensor 'block2_conv1/Relu:0' shape=(?, 112, 112, 128) dtype=float32>, <tf.Tensor 'block3_conv1/Relu:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'block4_conv1/Relu:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'block4_conv2/Relu:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'block5_conv1/Relu:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'block5_conv2/Relu:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'fc1/Relu:0' shape=(?, 4096) dtype=float32>, <tf.Tensor 'fc2/Relu:0' shape=(?, 4096) dtype=float32>]
[STR DEBUG] ops_to_copy = [<tf.Operation 'block3_conv2/Relu' type=Relu>, <tf.Operation 'block3_conv2/Conv2D' type=Conv2D>, <tf.Operation 'block3_conv2/BiasAdd' type=BiasAdd>]
[STR DEBUG] Copied [<tf.Operation 'block3_conv2/Relu' type=Relu>, <tf.Operation 'block3_conv2/Conv2D' type=Conv2D>, <tf.Operation 'block3_conv2/BiasAdd' type=BiasAdd>] to dict_values([<tf.Operation 'training/RMSprop/gradients/block3_conv2/Conv2D' type=Conv2D>, <tf.Operation 'training/RMSprop/gradients/block3_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'training/RMSprop/gradients/block3_conv2/Relu' type=Relu>])
[STR DEBUG] Rewired [<tf.Tensor 'training/RMSprop/gradients/block1_conv1/Relu_sg:0' shape=(?, 224, 224, 64) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block2_conv1/Relu_sg:0' shape=(?, 112, 112, 128) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block3_conv1/Relu_sg:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block4_conv1/Relu_sg:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block4_conv2/Relu_sg:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block5_conv1/Relu_sg:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block5_conv2/Relu_sg:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/fc1/Relu_sg:0' shape=(?, 4096) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/fc2/Relu_sg:0' shape=(?, 4096) dtype=float32>] in place of [<tf.Tensor 'block1_conv1/Relu:0' shape=(?, 224, 224, 64) dtype=float32>, <tf.Tensor 'block2_conv1/Relu:0' shape=(?, 112, 112, 128) dtype=float32>, <tf.Tensor 'block3_conv1/Relu:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'block4_conv1/Relu:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'block4_conv2/Relu:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'block5_conv1/Relu:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'block5_conv2/Relu:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'fc1/Relu:0' shape=(?, 4096) dtype=float32>, <tf.Tensor 'fc2/Relu:0' shape=(?, 4096) dtype=float32>] restricted to dict_values([<tf.Operation 'training/RMSprop/gradients/block3_conv2/Conv2D' type=Conv2D>, <tf.Operation 'training/RMSprop/gradients/block3_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'training/RMSprop/gradients/block3_conv2/Relu' type=Relu>])
[STR DEBUG] Got gradients [None, None, <tf.Tensor 'training/RMSprop/gradients/gradients_7/training/RMSprop/gradients/block3_conv2/Conv2D_grad/Conv2DBackpropInput:0' shape=(?, 56, 56, 256) dtype=float32>, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, <tf.Tensor 'training/RMSprop/gradients/gradients_7/training/RMSprop/gradients/block3_conv2/Conv2D_grad/Conv2DBackpropFilter:0' shape=(3, 3, 256, 256) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/gradients_7/training/RMSprop/gradients/block3_conv2/BiasAdd_grad/BiasAddGrad:0' shape=(256,) dtype=float32>, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None]
[STR DEBUG] for [<tf.Tensor 'training/RMSprop/gradients/block3_conv2/Relu:0' shape=(?, 56, 56, 256) dtype=float32>]
[STR DEBUG] with respect to boundary: [<tf.Tensor 'training/RMSprop/gradients/block1_conv1/Relu_sg:0' shape=(?, 224, 224, 64) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block2_conv1/Relu_sg:0' shape=(?, 112, 112, 128) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block3_conv1/Relu_sg:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block4_conv1/Relu_sg:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block4_conv2/Relu_sg:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block5_conv1/Relu_sg:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block5_conv2/Relu_sg:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/fc1/Relu_sg:0' shape=(?, 4096) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/fc2/Relu_sg:0' shape=(?, 4096) dtype=float32>], xs: [<tf.Variable 'block1_conv1/kernel:0' shape=(3, 3, 3, 64) dtype=float32>, <tf.Variable 'block1_conv1/bias:0' shape=(64,) dtype=float32>, <tf.Variable 'block1_conv2/kernel:0' shape=(3, 3, 64, 64) dtype=float32>, <tf.Variable 'block1_conv2/bias:0' shape=(64,) dtype=float32>, <tf.Variable 'block2_conv1/kernel:0' shape=(3, 3, 64, 128) dtype=float32>, <tf.Variable 'block2_conv1/bias:0' shape=(128,) dtype=float32>, <tf.Variable 'block2_conv2/kernel:0' shape=(3, 3, 128, 128) dtype=float32>, <tf.Variable 'block2_conv2/bias:0' shape=(128,) dtype=float32>, <tf.Variable 'block3_conv1/kernel:0' shape=(3, 3, 128, 256) dtype=float32>, <tf.Variable 'block3_conv1/bias:0' shape=(256,) dtype=float32>, <tf.Variable 'block3_conv2/kernel:0' shape=(3, 3, 256, 256) dtype=float32>, <tf.Variable 'block3_conv2/bias:0' shape=(256,) dtype=float32>, <tf.Variable 'block3_conv3/kernel:0' shape=(3, 3, 256, 256) dtype=float32>, <tf.Variable 'block3_conv3/bias:0' shape=(256,) dtype=float32>, <tf.Variable 'block4_conv1/kernel:0' shape=(3, 3, 256, 512) dtype=float32>, <tf.Variable 'block4_conv1/bias:0' shape=(512,) dtype=float32>, <tf.Variable 'block4_conv2/kernel:0' shape=(3, 3, 512, 512) dtype=float32>, <tf.Variable 'block4_conv2/bias:0' shape=(512,) dtype=float32>, <tf.Variable 'block4_conv3/kernel:0' shape=(3, 3, 512, 512) dtype=float32>, <tf.Variable 'block4_conv3/bias:0' shape=(512,) dtype=float32>, <tf.Variable 'block5_conv1/kernel:0' shape=(3, 3, 512, 512) dtype=float32>, <tf.Variable 'block5_conv1/bias:0' shape=(512,) dtype=float32>, <tf.Variable 'block5_conv2/kernel:0' shape=(3, 3, 512, 512) dtype=float32>, <tf.Variable 'block5_conv2/bias:0' shape=(512,) dtype=float32>, <tf.Variable 'block5_conv3/kernel:0' shape=(3, 3, 512, 512) dtype=float32>, <tf.Variable 'block5_conv3/bias:0' shape=(512,) dtype=float32>, <tf.Variable 'fc1/kernel:0' shape=(25088, 4096) dtype=float32>, <tf.Variable 'fc1/bias:0' shape=(4096,) dtype=float32>, <tf.Variable 'fc2/kernel:0' shape=(4096, 4096) dtype=float32>, <tf.Variable 'fc2/bias:0' shape=(4096,) dtype=float32>, <tf.Variable 'predictions/kernel:0' shape=(4096, 10) dtype=float32>, <tf.Variable 'predictions/bias:0' shape=(10,) dtype=float32>]
[STR DEBUG] with boundary backprop substitutions [<tf.Tensor 'training/RMSprop/gradients/gradients_6/training/RMSprop/gradients/block3_conv3/Conv2D_grad/Conv2DBackpropInput:0' shape=(?, 56, 56, 256) dtype=float32>]
[STR DEBUG] =========end========
[STR DEBUG] =========loop========
[STR DEBUG] Processing list [<tf.Tensor 'block3_conv1/Relu:0' shape=(?, 56, 56, 256) dtype=float32>]
[STR DEBUG] Found 7 ops to copy within [<tf.Operation 'block1_conv2/Conv2D' type=Conv2D>, <tf.Operation 'block3_conv3/Conv2D' type=Conv2D>, <tf.Operation 'block1_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'fc2/BiasAdd' type=BiasAdd>, <tf.Operation 'predictions/BiasAdd' type=BiasAdd>, <tf.Operation 'block2_conv2/Conv2D' type=Conv2D>, <tf.Operation 'block1_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'block2_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'block4_conv3/Conv2D' type=Conv2D>, <tf.Operation 'fc2/MatMul' type=MatMul>, <tf.Operation 'block5_conv3/Conv2D' type=Conv2D>, <tf.Operation 'block3_conv3/BiasAdd' type=BiasAdd>, <tf.Operation 'block4_conv3/BiasAdd' type=BiasAdd>, <tf.Operation 'block5_conv3/BiasAdd' type=BiasAdd>, <tf.Operation 'block2_conv1/Conv2D' type=Conv2D>, <tf.Operation 'block3_conv2/Conv2D' type=Conv2D>, <tf.Operation 'block2_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'block4_conv2/Conv2D' type=Conv2D>, <tf.Operation 'block5_conv2/Conv2D' type=Conv2D>, <tf.Operation 'block3_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'block4_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'block5_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'block3_conv1/Conv2D' type=Conv2D>, <tf.Operation 'block4_conv1/Conv2D' type=Conv2D>, <tf.Operation 'block5_conv1/Conv2D' type=Conv2D>, <tf.Operation 'block3_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'fc1/BiasAdd' type=BiasAdd>, <tf.Operation 'block1_conv1/Conv2D' type=Conv2D>, <tf.Operation 'block5_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'block4_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'fc1/MatMul' type=MatMul>, <tf.Operation 'predictions/MatMul' type=MatMul>, <tf.Operation 'block3_conv2/Relu' type=Relu>, <tf.Operation 'block4_conv2/Relu' type=Relu>, <tf.Operation 'block3_conv3/Relu' type=Relu>, <tf.Operation 'block5_conv2/Relu' type=Relu>, <tf.Operation 'fc2/Relu' type=Relu>, <tf.Operation 'block4_conv3/Relu' type=Relu>, <tf.Operation 'block5_conv3/Relu' type=Relu>, <tf.Operation 'fc1/Relu' type=Relu>, <tf.Operation 'block3_conv1/Relu' type=Relu>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Shape_1' type=Shape>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Reshape' type=Reshape>, <tf.Operation 'block2_conv2/Relu' type=Relu>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Shape' type=Shape>, <tf.Operation 'block1_conv1/Relu' type=Relu>, <tf.Operation 'block1_conv2/Relu' type=Relu>, <tf.Operation 'block2_conv1/Relu' type=Relu>, <tf.Operation 'block4_conv1/Relu' type=Relu>, <tf.Operation 'block5_conv1/Relu' type=Relu>, <tf.Operation 'block5_pool/MaxPool' type=MaxPool>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits' type=SoftmaxCrossEntropyWithLogits>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Slice' type=Slice>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Slice_2' type=Slice>, <tf.Operation 'block1_pool/MaxPool' type=MaxPool>, <tf.Operation 'block2_pool/MaxPool' type=MaxPool>, <tf.Operation 'block3_pool/MaxPool' type=MaxPool>, <tf.Operation 'block4_pool/MaxPool' type=MaxPool>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Reshape_2' type=Reshape>, <tf.Operation 'flatten/Shape' type=Shape>, <tf.Operation 'flatten/Reshape' type=Reshape>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/concat' type=ConcatV2>, <tf.Operation 'loss/predictions_loss/weighted_loss/Mul' type=Mul>, <tf.Operation 'loss/predictions_loss/weighted_loss/broadcast_weights/ones_like/Shape' type=Shape>, <tf.Operation 'flatten/strided_slice' type=StridedSlice>, <tf.Operation 'loss/predictions_loss/weighted_loss/broadcast_weights/ones_like' type=Fill>, <tf.Operation 'loss/predictions_loss/Sum' type=Sum>, <tf.Operation 'flatten/Reshape/shape' type=Pack>, <tf.Operation 'loss/predictions_loss/num_elements' type=Size>, <tf.Operation 'loss/predictions_loss/Sum_1' type=Sum>, <tf.Operation 'loss/predictions_loss/weighted_loss/broadcast_weights' type=Mul>, <tf.Operation 'loss/predictions_loss/num_elements/Cast' type=Cast>, <tf.Operation 'loss/predictions_loss/value' type=DivNoNan>, <tf.Operation 'loss/mul' type=Mul>], seed [<tf.Operation 'block3_conv1/Relu' type=Relu>], stop_at [<tf.Tensor 'block1_conv1/Relu:0' shape=(?, 224, 224, 64) dtype=float32>, <tf.Tensor 'block2_conv1/Relu:0' shape=(?, 112, 112, 128) dtype=float32>, <tf.Tensor 'block3_conv2/Relu:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'block4_conv1/Relu:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'block4_conv2/Relu:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'block5_conv1/Relu:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'block5_conv2/Relu:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'fc1/Relu:0' shape=(?, 4096) dtype=float32>, <tf.Tensor 'fc2/Relu:0' shape=(?, 4096) dtype=float32>]
[STR DEBUG] ops_to_copy = [<tf.Operation 'block2_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'block2_conv2/Relu' type=Relu>, <tf.Operation 'block2_conv2/Conv2D' type=Conv2D>, <tf.Operation 'block2_pool/MaxPool' type=MaxPool>, <tf.Operation 'block3_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'block3_conv1/Relu' type=Relu>, <tf.Operation 'block3_conv1/Conv2D' type=Conv2D>]
[STR DEBUG] Copied [<tf.Operation 'block2_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'block2_conv2/Relu' type=Relu>, <tf.Operation 'block2_conv2/Conv2D' type=Conv2D>, <tf.Operation 'block2_pool/MaxPool' type=MaxPool>, <tf.Operation 'block3_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'block3_conv1/Relu' type=Relu>, <tf.Operation 'block3_conv1/Conv2D' type=Conv2D>] to dict_values([<tf.Operation 'training/RMSprop/gradients/block2_conv2/Conv2D' type=Conv2D>, <tf.Operation 'training/RMSprop/gradients/block2_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'training/RMSprop/gradients/block2_conv2/Relu' type=Relu>, <tf.Operation 'training/RMSprop/gradients/block2_pool/MaxPool' type=MaxPool>, <tf.Operation 'training/RMSprop/gradients/block3_conv1/Conv2D' type=Conv2D>, <tf.Operation 'training/RMSprop/gradients/block3_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'training/RMSprop/gradients/block3_conv1/Relu' type=Relu>])
[STR DEBUG] Rewired [<tf.Tensor 'training/RMSprop/gradients/block1_conv1/Relu_sg:0' shape=(?, 224, 224, 64) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block2_conv1/Relu_sg:0' shape=(?, 112, 112, 128) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block3_conv2/Relu_sg:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block4_conv1/Relu_sg:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block4_conv2/Relu_sg:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block5_conv1/Relu_sg:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block5_conv2/Relu_sg:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/fc1/Relu_sg:0' shape=(?, 4096) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/fc2/Relu_sg:0' shape=(?, 4096) dtype=float32>] in place of [<tf.Tensor 'block1_conv1/Relu:0' shape=(?, 224, 224, 64) dtype=float32>, <tf.Tensor 'block2_conv1/Relu:0' shape=(?, 112, 112, 128) dtype=float32>, <tf.Tensor 'block3_conv2/Relu:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'block4_conv1/Relu:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'block4_conv2/Relu:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'block5_conv1/Relu:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'block5_conv2/Relu:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'fc1/Relu:0' shape=(?, 4096) dtype=float32>, <tf.Tensor 'fc2/Relu:0' shape=(?, 4096) dtype=float32>] restricted to dict_values([<tf.Operation 'training/RMSprop/gradients/block2_conv2/Conv2D' type=Conv2D>, <tf.Operation 'training/RMSprop/gradients/block2_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'training/RMSprop/gradients/block2_conv2/Relu' type=Relu>, <tf.Operation 'training/RMSprop/gradients/block2_pool/MaxPool' type=MaxPool>, <tf.Operation 'training/RMSprop/gradients/block3_conv1/Conv2D' type=Conv2D>, <tf.Operation 'training/RMSprop/gradients/block3_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'training/RMSprop/gradients/block3_conv1/Relu' type=Relu>])
[STR DEBUG] Got gradients [None, <tf.Tensor 'training/RMSprop/gradients/gradients_8/training/RMSprop/gradients/block2_conv2/Conv2D_grad/Conv2DBackpropInput:0' shape=(?, 112, 112, 128) dtype=float32>, None, None, None, None, None, None, None, None, None, None, None, None, None, <tf.Tensor 'training/RMSprop/gradients/gradients_8/training/RMSprop/gradients/block2_conv2/Conv2D_grad/Conv2DBackpropFilter:0' shape=(3, 3, 128, 128) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/gradients_8/training/RMSprop/gradients/block2_conv2/BiasAdd_grad/BiasAddGrad:0' shape=(128,) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/gradients_8/training/RMSprop/gradients/block3_conv1/Conv2D_grad/Conv2DBackpropFilter:0' shape=(3, 3, 128, 256) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/gradients_8/training/RMSprop/gradients/block3_conv1/BiasAdd_grad/BiasAddGrad:0' shape=(256,) dtype=float32>, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None]
[STR DEBUG] for [<tf.Tensor 'training/RMSprop/gradients/block3_conv1/Relu:0' shape=(?, 56, 56, 256) dtype=float32>]
[STR DEBUG] with respect to boundary: [<tf.Tensor 'training/RMSprop/gradients/block1_conv1/Relu_sg:0' shape=(?, 224, 224, 64) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block2_conv1/Relu_sg:0' shape=(?, 112, 112, 128) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block3_conv2/Relu_sg:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block4_conv1/Relu_sg:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block4_conv2/Relu_sg:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block5_conv1/Relu_sg:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block5_conv2/Relu_sg:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/fc1/Relu_sg:0' shape=(?, 4096) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/fc2/Relu_sg:0' shape=(?, 4096) dtype=float32>], xs: [<tf.Variable 'block1_conv1/kernel:0' shape=(3, 3, 3, 64) dtype=float32>, <tf.Variable 'block1_conv1/bias:0' shape=(64,) dtype=float32>, <tf.Variable 'block1_conv2/kernel:0' shape=(3, 3, 64, 64) dtype=float32>, <tf.Variable 'block1_conv2/bias:0' shape=(64,) dtype=float32>, <tf.Variable 'block2_conv1/kernel:0' shape=(3, 3, 64, 128) dtype=float32>, <tf.Variable 'block2_conv1/bias:0' shape=(128,) dtype=float32>, <tf.Variable 'block2_conv2/kernel:0' shape=(3, 3, 128, 128) dtype=float32>, <tf.Variable 'block2_conv2/bias:0' shape=(128,) dtype=float32>, <tf.Variable 'block3_conv1/kernel:0' shape=(3, 3, 128, 256) dtype=float32>, <tf.Variable 'block3_conv1/bias:0' shape=(256,) dtype=float32>, <tf.Variable 'block3_conv2/kernel:0' shape=(3, 3, 256, 256) dtype=float32>, <tf.Variable 'block3_conv2/bias:0' shape=(256,) dtype=float32>, <tf.Variable 'block3_conv3/kernel:0' shape=(3, 3, 256, 256) dtype=float32>, <tf.Variable 'block3_conv3/bias:0' shape=(256,) dtype=float32>, <tf.Variable 'block4_conv1/kernel:0' shape=(3, 3, 256, 512) dtype=float32>, <tf.Variable 'block4_conv1/bias:0' shape=(512,) dtype=float32>, <tf.Variable 'block4_conv2/kernel:0' shape=(3, 3, 512, 512) dtype=float32>, <tf.Variable 'block4_conv2/bias:0' shape=(512,) dtype=float32>, <tf.Variable 'block4_conv3/kernel:0' shape=(3, 3, 512, 512) dtype=float32>, <tf.Variable 'block4_conv3/bias:0' shape=(512,) dtype=float32>, <tf.Variable 'block5_conv1/kernel:0' shape=(3, 3, 512, 512) dtype=float32>, <tf.Variable 'block5_conv1/bias:0' shape=(512,) dtype=float32>, <tf.Variable 'block5_conv2/kernel:0' shape=(3, 3, 512, 512) dtype=float32>, <tf.Variable 'block5_conv2/bias:0' shape=(512,) dtype=float32>, <tf.Variable 'block5_conv3/kernel:0' shape=(3, 3, 512, 512) dtype=float32>, <tf.Variable 'block5_conv3/bias:0' shape=(512,) dtype=float32>, <tf.Variable 'fc1/kernel:0' shape=(25088, 4096) dtype=float32>, <tf.Variable 'fc1/bias:0' shape=(4096,) dtype=float32>, <tf.Variable 'fc2/kernel:0' shape=(4096, 4096) dtype=float32>, <tf.Variable 'fc2/bias:0' shape=(4096,) dtype=float32>, <tf.Variable 'predictions/kernel:0' shape=(4096, 10) dtype=float32>, <tf.Variable 'predictions/bias:0' shape=(10,) dtype=float32>]
[STR DEBUG] with boundary backprop substitutions [<tf.Tensor 'training/RMSprop/gradients/gradients_7/training/RMSprop/gradients/block3_conv2/Conv2D_grad/Conv2DBackpropInput:0' shape=(?, 56, 56, 256) dtype=float32>]
[STR DEBUG] =========end========
[STR DEBUG] =========loop========
[STR DEBUG] Processing list [<tf.Tensor 'block2_conv1/Relu:0' shape=(?, 112, 112, 128) dtype=float32>]
[STR DEBUG] Found 7 ops to copy within [<tf.Operation 'block1_conv2/Conv2D' type=Conv2D>, <tf.Operation 'block3_conv3/Conv2D' type=Conv2D>, <tf.Operation 'block1_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'fc2/BiasAdd' type=BiasAdd>, <tf.Operation 'predictions/BiasAdd' type=BiasAdd>, <tf.Operation 'block2_conv2/Conv2D' type=Conv2D>, <tf.Operation 'block1_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'block2_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'block4_conv3/Conv2D' type=Conv2D>, <tf.Operation 'fc2/MatMul' type=MatMul>, <tf.Operation 'block5_conv3/Conv2D' type=Conv2D>, <tf.Operation 'block3_conv3/BiasAdd' type=BiasAdd>, <tf.Operation 'block4_conv3/BiasAdd' type=BiasAdd>, <tf.Operation 'block5_conv3/BiasAdd' type=BiasAdd>, <tf.Operation 'block2_conv1/Conv2D' type=Conv2D>, <tf.Operation 'block3_conv2/Conv2D' type=Conv2D>, <tf.Operation 'block2_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'block4_conv2/Conv2D' type=Conv2D>, <tf.Operation 'block5_conv2/Conv2D' type=Conv2D>, <tf.Operation 'block3_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'block4_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'block5_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'block3_conv1/Conv2D' type=Conv2D>, <tf.Operation 'block4_conv1/Conv2D' type=Conv2D>, <tf.Operation 'block5_conv1/Conv2D' type=Conv2D>, <tf.Operation 'block3_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'fc1/BiasAdd' type=BiasAdd>, <tf.Operation 'block1_conv1/Conv2D' type=Conv2D>, <tf.Operation 'block5_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'block4_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'fc1/MatMul' type=MatMul>, <tf.Operation 'predictions/MatMul' type=MatMul>, <tf.Operation 'block3_conv2/Relu' type=Relu>, <tf.Operation 'block4_conv2/Relu' type=Relu>, <tf.Operation 'block3_conv3/Relu' type=Relu>, <tf.Operation 'block5_conv2/Relu' type=Relu>, <tf.Operation 'fc2/Relu' type=Relu>, <tf.Operation 'block4_conv3/Relu' type=Relu>, <tf.Operation 'block5_conv3/Relu' type=Relu>, <tf.Operation 'fc1/Relu' type=Relu>, <tf.Operation 'block3_conv1/Relu' type=Relu>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Shape_1' type=Shape>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Reshape' type=Reshape>, <tf.Operation 'block2_conv2/Relu' type=Relu>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Shape' type=Shape>, <tf.Operation 'block1_conv1/Relu' type=Relu>, <tf.Operation 'block1_conv2/Relu' type=Relu>, <tf.Operation 'block2_conv1/Relu' type=Relu>, <tf.Operation 'block4_conv1/Relu' type=Relu>, <tf.Operation 'block5_conv1/Relu' type=Relu>, <tf.Operation 'block5_pool/MaxPool' type=MaxPool>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits' type=SoftmaxCrossEntropyWithLogits>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Slice' type=Slice>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Slice_2' type=Slice>, <tf.Operation 'block1_pool/MaxPool' type=MaxPool>, <tf.Operation 'block2_pool/MaxPool' type=MaxPool>, <tf.Operation 'block3_pool/MaxPool' type=MaxPool>, <tf.Operation 'block4_pool/MaxPool' type=MaxPool>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Reshape_2' type=Reshape>, <tf.Operation 'flatten/Shape' type=Shape>, <tf.Operation 'flatten/Reshape' type=Reshape>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/concat' type=ConcatV2>, <tf.Operation 'loss/predictions_loss/weighted_loss/Mul' type=Mul>, <tf.Operation 'loss/predictions_loss/weighted_loss/broadcast_weights/ones_like/Shape' type=Shape>, <tf.Operation 'flatten/strided_slice' type=StridedSlice>, <tf.Operation 'loss/predictions_loss/weighted_loss/broadcast_weights/ones_like' type=Fill>, <tf.Operation 'loss/predictions_loss/Sum' type=Sum>, <tf.Operation 'flatten/Reshape/shape' type=Pack>, <tf.Operation 'loss/predictions_loss/num_elements' type=Size>, <tf.Operation 'loss/predictions_loss/Sum_1' type=Sum>, <tf.Operation 'loss/predictions_loss/weighted_loss/broadcast_weights' type=Mul>, <tf.Operation 'loss/predictions_loss/num_elements/Cast' type=Cast>, <tf.Operation 'loss/predictions_loss/value' type=DivNoNan>, <tf.Operation 'loss/mul' type=Mul>], seed [<tf.Operation 'block2_conv1/Relu' type=Relu>], stop_at [<tf.Tensor 'block1_conv1/Relu:0' shape=(?, 224, 224, 64) dtype=float32>, <tf.Tensor 'block3_conv1/Relu:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'block3_conv2/Relu:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'block4_conv1/Relu:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'block4_conv2/Relu:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'block5_conv1/Relu:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'block5_conv2/Relu:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'fc1/Relu:0' shape=(?, 4096) dtype=float32>, <tf.Tensor 'fc2/Relu:0' shape=(?, 4096) dtype=float32>]
[STR DEBUG] ops_to_copy = [<tf.Operation 'block2_conv1/Conv2D' type=Conv2D>, <tf.Operation 'block1_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'block1_pool/MaxPool' type=MaxPool>, <tf.Operation 'block1_conv2/Conv2D' type=Conv2D>, <tf.Operation 'block1_conv2/Relu' type=Relu>, <tf.Operation 'block2_conv1/Relu' type=Relu>, <tf.Operation 'block2_conv1/BiasAdd' type=BiasAdd>]
[STR DEBUG] Copied [<tf.Operation 'block2_conv1/Conv2D' type=Conv2D>, <tf.Operation 'block1_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'block1_pool/MaxPool' type=MaxPool>, <tf.Operation 'block1_conv2/Conv2D' type=Conv2D>, <tf.Operation 'block1_conv2/Relu' type=Relu>, <tf.Operation 'block2_conv1/Relu' type=Relu>, <tf.Operation 'block2_conv1/BiasAdd' type=BiasAdd>] to dict_values([<tf.Operation 'training/RMSprop/gradients/block1_conv2/Conv2D' type=Conv2D>, <tf.Operation 'training/RMSprop/gradients/block1_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'training/RMSprop/gradients/block1_conv2/Relu' type=Relu>, <tf.Operation 'training/RMSprop/gradients/block1_pool/MaxPool' type=MaxPool>, <tf.Operation 'training/RMSprop/gradients/block2_conv1/Conv2D' type=Conv2D>, <tf.Operation 'training/RMSprop/gradients/block2_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'training/RMSprop/gradients/block2_conv1/Relu' type=Relu>])
[STR DEBUG] Rewired [<tf.Tensor 'training/RMSprop/gradients/block1_conv1/Relu_sg:0' shape=(?, 224, 224, 64) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block3_conv1/Relu_sg:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block3_conv2/Relu_sg:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block4_conv1/Relu_sg:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block4_conv2/Relu_sg:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block5_conv1/Relu_sg:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block5_conv2/Relu_sg:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/fc1/Relu_sg:0' shape=(?, 4096) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/fc2/Relu_sg:0' shape=(?, 4096) dtype=float32>] in place of [<tf.Tensor 'block1_conv1/Relu:0' shape=(?, 224, 224, 64) dtype=float32>, <tf.Tensor 'block3_conv1/Relu:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'block3_conv2/Relu:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'block4_conv1/Relu:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'block4_conv2/Relu:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'block5_conv1/Relu:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'block5_conv2/Relu:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'fc1/Relu:0' shape=(?, 4096) dtype=float32>, <tf.Tensor 'fc2/Relu:0' shape=(?, 4096) dtype=float32>] restricted to dict_values([<tf.Operation 'training/RMSprop/gradients/block1_conv2/Conv2D' type=Conv2D>, <tf.Operation 'training/RMSprop/gradients/block1_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'training/RMSprop/gradients/block1_conv2/Relu' type=Relu>, <tf.Operation 'training/RMSprop/gradients/block1_pool/MaxPool' type=MaxPool>, <tf.Operation 'training/RMSprop/gradients/block2_conv1/Conv2D' type=Conv2D>, <tf.Operation 'training/RMSprop/gradients/block2_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'training/RMSprop/gradients/block2_conv1/Relu' type=Relu>])
[STR DEBUG] Got gradients [<tf.Tensor 'training/RMSprop/gradients/gradients_9/training/RMSprop/gradients/block1_conv2/Conv2D_grad/Conv2DBackpropInput:0' shape=(?, 224, 224, 64) dtype=float32>, None, None, None, None, None, None, None, None, None, None, <tf.Tensor 'training/RMSprop/gradients/gradients_9/training/RMSprop/gradients/block1_conv2/Conv2D_grad/Conv2DBackpropFilter:0' shape=(3, 3, 64, 64) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/gradients_9/training/RMSprop/gradients/block1_conv2/BiasAdd_grad/BiasAddGrad:0' shape=(64,) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/gradients_9/training/RMSprop/gradients/block2_conv1/Conv2D_grad/Conv2DBackpropFilter:0' shape=(3, 3, 64, 128) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/gradients_9/training/RMSprop/gradients/block2_conv1/BiasAdd_grad/BiasAddGrad:0' shape=(128,) dtype=float32>, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None]
[STR DEBUG] for [<tf.Tensor 'training/RMSprop/gradients/block2_conv1/Relu:0' shape=(?, 112, 112, 128) dtype=float32>]
[STR DEBUG] with respect to boundary: [<tf.Tensor 'training/RMSprop/gradients/block1_conv1/Relu_sg:0' shape=(?, 224, 224, 64) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block3_conv1/Relu_sg:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block3_conv2/Relu_sg:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block4_conv1/Relu_sg:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block4_conv2/Relu_sg:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block5_conv1/Relu_sg:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block5_conv2/Relu_sg:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/fc1/Relu_sg:0' shape=(?, 4096) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/fc2/Relu_sg:0' shape=(?, 4096) dtype=float32>], xs: [<tf.Variable 'block1_conv1/kernel:0' shape=(3, 3, 3, 64) dtype=float32>, <tf.Variable 'block1_conv1/bias:0' shape=(64,) dtype=float32>, <tf.Variable 'block1_conv2/kernel:0' shape=(3, 3, 64, 64) dtype=float32>, <tf.Variable 'block1_conv2/bias:0' shape=(64,) dtype=float32>, <tf.Variable 'block2_conv1/kernel:0' shape=(3, 3, 64, 128) dtype=float32>, <tf.Variable 'block2_conv1/bias:0' shape=(128,) dtype=float32>, <tf.Variable 'block2_conv2/kernel:0' shape=(3, 3, 128, 128) dtype=float32>, <tf.Variable 'block2_conv2/bias:0' shape=(128,) dtype=float32>, <tf.Variable 'block3_conv1/kernel:0' shape=(3, 3, 128, 256) dtype=float32>, <tf.Variable 'block3_conv1/bias:0' shape=(256,) dtype=float32>, <tf.Variable 'block3_conv2/kernel:0' shape=(3, 3, 256, 256) dtype=float32>, <tf.Variable 'block3_conv2/bias:0' shape=(256,) dtype=float32>, <tf.Variable 'block3_conv3/kernel:0' shape=(3, 3, 256, 256) dtype=float32>, <tf.Variable 'block3_conv3/bias:0' shape=(256,) dtype=float32>, <tf.Variable 'block4_conv1/kernel:0' shape=(3, 3, 256, 512) dtype=float32>, <tf.Variable 'block4_conv1/bias:0' shape=(512,) dtype=float32>, <tf.Variable 'block4_conv2/kernel:0' shape=(3, 3, 512, 512) dtype=float32>, <tf.Variable 'block4_conv2/bias:0' shape=(512,) dtype=float32>, <tf.Variable 'block4_conv3/kernel:0' shape=(3, 3, 512, 512) dtype=float32>, <tf.Variable 'block4_conv3/bias:0' shape=(512,) dtype=float32>, <tf.Variable 'block5_conv1/kernel:0' shape=(3, 3, 512, 512) dtype=float32>, <tf.Variable 'block5_conv1/bias:0' shape=(512,) dtype=float32>, <tf.Variable 'block5_conv2/kernel:0' shape=(3, 3, 512, 512) dtype=float32>, <tf.Variable 'block5_conv2/bias:0' shape=(512,) dtype=float32>, <tf.Variable 'block5_conv3/kernel:0' shape=(3, 3, 512, 512) dtype=float32>, <tf.Variable 'block5_conv3/bias:0' shape=(512,) dtype=float32>, <tf.Variable 'fc1/kernel:0' shape=(25088, 4096) dtype=float32>, <tf.Variable 'fc1/bias:0' shape=(4096,) dtype=float32>, <tf.Variable 'fc2/kernel:0' shape=(4096, 4096) dtype=float32>, <tf.Variable 'fc2/bias:0' shape=(4096,) dtype=float32>, <tf.Variable 'predictions/kernel:0' shape=(4096, 10) dtype=float32>, <tf.Variable 'predictions/bias:0' shape=(10,) dtype=float32>]
[STR DEBUG] with boundary backprop substitutions [<tf.Tensor 'training/RMSprop/gradients/gradients_8/training/RMSprop/gradients/block2_conv2/Conv2D_grad/Conv2DBackpropInput:0' shape=(?, 112, 112, 128) dtype=float32>]
[STR DEBUG] =========end========
[STR DEBUG] =========loop========
[STR DEBUG] Processing list [<tf.Tensor 'block1_conv1/Relu:0' shape=(?, 224, 224, 64) dtype=float32>]
[STR DEBUG] Found 3 ops to copy within [<tf.Operation 'block1_conv2/Conv2D' type=Conv2D>, <tf.Operation 'block3_conv3/Conv2D' type=Conv2D>, <tf.Operation 'block1_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'fc2/BiasAdd' type=BiasAdd>, <tf.Operation 'predictions/BiasAdd' type=BiasAdd>, <tf.Operation 'block2_conv2/Conv2D' type=Conv2D>, <tf.Operation 'block1_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'block2_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'block4_conv3/Conv2D' type=Conv2D>, <tf.Operation 'fc2/MatMul' type=MatMul>, <tf.Operation 'block5_conv3/Conv2D' type=Conv2D>, <tf.Operation 'block3_conv3/BiasAdd' type=BiasAdd>, <tf.Operation 'block4_conv3/BiasAdd' type=BiasAdd>, <tf.Operation 'block5_conv3/BiasAdd' type=BiasAdd>, <tf.Operation 'block2_conv1/Conv2D' type=Conv2D>, <tf.Operation 'block3_conv2/Conv2D' type=Conv2D>, <tf.Operation 'block2_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'block4_conv2/Conv2D' type=Conv2D>, <tf.Operation 'block5_conv2/Conv2D' type=Conv2D>, <tf.Operation 'block3_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'block4_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'block5_conv2/BiasAdd' type=BiasAdd>, <tf.Operation 'block3_conv1/Conv2D' type=Conv2D>, <tf.Operation 'block4_conv1/Conv2D' type=Conv2D>, <tf.Operation 'block5_conv1/Conv2D' type=Conv2D>, <tf.Operation 'block3_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'fc1/BiasAdd' type=BiasAdd>, <tf.Operation 'block1_conv1/Conv2D' type=Conv2D>, <tf.Operation 'block5_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'block4_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'fc1/MatMul' type=MatMul>, <tf.Operation 'predictions/MatMul' type=MatMul>, <tf.Operation 'block3_conv2/Relu' type=Relu>, <tf.Operation 'block4_conv2/Relu' type=Relu>, <tf.Operation 'block3_conv3/Relu' type=Relu>, <tf.Operation 'block5_conv2/Relu' type=Relu>, <tf.Operation 'fc2/Relu' type=Relu>, <tf.Operation 'block4_conv3/Relu' type=Relu>, <tf.Operation 'block5_conv3/Relu' type=Relu>, <tf.Operation 'fc1/Relu' type=Relu>, <tf.Operation 'block3_conv1/Relu' type=Relu>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Shape_1' type=Shape>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Reshape' type=Reshape>, <tf.Operation 'block2_conv2/Relu' type=Relu>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Shape' type=Shape>, <tf.Operation 'block1_conv1/Relu' type=Relu>, <tf.Operation 'block1_conv2/Relu' type=Relu>, <tf.Operation 'block2_conv1/Relu' type=Relu>, <tf.Operation 'block4_conv1/Relu' type=Relu>, <tf.Operation 'block5_conv1/Relu' type=Relu>, <tf.Operation 'block5_pool/MaxPool' type=MaxPool>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits' type=SoftmaxCrossEntropyWithLogits>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Slice' type=Slice>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Slice_2' type=Slice>, <tf.Operation 'block1_pool/MaxPool' type=MaxPool>, <tf.Operation 'block2_pool/MaxPool' type=MaxPool>, <tf.Operation 'block3_pool/MaxPool' type=MaxPool>, <tf.Operation 'block4_pool/MaxPool' type=MaxPool>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/Reshape_2' type=Reshape>, <tf.Operation 'flatten/Shape' type=Shape>, <tf.Operation 'flatten/Reshape' type=Reshape>, <tf.Operation 'loss/predictions_loss/softmax_cross_entropy_with_logits/concat' type=ConcatV2>, <tf.Operation 'loss/predictions_loss/weighted_loss/Mul' type=Mul>, <tf.Operation 'loss/predictions_loss/weighted_loss/broadcast_weights/ones_like/Shape' type=Shape>, <tf.Operation 'flatten/strided_slice' type=StridedSlice>, <tf.Operation 'loss/predictions_loss/weighted_loss/broadcast_weights/ones_like' type=Fill>, <tf.Operation 'loss/predictions_loss/Sum' type=Sum>, <tf.Operation 'flatten/Reshape/shape' type=Pack>, <tf.Operation 'loss/predictions_loss/num_elements' type=Size>, <tf.Operation 'loss/predictions_loss/Sum_1' type=Sum>, <tf.Operation 'loss/predictions_loss/weighted_loss/broadcast_weights' type=Mul>, <tf.Operation 'loss/predictions_loss/num_elements/Cast' type=Cast>, <tf.Operation 'loss/predictions_loss/value' type=DivNoNan>, <tf.Operation 'loss/mul' type=Mul>], seed [<tf.Operation 'block1_conv1/Relu' type=Relu>], stop_at [<tf.Tensor 'block2_conv1/Relu:0' shape=(?, 112, 112, 128) dtype=float32>, <tf.Tensor 'block3_conv1/Relu:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'block3_conv2/Relu:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'block4_conv1/Relu:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'block4_conv2/Relu:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'block5_conv1/Relu:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'block5_conv2/Relu:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'fc1/Relu:0' shape=(?, 4096) dtype=float32>, <tf.Tensor 'fc2/Relu:0' shape=(?, 4096) dtype=float32>]WARNING:tensorflow:From /home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/ops/stropt/lms.py:928: The name tf.logging.info is deprecated. Please use tf.compat.v1.logging.info instead.


[STR DEBUG] ops_to_copy = [<tf.Operation 'block1_conv1/Relu' type=Relu>, <tf.Operation 'block1_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'block1_conv1/Conv2D' type=Conv2D>]
[STR DEBUG] Copied [<tf.Operation 'block1_conv1/Relu' type=Relu>, <tf.Operation 'block1_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'block1_conv1/Conv2D' type=Conv2D>] to dict_values([<tf.Operation 'training/RMSprop/gradients/block1_conv1/Conv2D' type=Conv2D>, <tf.Operation 'training/RMSprop/gradients/block1_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'training/RMSprop/gradients/block1_conv1/Relu' type=Relu>])
[STR DEBUG] Rewired [<tf.Tensor 'training/RMSprop/gradients/block2_conv1/Relu_sg:0' shape=(?, 112, 112, 128) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block3_conv1/Relu_sg:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block3_conv2/Relu_sg:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block4_conv1/Relu_sg:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block4_conv2/Relu_sg:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block5_conv1/Relu_sg:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block5_conv2/Relu_sg:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/fc1/Relu_sg:0' shape=(?, 4096) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/fc2/Relu_sg:0' shape=(?, 4096) dtype=float32>] in place of [<tf.Tensor 'block2_conv1/Relu:0' shape=(?, 112, 112, 128) dtype=float32>, <tf.Tensor 'block3_conv1/Relu:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'block3_conv2/Relu:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'block4_conv1/Relu:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'block4_conv2/Relu:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'block5_conv1/Relu:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'block5_conv2/Relu:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'fc1/Relu:0' shape=(?, 4096) dtype=float32>, <tf.Tensor 'fc2/Relu:0' shape=(?, 4096) dtype=float32>] restricted to dict_values([<tf.Operation 'training/RMSprop/gradients/block1_conv1/Conv2D' type=Conv2D>, <tf.Operation 'training/RMSprop/gradients/block1_conv1/BiasAdd' type=BiasAdd>, <tf.Operation 'training/RMSprop/gradients/block1_conv1/Relu' type=Relu>])
[STR DEBUG] Got gradients [None, None, None, None, None, None, None, None, None, <tf.Tensor 'training/RMSprop/gradients/gradients_10/training/RMSprop/gradients/block1_conv1/Conv2D_grad/Conv2DBackpropFilter:0' shape=(3, 3, 3, 64) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/gradients_10/training/RMSprop/gradients/block1_conv1/BiasAdd_grad/BiasAddGrad:0' shape=(64,) dtype=float32>, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None]
[STR DEBUG] for [<tf.Tensor 'training/RMSprop/gradients/block1_conv1/Relu:0' shape=(?, 224, 224, 64) dtype=float32>]
[STR DEBUG] with respect to boundary: [<tf.Tensor 'training/RMSprop/gradients/block2_conv1/Relu_sg:0' shape=(?, 112, 112, 128) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block3_conv1/Relu_sg:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block3_conv2/Relu_sg:0' shape=(?, 56, 56, 256) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block4_conv1/Relu_sg:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block4_conv2/Relu_sg:0' shape=(?, 28, 28, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block5_conv1/Relu_sg:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/block5_conv2/Relu_sg:0' shape=(?, 14, 14, 512) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/fc1/Relu_sg:0' shape=(?, 4096) dtype=float32>, <tf.Tensor 'training/RMSprop/gradients/fc2/Relu_sg:0' shape=(?, 4096) dtype=float32>], xs: [<tf.Variable 'block1_conv1/kernel:0' shape=(3, 3, 3, 64) dtype=float32>, <tf.Variable 'block1_conv1/bias:0' shape=(64,) dtype=float32>, <tf.Variable 'block1_conv2/kernel:0' shape=(3, 3, 64, 64) dtype=float32>, <tf.Variable 'block1_conv2/bias:0' shape=(64,) dtype=float32>, <tf.Variable 'block2_conv1/kernel:0' shape=(3, 3, 64, 128) dtype=float32>, <tf.Variable 'block2_conv1/bias:0' shape=(128,) dtype=float32>, <tf.Variable 'block2_conv2/kernel:0' shape=(3, 3, 128, 128) dtype=float32>, <tf.Variable 'block2_conv2/bias:0' shape=(128,) dtype=float32>, <tf.Variable 'block3_conv1/kernel:0' shape=(3, 3, 128, 256) dtype=float32>, <tf.Variable 'block3_conv1/bias:0' shape=(256,) dtype=float32>, <tf.Variable 'block3_conv2/kernel:0' shape=(3, 3, 256, 256) dtype=float32>, <tf.Variable 'block3_conv2/bias:0' shape=(256,) dtype=float32>, <tf.Variable 'block3_conv3/kernel:0' shape=(3, 3, 256, 256) dtype=float32>, <tf.Variable 'block3_conv3/bias:0' shape=(256,) dtype=float32>, <tf.Variable 'block4_conv1/kernel:0' shape=(3, 3, 256, 512) dtype=float32>, <tf.Variable 'block4_conv1/bias:0' shape=(512,) dtype=float32>, <tf.Variable 'block4_conv2/kernel:0' shape=(3, 3, 512, 512) dtype=float32>, <tf.Variable 'block4_conv2/bias:0' shape=(512,) dtype=float32>, <tf.Variable 'block4_conv3/kernel:0' shape=(3, 3, 512, 512) dtype=float32>, <tf.Variable 'block4_conv3/bias:0' shape=(512,) dtype=float32>, <tf.Variable 'block5_conv1/kernel:0' shape=(3, 3, 512, 512) dtype=float32>, <tf.Variable 'block5_conv1/bias:0' shape=(512,) dtype=float32>, <tf.Variable 'block5_conv2/kernel:0' shape=(3, 3, 512, 512) dtype=float32>, <tf.Variable 'block5_conv2/bias:0' shape=(512,) dtype=float32>, <tf.Variable 'block5_conv3/kernel:0' shape=(3, 3, 512, 512) dtype=float32>, <tf.Variable 'block5_conv3/bias:0' shape=(512,) dtype=float32>, <tf.Variable 'fc1/kernel:0' shape=(25088, 4096) dtype=float32>, <tf.Variable 'fc1/bias:0' shape=(4096,) dtype=float32>, <tf.Variable 'fc2/kernel:0' shape=(4096, 4096) dtype=float32>, <tf.Variable 'fc2/bias:0' shape=(4096,) dtype=float32>, <tf.Variable 'predictions/kernel:0' shape=(4096, 10) dtype=float32>, <tf.Variable 'predictions/bias:0' shape=(10,) dtype=float32>]
[STR DEBUG] with boundary backprop substitutions [<tf.Tensor 'training/RMSprop/gradients/gradients_9/training/RMSprop/gradients/block1_conv2/Conv2D_grad/Conv2DBackpropInput:0' shape=(?, 224, 224, 64) dtype=float32>]
[STR DEBUG] =========end========
[STR DEBUG] Finish editing for recomputation!
[STR DEBUG] Processing layer 0's swapping, swap out at [1], swap in at [14, 43]
[STR DEBUG] Find swapout ops: name: "input_1"
op: "Placeholder"
attr {
  key: "dtype"
  value {
    type: DT_FLOAT
  }
}
attr {
  key: "shape"
  value {
    shape {
      dim {
        size: -1
      }
      dim {
        size: 224
      }
      dim {
        size: 224
      }
      dim {
        size: 3
      }
    }
  }
}
, 
	choose swap tensor Tensor("input_1:0", shape=(?, 224, 224, 3), dtype=float32), 
	finish at the end of ops: [<tf.Operation 'block1_conv1/Relu' type=Relu>]
[STR DEBUG] Add swap-in op at name: "block4_pool/MaxPool"
op: "MaxPool"
input: "block4_conv3/Relu"
attr {
  key: "T"
  value {
    type: DT_FLOAT
  }
}
attr {
  key: "data_format"
  value {
    s: "NHWC"
  }
}
attr {
  key: "ksize"
  value {
    list {
      i: 1
      i: 2
      i: 2
      i: 1
    }
  }
}
attr {
  key: "padding"
  value {
    s: "VALID"
  }
}
attr {
  key: "strides"
  value {
    list {
      i: 1
      i: 2
      i: 2
      i: 1
    }
  }
}
 for consumer [<tf.Operation 'training/RMSprop/gradients/gradients_10/training/RMSprop/gradients/block1_conv1/Conv2D_grad/Conv2DBackpropFilter' type=Conv2DBackpropFilter>]
[STR DEBUG] Add swap-in op at name: "training/RMSprop/gradients/gradients_10/training/RMSprop/gradients/block1_conv1/Relu_grad/ReluGrad"
op: "ReluGrad"
input: "training/RMSprop/gradients/gradients_10/grad_ys_0"
input: "training/RMSprop/gradients/block1_conv1/Relu"
attr {
  key: "T"
  value {
    type: DT_FLOAT
  }
}
 for consumer [<tf.Operation 'training/RMSprop/gradients/gradients_10/training/RMSprop/gradients/block1_conv1/Conv2D_grad/Conv2DBackpropFilter' type=Conv2DBackpropFilter>]
[STR DEBUG] Processing layer 1's swapping, swap out at [3], swap in at [10, 41]
[STR DEBUG] Find swapout ops: name: "block1_conv1/Relu"
op: "Relu"
input: "block1_conv1/BiasAdd"
attr {
  key: "T"
  value {
    type: DT_FLOAT
  }
}
, 
	choose swap tensor Tensor("block1_conv1/Relu:0", shape=(?, 224, 224, 64), dtype=float32), 
	finish at the end of ops: [<tf.Operation 'block1_pool/MaxPool' type=MaxPool>]
[STR DEBUG] Add swap-in op at name: "block3_pool/MaxPool"
op: "MaxPool"
input: "block3_conv3/Relu"
attr {
  key: "T"
  value {
    type: DT_FLOAT
  }
}
attr {
  key: "data_format"
  value {
    s: "NHWC"
  }
}
attr {
  key: "ksize"
  value {
    list {
      i: 1
      i: 2
      i: 2
      i: 1
    }
  }
}
attr {
  key: "padding"
  value {
    s: "VALID"
  }
}
attr {
  key: "strides"
  value {
    list {
      i: 1
      i: 2
      i: 2
      i: 1
    }
  }
}
 for consumer [<tf.Operation 'training/RMSprop/gradients/block1_conv1/Relu_sg' type=StopGradient>]
[STR DEBUG] Cannot find swap-in control nodes for ref. layer 41 among [<tf.Operation 'training/RMSprop/gradients/block1_pool/MaxPool' type=MaxPool>, <tf.Operation 'training/RMSprop/gradients/gradients_9/training/RMSprop/gradients/block1_pool/MaxPool_grad/MaxPoolGrad' type=MaxPoolGrad>]
[STR DEBUG] Processing layer 3's swapping, swap out at [4], swap in at [40]
[STR DEBUG] Find swapout ops: name: "block1_pool/MaxPool"
op: "MaxPool"
input: "block1_conv2/Relu"
attr {
  key: "T"
  value {
    type: DT_FLOAT
  }
}
attr {
  key: "data_format"
  value {
    s: "NHWC"
  }
}
attr {
  key: "ksize"
  value {
    list {
      i: 1
      i: 2
      i: 2
      i: 1
    }
  }
}
attr {
  key: "padding"
  value {
    s: "VALID"
  }
}
attr {
  key: "strides"
  value {
    list {
      i: 1
      i: 2
      i: 2
      i: 1
    }
  }
}
, 
	choose swap tensor Tensor("block1_pool/MaxPool:0", shape=(?, 112, 112, 64), dtype=float32), 
	finish at the end of ops: [<tf.Operation 'block2_conv1/Relu' type=Relu>]
[STR DEBUG] Processing layer 4's swapping, swap out at [6], swap in at [12, 38]
[STR DEBUG] Find swapout ops: name: "block2_conv1/Relu"
op: "Relu"
input: "block2_conv1/BiasAdd"
attr {
  key: "T"
  value {
    type: DT_FLOAT
  }
}
, 
	choose swap tensor Tensor("block2_conv1/Relu:0", shape=(?, 112, 112, 128), dtype=float32), 
	finish at the end of ops: [<tf.Operation 'block2_pool/MaxPool' type=MaxPool>]
[STR DEBUG] Add swap-in op at name: "block4_conv2/Relu"
op: "Relu"
input: "block4_conv2/BiasAdd"
attr {
  key: "T"
  value {
    type: DT_FLOAT
  }
}
 for consumer [<tf.Operation 'training/RMSprop/gradients/block2_conv1/Relu_sg' type=StopGradient>]
[STR DEBUG] Cannot find swap-in control nodes for ref. layer 38 among [<tf.Operation 'training/RMSprop/gradients/gradients_8/training/RMSprop/gradients/block2_pool/MaxPool_grad/MaxPoolGrad' type=MaxPoolGrad>, <tf.Operation 'training/RMSprop/gradients/block2_pool/MaxPool' type=MaxPool>]
[STR DEBUG] Processing layer 6's swapping, swap out at [7], swap in at [37]
[STR DEBUG] Find swapout ops: name: "block2_pool/MaxPool"
op: "MaxPool"
input: "block2_conv2/Relu"
attr {
  key: "T"
  value {
    type: DT_FLOAT
  }
}
attr {
  key: "data_format"
  value {
    s: "NHWC"
  }
}
attr {
  key: "ksize"
  value {
    list {
      i: 1
      i: 2
      i: 2
      i: 1
    }
  }
}
attr {
  key: "padding"
  value {
    s: "VALID"
  }
}
attr {
  key: "strides"
  value {
    list {
      i: 1
      i: 2
      i: 2
      i: 1
    }
  }
}
, 
	choose swap tensor Tensor("block2_pool/MaxPool:0", shape=(?, 56, 56, 128), dtype=float32), 
	finish at the end of ops: [<tf.Operation 'block3_conv1/Relu' type=Relu>]
[STR DEBUG] Processing layer 7's swapping, swap out at [8], swap in at [11, 36]
[STR DEBUG] Find swapout ops: name: "block3_conv1/Relu"
op: "Relu"
input: "block3_conv1/BiasAdd"
attr {
  key: "T"
  value {
    type: DT_FLOAT
  }
}
, 
	choose swap tensor Tensor("block3_conv1/Relu:0", shape=(?, 56, 56, 256), dtype=float32), 
	finish at the end of ops: [<tf.Operation 'block3_conv2/Relu' type=Relu>]
[STR DEBUG] Add swap-in op at name: "block4_conv1/Relu"
op: "Relu"
input: "block4_conv1/BiasAdd"
attr {
  key: "T"
  value {
    type: DT_FLOAT
  }
}
 for consumer [<tf.Operation 'training/RMSprop/gradients/block3_conv1/Relu_sg' type=StopGradient>]
[STR DEBUG] Add swap-in op at name: "training/RMSprop/gradients/block3_conv2/Relu_sg"
op: "StopGradient"
input: "block3_conv2/Relu"
attr {
  key: "T"
  value {
    type: DT_FLOAT
  }
}
 for consumer [<tf.Operation 'training/RMSprop/gradients/block3_conv1/Relu_sg' type=StopGradient>]
[STR DEBUG] Processing layer 8's swapping, swap out at [10], swap in at [34]
[STR DEBUG] Find swapout ops: name: "block3_conv2/Relu"
op: "Relu"
input: "block3_conv2/BiasAdd"
attr {
  key: "T"
  value {
    type: DT_FLOAT
  }
}
, 
	choose swap tensor Tensor("block3_conv2/Relu:0", shape=(?, 56, 56, 256), dtype=float32), 
	finish at the end of ops: [<tf.Operation 'block3_pool/MaxPool' type=MaxPool>]
[STR DEBUG] Cannot find swap-in control nodes for ref. layer 34 among [<tf.Operation 'training/RMSprop/gradients/gradients_6/training/RMSprop/gradients/block3_pool/MaxPool_grad/MaxPoolGrad' type=MaxPoolGrad>, <tf.Operation 'training/RMSprop/gradients/block3_pool/MaxPool' type=MaxPool>]
[STR DEBUG] Processing layer 10's swapping, swap out at [11], swap in at [33]
[STR DEBUG] Find swapout ops: name: "block3_pool/MaxPool"
op: "MaxPool"
input: "block3_conv3/Relu"
attr {
  key: "T"
  value {
    type: DT_FLOAT
  }
}
attr {
  key: "data_format"
  value {
    s: "NHWC"
  }
}
attr {
  key: "ksize"
  value {
    list {
      i: 1
      i: 2
      i: 2
      i: 1
    }
  }
}
attr {
  key: "padding"
  value {
    s: "VALID"
  }
}
attr {
  key: "strides"
  value {
    list {
      i: 1
      i: 2
      i: 2
      i: 1
    }
  }
}
, 
	choose swap tensor Tensor("block3_pool/MaxPool:0", shape=(?, 28, 28, 256), dtype=float32), 
	finish at the end of ops: [<tf.Operation 'block4_conv1/Relu' type=Relu>]
[STR DEBUG] Processing layer 11's swapping, swap out at [12], swap in at [32]
[STR DEBUG] Find swapout ops: name: "block4_conv1/Relu"
op: "Relu"
input: "block4_conv1/BiasAdd"
attr {
  key: "T"
  value {
    type: DT_FLOAT
  }
}
, 
	choose swap tensor Tensor("block4_conv1/Relu:0", shape=(?, 28, 28, 512), dtype=float32), 
	finish at the end of ops: [<tf.Operation 'block4_conv2/Relu' type=Relu>]
[STR DEBUG] Add swap-in op at name: "training/RMSprop/gradients/block4_conv2/Relu_sg"
op: "StopGradient"
input: "block4_conv2/Relu"
attr {
  key: "T"
  value {
    type: DT_FLOAT
  }
}
 for consumer [<tf.Operation 'training/RMSprop/gradients/block4_conv1/Relu_sg' type=StopGradient>]
[STR DEBUG] Processing layer 12's swapping, swap out at [14], swap in at [30]
[STR DEBUG] Find swapout ops: name: "block4_conv2/Relu"
op: "Relu"
input: "block4_conv2/BiasAdd"
attr {
  key: "T"
  value {
    type: DT_FLOAT
  }
}
, 
	choose swap tensor Tensor("block4_conv2/Relu:0", shape=(?, 28, 28, 512), dtype=float32), 
	finish at the end of ops: [<tf.Operation 'block4_pool/MaxPool' type=MaxPool>]
[STR DEBUG] Cannot find swap-in control nodes for ref. layer 30 among [<tf.Operation 'training/RMSprop/gradients/block4_pool/MaxPool' type=MaxPool>, <tf.Operation 'training/RMSprop/gradients/gradients_4/training/RMSprop/gradients/block4_pool/MaxPool_grad/MaxPoolGrad' type=MaxPoolGrad>]
[STR DEBUG] Processing layer 14's swapping, swap out at [15], swap in at [29]
[STR DEBUG] Find swapout ops: name: "block4_pool/MaxPool"
op: "MaxPool"
input: "block4_conv3/Relu"
attr {
  key: "T"
  value {
    type: DT_FLOAT
  }
}
attr {
  key: "data_format"
  value {
    s: "NHWC"
  }
}
attr {
  key: "ksize"
  value {
    list {
      i: 1
      i: 2
      i: 2
      i: 1
    }
  }
}
attr {
  key: "padding"
  value {
    s: "VALID"
  }
}
attr {
  key: "strides"
  value {
    list {
      i: 1
      i: 2
      i: 2
      i: 1
    }
  }
}
, 
	choose swap tensor Tensor("block4_pool/MaxPool:0", shape=(?, 14, 14, 512), dtype=float32), 
	finish at the end of ops: [<tf.Operation 'block5_conv1/Relu' type=Relu>]
[STR DEBUG] Processing layer 15's swapping, swap out at [16], swap in at [28]
[STR DEBUG] Find swapout ops: name: "block5_conv1/Relu"
op: "Relu"
input: "block5_conv1/BiasAdd"
attr {
  key: "T"
  value {
    type: DT_FLOAT
  }
}
, 
	choose swap tensor Tensor("block5_conv1/Relu:0", shape=(?, 14, 14, 512), dtype=float32), 
	finish at the end of ops: [<tf.Operation 'block5_conv2/Relu' type=Relu>]
[STR DEBUG] Add swap-in op at name: "training/RMSprop/gradients/gradients_3/training/RMSprop/gradients/block5_conv2/Relu_grad/ReluGrad"
op: "ReluGrad"
input: "training/RMSprop/gradients/gradients_3/grad_ys_0"
input: "training/RMSprop/gradients/block5_conv2/Relu"
attr {
  key: "T"
  value {
    type: DT_FLOAT
  }
}
 for consumer [<tf.Operation 'training/RMSprop/gradients/block5_conv1/Relu_sg' type=StopGradient>]
[STR DEBUG] Processing layer 16's swapping, swap out at [19], swap in at [25]
[STR DEBUG] Cannot find swap-out control nodes for layer 16 among [<tf.Operation 'flatten/strided_slice/stack_1' type=Const>, <tf.Operation 'flatten/Shape' type=Shape>, <tf.Operation 'flatten/strided_slice/stack_2' type=Const>, <tf.Operation 'flatten/strided_slice' type=StridedSlice>, <tf.Operation 'flatten/Reshape/shape/1' type=Const>, <tf.Operation 'flatten/Reshape' type=Reshape>, <tf.Operation 'flatten/Reshape/shape' type=Pack>, <tf.Operation 'flatten/strided_slice/stack' type=Const>]
[STR DEBUG] Processing layer 19's swapping, swap out at [20], swap in at [24]
[STR DEBUG] Cannot find swap-out activation nodes for layer 19 among [<tf.Operation 'flatten/strided_slice/stack_1' type=Const>, <tf.Operation 'flatten/Shape' type=Shape>, <tf.Operation 'flatten/strided_slice/stack_2' type=Const>, <tf.Operation 'flatten/strided_slice' type=StridedSlice>, <tf.Operation 'flatten/Reshape/shape/1' type=Const>, <tf.Operation 'flatten/Reshape' type=Reshape>, <tf.Operation 'flatten/Reshape/shape' type=Pack>, <tf.Operation 'flatten/strided_slice/stack' type=Const>]
[STR DEBUG] Processing layer 20's swapping, swap out at [21], swap in at [23]
[STR DEBUG] Find swapout ops: name: "fc1/Relu"
op: "Relu"
input: "fc1/BiasAdd"
attr {
  key: "T"
  value {
    type: DT_FLOAT
  }
}
, 
	choose swap tensor Tensor("fc1/Relu:0", shape=(?, 4096), dtype=float32), 
	finish at the end of ops: [<tf.Operation 'fc2/Relu' type=Relu>]
[STR DEBUG] Add swap-in op at name: "training/RMSprop/gradients/gradients_1/training/RMSprop/gradients/fc2/Relu_grad/ReluGrad"
op: "ReluGrad"
input: "training/RMSprop/gradients/gradients_1/grad_ys_0"
input: "training/RMSprop/gradients/fc2/Relu"
attr {
  key: "T"
  value {
    type: DT_FLOAT
  }
}
 for consumer [<tf.Operation 'training/RMSprop/gradients/fc1/Relu_sg' type=StopGradient>]
[STR DEBUG] Finish editing for swapping!
Traceback (most recent call last):
  File "/home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/client/session.py", line 1365, in _do_call
    return fn(*args)
  File "/home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/client/session.py", line 1348, in _run_fn
    self._extend_graph()
  File "/home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/client/session.py", line 1388, in _extend_graph
    tf_session.ExtendSession(self._session)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Graph is invalid, contains a cycle with 533 nodes, including: training/RMSprop/gradients/block5_conv1/Relu_sg, training/RMSprop/gradients/fc1/Relu_sg, training/RMSprop/gradients/fc2/MatMul

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "../run_training.py", line 70, in <module>
    verbose=1)
  File "/home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/keras/engine/training.py", line 728, in fit
    use_multiprocessing=use_multiprocessing)
  File "/home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/keras/engine/training_generator.py", line 603, in fit
    steps_name='steps_per_epoch')
  File "/home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/keras/engine/training_generator.py", line 265, in model_iteration
    batch_outs = batch_function(*batch_data)
  File "/home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/keras/engine/training.py", line 1021, in train_on_batch
    outputs = self.train_function(ins)  # pylint: disable=not-callable
  File "/home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/keras/backend.py", line 3441, in __call__
    session = get_session(inputs)
  File "/home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/keras/backend.py", line 486, in get_session
    _initialize_variables(session)
  File "/home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/keras/backend.py", line 903, in _initialize_variables
    [variables_module.is_variable_initialized(v) for v in candidate_vars])
  File "/home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/client/session.py", line 956, in run
    run_metadata_ptr)
  File "/home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/client/session.py", line 1180, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/client/session.py", line 1359, in _do_run
    run_metadata)
  File "/home/zongzan/.conda/envs/STR36/lib/python3.6/site-packages/tensorflow_core/python/client/session.py", line 1384, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: Graph is invalid, contains a cycle with 533 nodes, including: training/RMSprop/gradients/block5_conv1/Relu_sg, training/RMSprop/gradients/fc1/Relu_sg, training/RMSprop/gradients/fc2/MatMul
